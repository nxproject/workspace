var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i["throw"](e))}catch(e){s(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(r,a)}l((i=i.apply(e,t||[])).next())})};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,o,s,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,o&&(s=r[0]&2?o["return"]:r[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;if(o=0,s)r=[r[0]&2,s.value];switch(r[0]){case 0:case 1:s=r;break;case 4:n.label++;return{value:r[1],done:false};case 5:n.label++;o=r[1];r=[0];continue;case 7:r=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(r[0]===6||r[0]===2)){n=0;continue}if(r[0]===3&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(r[0]===6&&n.label<s[1]){n.label=s[1];s=r;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(r);break}if(s[2])n.ops.pop();n.trys.pop();continue}r=t.call(e,n)}catch(e){r=[6,e];o=0}finally{i=s=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:true}}};System.register(["./p-359ddc82.system.js"],function(exports){"use strict";var registerInstance,createEvent,h,getElement,Host;return{setters:[function(e){registerInstance=e.r;createEvent=e.c;h=e.h;getElement=e.g;Host=e.H}],execute:function(){var ActivityDisplayMode;(function(e){e["Design"]="Design";e["Edit"]="Edit"})(ActivityDisplayMode||(ActivityDisplayMode={}));var ActivityEditor=function(){function e(e){registerInstance(this,e);this.activityDefinitions=[];this.submit=createEvent(this,"update-activity",7)}e.prototype.onSubmit=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,i;return __generator(this,function(o){switch(o.label){case 0:e.preventDefault();t=e.target;n=new FormData(t);return[4,this.renderer.updateEditor(n)];case 1:i=o.sent();this.submit.emit(i);this.show=false;return[2]}})})};e.prototype.componentDidRender=function(){var e=$(this.el.querySelector(".modal"));var t=this.show?"show":"hide";e.modal(t)};e.prototype.render=function(){var e=this;var t=this.activity;if(!t){return null}var n=this.activityDefinitions.find(function(e){return e.type==t.type});if(!n){console.error("No activity of type "+this.activity.type+" exists in the library.");return}var i=n.displayName;return h("div",null,h("div",{class:"modal",tabindex:"-1",role:"dialog"},h("div",{class:"modal-dialog modal-xl",role:"document"},h("div",{class:"modal-content"},h("form",{onSubmit:function(t){return e.onSubmit(t)}},h("div",{class:"modal-header"},h("h5",{class:"modal-title"},"Edit ",i),h("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},h("span",{"aria-hidden":"true"},"×"))),h("div",{class:"modal-body"},h("wf-activity-renderer",{activity:t,activityDefinition:n,displayMode:ActivityDisplayMode.Edit,ref:function(t){return e.renderer=t}})),h("div",{class:"modal-footer"},h("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Cancel"),h("button",{type:"submit",class:"btn btn-primary"},"Save")))))))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();exports("wf_activity_editor",ActivityEditor);var ActivityPicker=function(){function e(e){var t=this;registerInstance(this,e);this.activityDefinitions=[];this.filterText="";this.selectedCategory=null;this.onFilterTextChanged=function(e){var n=e.target;t.filterText=n.value};this.selectCategory=function(e){t.selectedCategory=e};this.renderActivity=function(e){var n=e.icon||"fas fa-cog";var i=n+" mr-1";return h("div",{class:"card activity"},h("div",{class:"card-body"},h("h4",{class:"card-title"},h("i",{class:i}),e.displayName),h("p",null,e.description),h("a",{href:"#",onClick:function(n){n.preventDefault();t.selectCategory(e.category)}},h("span",{class:"badge badge-light"},e.category))),h("div",{class:"card-footer text-muted text-xs-right"},h("a",{class:"btn btn-primary btn-sm",href:"#",onClick:function(n){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:n.preventDefault();return[4,this.onActivitySelected(e)];case 1:t.sent();return[2]}})})}},"Select")))};this.activitySelected=createEvent(this,"activity-picked",7)}e.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){this.isVisible=true;$(this.modal).modal("show");return[2]})})};e.prototype.hide=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){$(this.modal).modal("hide");this.isVisible=false;return[2]})})};e.prototype.onActivitySelected=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:this.activitySelected.emit(e);return[4,this.hide()];case 1:t.sent();return[2]}})})};e.prototype.render=function(){var e=this;var t=this.activityDefinitions;var n=[null].concat(new Set(t.map(function(e){return e.category})));var i=this.filterText;var o=this.selectedCategory;var s=t;if(!!o)s=s.filter(function(e){return e.category.toLowerCase()===o.toLowerCase()});if(!!i)s=s.filter(function(e){return e.displayName.toLowerCase().includes(i.toLowerCase())});return h("div",null,h("div",{class:"modal",tabindex:"-1",role:"dialog",ref:function(t){return e.modal=t}},h("div",{class:"modal-dialog modal-xl",role:"document"},h("div",{class:"modal-content"},h("div",{class:"modal-header"},h("h5",{class:"modal-title"},"Available Activities"),h("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},h("span",{"aria-hidden":"true"},"×"))),h("div",{class:"modal-body"},h("div",{class:"row"},h("div",{class:"col-sm-3 col-md-3 col-lg-2"},h("div",{class:"form-group"},h("input",{class:"form-control",type:"search",placeholder:"Filter","aria-label":"Filter",autofocus:true,onKeyUp:this.onFilterTextChanged})),h("ul",{class:"nav nav-pills flex-column activity-picker-categories"},n.map(function(t){var n=t||"All";var i=t===e.selectedCategory;var o={"nav-link":true,active:i};return h("li",{class:"nav-item"},h("a",{class:o,href:"#","data-toggle":"pill",onClick:function(n){n.preventDefault();e.selectCategory(t)}},n))}))),h("div",{class:"col-sm-9 col-md-9 col-lg-10"},h("div",{class:"card-columns tab-content"},s.map(this.renderActivity))))),h("div",{class:"modal-footer"},h("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Cancel"))))))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();exports("wf_activity_picker",ActivityPicker);var FormUpdater=function(){function e(){}e.updateEditor=function(e,t){var n=Object.assign({},e.state);t.forEach(function(e,t){n[t]=e});return Object.assign({},e,{state:n})};return e}();var DefaultActivityHandler=function(){function DefaultActivityHandler(){this.renderDesigner=function(activity,definition){var description=null;if(activity.state.description)description=activity.state.description;else if(!!definition.runtimeDescription)description=definition.runtimeDescription;else description=definition.description;try{var fun=eval(description);description=fun({activity:activity,definition:definition,state:activity.state})}catch(e){}return{title:activity.state.title||definition.displayName,description:description,icon:definition.icon||"fas fa-cog"}};this.updateEditor=function(e,t){return FormUpdater.updateEditor(e,t)};this.getOutcomes=function(activity,definition){var outcomes=[];if(!!definition){var lambda=definition.outcomes;if(lambda instanceof Array){outcomes=lambda}else{var value=eval(lambda);if(value instanceof Array)outcomes=value;else if(value instanceof Function){try{outcomes=value({activity:activity,definition:definition,state:activity.state})}catch(e){console.warn(e);outcomes=[]}}}}return!!outcomes?outcomes:[]}}return DefaultActivityHandler}();var ActivityManager=function(){function e(){var e=this;this.addHandler=function(t,n){e.handlers[t]=Object.assign({},n)};this.renderDesigner=function(t,n){var i=e.getHandler(t.type);if(!i.renderDesigner)return{title:t.state.title||n.displayName,description:t.state.description||n.description,icon:n.icon||"fas fa-cog"};return i.renderDesigner(t,n)};this.updateEditor=function(t,n){var i=e.getHandler(t.type);var o=i.updateEditor||FormUpdater.updateEditor;return o(t,n)};this.getOutcomes=function(t,n){var i=e.getHandler(t.type);if(!i.getOutcomes)return[];return i.getOutcomes(t,n)};this.getHandler=function(t){return e.handlers[t]||new DefaultActivityHandler};this.handlers={}}return e}();var ActivityManager$1=new ActivityManager;var DisplayManager=function(){function e(){var e=this;this.addDriver=function(t,n){e.drivers[t]=Object.assign({},n)};this.displayEditor=function(t,n){var i=e.drivers[n.type];if(!i)return null;return i.displayEditor(t,n)};this.updateEditor=function(t,n,i){var o=e.drivers[n.type];if(!o)return;o.updateEditor(t,n,i)};this.drivers={}}return e}();var DisplayManager$1=new DisplayManager;var ActivityRenderer=function(){function e(e){registerInstance(this,e);this.displayMode=ActivityDisplayMode.Design}e.prototype.render=function(){if(!this.activity||!this.activityDefinition)return null;switch(this.displayMode){case ActivityDisplayMode.Design:return this.renderDesigner();case ActivityDisplayMode.Edit:return this.renderEditor()}};e.prototype.renderDesigner=function(){var e=this.activity;var t=this.activityDefinition;var n=ActivityManager$1.renderDesigner(e,t);var i=n.icon+" mr-1";return h("div",null,h("h5",null,h("i",{class:i}),n.title),h("p",{innerHTML:n.description}))};e.prototype.renderEditor=function(){var e=this.activity;var t=this.activityDefinition;var n=t.properties;return h(Host,null,n.map(function(t){var n=DisplayManager$1.displayEditor(e,t);return h("div",{class:"form-group",innerHTML:n})}))};e.prototype.updateEditor=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,i,o,s,r;return __generator(this,function(a){t=Object.assign({},this.activity);n=this.activityDefinition;i=n.properties;for(o=0,s=i;o<s.length;o++){r=s[o];DisplayManager$1.updateEditor(t,r,e)}return[2,t]})})};Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();exports("wf_activity_renderer",ActivityRenderer);var ContextMenu=function(){function e(e){var t=this;registerInstance(this,e);this.isHidden=true;this.position={left:0,top:0};this.onContextMenu=function(e){if(e.defaultPrevented)return;e.preventDefault();t.contextMenuEvent.emit();t.position={left:e.pageX,top:e.pageY};t.isHidden=false};this.onContextMenuClick=function(){t.isHidden=true};this.contextMenuEvent=createEvent(this,"context-menu",7)}e.prototype.targetChangeHandler=function(e,t){if(!!t){t.removeEventListener("contextmenu",this.onContextMenu)}this.setupTarget(e)};e.prototype.targetSelectorChangeHandler=function(e){this.target=document.querySelector(e)};e.prototype.handleBodyClick=function(){this.isHidden=true};e.prototype.handleContextMenu=function(){this.isHidden=true};e.prototype.handleContextMenuEvent=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){this.onContextMenu(e);return[2]})})};e.prototype.componentDidLoad=function(){this.setupTarget(this.target)};e.prototype.render=function(){var e={left:this.position.left+"px",top:this.position.top+"px",display:this.isHidden?"none":"block"};return h(Host,{class:"dropdown-menu context-menu canvas-context-menu position-fixed",style:e,onClick:this.onContextMenuClick},h("slot",null))};e.prototype.setupTarget=function(e){if(!!e){e.addEventListener("contextmenu",this.onContextMenu,{capture:false})}};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{target:["targetChangeHandler"],targetSelector:["targetSelectorChangeHandler"]}},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();exports("wf_context_menu",ContextMenu);var ContextMenuItem=function(){function e(e){registerInstance(this,e)}e.prototype.render=function(){var e=this.text;return h("a",{class:"dropdown-item",href:"#",onClick:function(e){return e.preventDefault()}},e)};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();exports("wf_context_menu_item",ContextMenuItem);var commonjsGlobal=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}var jsplumb=createCommonjsModule(function(e,t){(function(){if(typeof Math.sgn=="undefined"){Math.sgn=function(e){return e==0?0:e>0?1:-1}}var e={subtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},dotProduct:function(e,t){return e.x*t.x+e.y*t.y},square:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},scale:function(e,t){return{x:e.x*t,y:e.y*t}}},n=64,i=Math.pow(2,-n-1);var o=function(t,n){var i=[],o=r(t,n),s=n.length-1,l=2*s-1,c=a(o,l,i,0),u=e.subtract(t,n[0]),p=e.square(u),f=0;for(var d=0;d<c;d++){u=e.subtract(t,h(n,s,i[d],null,null));var m=e.square(u);if(m<p){p=m;f=i[d]}}u=e.subtract(t,n[s]);m=e.square(u);if(m<p){p=m;f=1}return{location:f,distance:p}};var s=function(e,t){var n=o(e,t);return{point:h(t,t.length-1,n.location,null,null),location:n.location}};var r=function(t,n){var i=n.length-1,o=2*i-1,s=[],r=[],a=[],l=[],c=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]];for(var u=0;u<=i;u++)s[u]=e.subtract(n[u],t);for(var u=0;u<=i-1;u++){r[u]=e.subtract(n[u+1],n[u]);r[u]=e.scale(r[u],3)}for(var h=0;h<=i-1;h++){for(var p=0;p<=i;p++){if(!a[h])a[h]=[];a[h][p]=e.dotProduct(r[h],s[p])}}for(u=0;u<=o;u++){if(!l[u])l[u]=[];l[u].y=0;l[u].x=parseFloat(u)/o}var f=i,d=i-1;for(var m=0;m<=f+d;m++){var v=Math.max(0,m-d),y=Math.min(m,f);for(u=v;u<=y;u++){var g=m-u;l[u+g].y+=a[g][u]*c[g][u]}}return l};var a=function(e,t,i,o){var s=[],r=[],p,f,d=[],m=[];switch(l(e,t)){case 0:{return 0}case 1:{if(o>=n){i[0]=(e[0].x+e[t].x)/2;return 1}if(c(e,t)){i[0]=u(e,t);return 1}break}}h(e,t,.5,s,r);p=a(s,t,d,o+1);f=a(r,t,m,o+1);for(var v=0;v<p;v++)i[v]=d[v];for(var v=0;v<f;v++)i[v+p]=m[v];return p+f};var l=function(e,t){var n=0,i,o;i=o=Math.sgn(e[0].y);for(var s=1;s<=t;s++){i=Math.sgn(e[s].y);if(i!=o)n++;o=i}return n};var c=function(e,t){var n,o,s,r,a,l,c,u,h,p,f,d,m,v,y,g;l=e[0].y-e[t].y;c=e[t].x-e[0].x;u=e[0].x*e[t].y-e[t].x*e[0].y;var b,x;b=x=0;for(var P=1;P<t;P++){var j=l*e[P].x+c*e[P].y+u;if(j>b)b=j;else if(j<x)x=j}f=0;d=1;m=0;v=l;y=c;g=u-b;h=f*y-v*d;p=1/h;o=(d*g-y*m)*p;v=l;y=c;g=u-x;h=f*y-v*d;p=1/h;s=(d*g-y*m)*p;r=Math.min(o,s);a=Math.max(o,s);n=a-r;return n<i?1:0};var u=function(e,t){var n=1,i=0,o=e[t].x-e[0].x,s=e[t].y-e[0].y,r=e[0].x-0,a=e[0].y-0,l=o*i-s*n,c=1/l,u=(o*a-s*r)*c;return 0+n*u};var h=function(e,t,n,i,o){var s=[[]];for(var r=0;r<=t;r++)s[0][r]=e[r];for(var a=1;a<=t;a++){for(var r=0;r<=t-a;r++){if(!s[a])s[a]=[];if(!s[a][r])s[a][r]={};s[a][r].x=(1-n)*s[a-1][r].x+n*s[a-1][r+1].x;s[a][r].y=(1-n)*s[a-1][r].y+n*s[a-1][r+1].y}}if(i!=null)for(r=0;r<=t;r++)i[r]=s[r][0];if(o!=null)for(r=0;r<=t;r++)o[r]=s[t-r][r];return s[t][0]};var p={};var f=function(e){var t=p[e];if(!t){t=[];var n=function(){return function(t){return Math.pow(t,e)}},i=function(){return function(t){return Math.pow(1-t,e)}},o=function(e){return function(t){return e}},s=function(){return function(e){return e}},r=function(){return function(e){return 1-e}},a=function(e){return function(t){var n=1;for(var i=0;i<e.length;i++)n=n*e[i](t);return n}};t.push(new n);for(var l=1;l<e;l++){var c=[new o(e)];for(var u=0;u<e-l;u++)c.push(new s);for(var u=0;u<l;u++)c.push(new r);t.push(new a(c))}t.push(new i);p[e]=t}return t};var d=function(e,t){var n=f(e.length-1),i=0,o=0;for(var s=0;s<e.length;s++){i=i+e[s].x*n[s](t);o=o+e[s].y*n[s](t)}return{x:i,y:o}};var m=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};var v=function(e){return e[0].x===e[1].x&&e[0].y===e[1].y};var y=function(e,t,n){if(v(e)){return{point:e[0],location:t}}var i=d(e,t),o=0,s=t,r=n>0?1:-1,a=null;while(o<Math.abs(n)){s+=.005*r;a=d(e,s);o+=m(a,i);i=a}return{point:a,location:s}};var g=function(e){if(v(e))return 0;var t=d(e,0),n=0,i=0,o=1,s=null;while(i<1){i+=.005*o;s=d(e,i);n+=m(s,t);t=s}return n};var b=function(e,t,n){return y(e,t,n).point};var x=function(e,t,n){return y(e,t,n).location};var P=function(e,t){var n=d(e,t),i=d(e.slice(0,e.length-1),t),o=i.y-n.y,s=i.x-n.x;return o===0?Infinity:Math.atan(o/s)};var j=function(e,t,n){var i=y(e,t,n);if(i.location>1)i.location=1;if(i.location<0)i.location=0;return P(e,i.location)};var C=function(e,t,n,i){i=i==null?0:i;var o=y(e,t,i),s=P(e,o.location),r=Math.atan(-1/s),a=n/2*Math.sin(r),l=n/2*Math.cos(r);return[{x:o.point.x+l,y:o.point.y+a},{x:o.point.x-l,y:o.point.y-a}]};var E=function(e,t,n,i,o){var s=i-t,r=e-n,a=e*(t-i)+t*(n-e),l=S(o),c=[s*l[0][0]+r*l[1][0],s*l[0][1]+r*l[1][1],s*l[0][2]+r*l[1][2],s*l[0][3]+r*l[1][3]+a],u=k.apply(null,c),h=[];if(u!=null){for(var p=0;p<3;p++){var f=u[p],d=Math.pow(f,2),m=Math.pow(f,3),v=[l[0][0]*m+l[0][1]*d+l[0][2]*f+l[0][3],l[1][0]*m+l[1][1]*d+l[1][2]*f+l[1][3]];var y;if(n-e!==0){y=(v[0]-e)/(n-e)}else{y=(v[1]-t)/(i-t)}if(f>=0&&f<=1&&y>=0&&y<=1){h.push(v)}}}return h};var _=function(e,t,n,i,o){var s=[];s.push.apply(s,E(e,t,e+n,t,o));s.push.apply(s,E(e+n,t,e+n,t+i,o));s.push.apply(s,E(e+n,t+i,e,t+i,o));s.push.apply(s,E(e,t+i,e,t,o));return s};var w=function(e,t){var n=[];n.push.apply(n,E(e.x,e.y,e.x+e.w,e.y,t));n.push.apply(n,E(e.x+e.w,e.y,e.x+e.w,e.y+e.h,t));n.push.apply(n,E(e.x+e.w,e.y+e.h,e.x,e.y+e.h,t));n.push.apply(n,E(e.x,e.y+e.h,e.x,e.y,t));return n};function D(e,t){return[-e[0][t]+3*e[1][t]+-3*e[2][t]+e[3][t],3*e[0][t]-6*e[1][t]+3*e[2][t],-3*e[0][t]+3*e[1][t],e[0][t]]}function S(e){return[D(e,"x"),D(e,"y")]}function T(e){return e<0?-1:e>0?1:0}function k(e,t,n,i){var o=t/e,s=n/e,r=i/e,a=(3*s-Math.pow(o,2))/9,l=(9*o*s-27*r-2*Math.pow(o,3))/54,c=Math.pow(a,3)+Math.pow(l,2),u,h,p=[];if(c>=0){u=T(l+Math.sqrt(c))*Math.pow(Math.abs(l+Math.sqrt(c)),1/3);h=T(l-Math.sqrt(c))*Math.pow(Math.abs(l-Math.sqrt(c)),1/3);p[0]=-o/3+(u+h);p[1]=-o/3-(u+h)/2;p[2]=-o/3-(u+h)/2;if(Math.abs(Math.sqrt(3)*(u-h)/2)!==0){p[1]=-1;p[2]=-1}}else{var f=Math.acos(l/Math.sqrt(-Math.pow(a,3)));p[0]=2*Math.sqrt(-a)*Math.cos(f/3)-o/3;p[1]=2*Math.sqrt(-a)*Math.cos((f+2*Math.PI)/3)-o/3;p[2]=2*Math.sqrt(-a)*Math.cos((f+4*Math.PI)/3)-o/3}for(var d=0;d<3;d++){if(p[d]<0||p[d]>1){p[d]=-1}}return p}var O=this.jsBezier={distanceFromCurve:o,gradientAtPoint:P,gradientAtPointAlongCurveFrom:j,nearestPointOnCurve:s,pointOnCurve:d,pointAlongCurveFrom:b,perpendicularToCurveAt:C,locationAlongCurveFrom:x,getLength:g,lineIntersection:E,boxIntersection:_,boundingBoxIntersection:w,version:"0.9.0"};{t.jsBezier=O}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this;var n=e.Biltong={version:"0.4.0"};{t.Biltong=n}var i=function(e){return Object.prototype.toString.call(e)==="[object Array]"},o=function(e,t,n){e=i(e)?e:[e.x,e.y];t=i(t)?t:[t.x,t.y];return n(e,t)},s=n.gradient=function(e,t){return o(e,t,function(e,t){if(t[0]==e[0])return t[1]>e[1]?Infinity:-Infinity;else if(t[1]==e[1])return t[0]>e[0]?0:-0;else return(t[1]-e[1])/(t[0]-e[0])})},r=n.normal=function(e,t){return-1/s(e,t)},a=n.lineLength=function(e,t){return o(e,t,function(e,t){return Math.sqrt(Math.pow(t[1]-e[1],2)+Math.pow(t[0]-e[0],2))})},l=n.quadrant=function(e,t){return o(e,t,function(e,t){if(t[0]>e[0]){return t[1]>e[1]?2:1}else if(t[0]==e[0]){return t[1]>e[1]?2:1}else{return t[1]>e[1]?3:4}})},c=n.theta=function(e,t){return o(e,t,function(e,t){var n=s(e,t),i=Math.atan(n),o=l(e,t);if(o==4||o==3)i+=Math.PI;if(i<0)i+=2*Math.PI;return i})},u=n.intersects=function(e,t){var n=e.x,i=e.x+e.w,o=e.y,s=e.y+e.h,r=t.x,a=t.x+t.w,l=t.y,c=t.y+t.h;return n<=r&&r<=i&&(o<=l&&l<=s)||n<=a&&a<=i&&(o<=l&&l<=s)||n<=r&&r<=i&&(o<=c&&c<=s)||n<=a&&r<=i&&(o<=c&&c<=s)||r<=n&&n<=a&&(l<=o&&o<=c)||r<=i&&i<=a&&(l<=o&&o<=c)||r<=n&&n<=a&&(l<=s&&s<=c)||r<=i&&n<=a&&(l<=s&&s<=c)},h=n.encloses=function(e,t,n){var i=e.x,o=e.x+e.w,s=e.y,r=e.y+e.h,a=t.x,l=t.x+t.w,c=t.y,u=t.y+t.h,h=function(e,t,i,o){return n?e<=t&&i>=o:e<t&&i>o};return h(i,a,o,l)&&h(s,c,r,u)},p=[null,[1,-1],[1,1],[-1,1],[-1,-1]],f=[null,[-1,-1],[-1,1],[1,1],[1,-1]],d=n.pointOnLine=function(e,t,n){var i=s(e,t),o=l(e,t),r=n>0?p[o]:f[o],a=Math.atan(i),c=Math.abs(n*Math.sin(a))*r[1],u=Math.abs(n*Math.cos(a))*r[0];return{x:e.x+u,y:e.y+c}},m=n.perpendicularLineTo=function(e,t,n){var i=s(e,t),o=Math.atan(-1/i),r=n/2*Math.sin(o),a=n/2*Math.cos(o);return[{x:t.x+a,y:t.y+r},{x:t.x-a,y:t.y-r}]}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){function e(e,t,n,i,o,s,r,a){return new Touch({target:t,identifier:L(),pageX:n,pageY:i,screenX:o,screenY:s,clientX:r||o,clientY:a||s})}function n(){var e=[];Array.prototype.push.apply(e,arguments);e.item=function(e){return this[e]};return e}function i(t,i,o,s,r,a,l,c){return n(e.apply(null,arguments))}var o=this,s=function(e,t,n){n=n||e.parentNode;var i=n.querySelectorAll(t);for(var o=0;o<i.length;o++){if(i[o]===e){return true}}return false},r=function(e){return typeof e=="string"||e.constructor===String?document.getElementById(e):e},a=function(e){return e.srcElement||e.target},l=function(e,t,n,i){if(!i)return{path:[t],end:1};else if(typeof e.path!=="undefined"&&e.path.indexOf){return{path:e.path,end:e.path.indexOf(n)}}else{var o={path:[],end:-1},s=function(e){o.path.push(e);if(e===n){o.end=o.path.length-1}else if(e.parentNode!=null){s(e.parentNode)}};s(t);return o}},c=function(e,t){for(var n=0,i=e.length;n<i;n++){if(e[n]==t)break}if(n<e.length)e.splice(n,1)},u=1,h=function(e,t,n){var i=u++;e.__ta=e.__ta||{};e.__ta[t]=e.__ta[t]||{};e.__ta[t][i]=n;n.__tauid=i;return i},p=function(e,t,n){e.__ta&&e.__ta[t]&&delete e.__ta[t][n.__tauid];if(n.__taExtra){for(var i=0;i<n.__taExtra.length;i++){N(e,n.__taExtra[i][0],n.__taExtra[i][1])}n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()},f=function(e,t,n,i){if(e==null)return n;else{var o=e.split(","),r=function(i){r.__tauid=n.__tauid;var c=a(i),u=c;var h=l(i,c,t,e!=null);if(h.end!=-1){for(var p=0;p<h.end;p++){u=h.path[p];for(var f=0;f<o.length;f++){if(s(u,o[f],t)){n.apply(u,arguments)}}}}};d(n,i,r);return r}},d=function(e,t,n){e.__taExtra=e.__taExtra||[];e.__taExtra.push([t,n])},m=function(e,t,n,i){if(P&&C[t]){var o=f(i,e,n,C[t]);A(e,C[t],o,n)}if(t==="focus"&&e.getAttribute("tabindex")==null){e.setAttribute("tabindex","1")}A(e,t,f(i,e,n,t),n)},v=function(e,t,n,i){if(e.__taSmartClicks==null){var o=function(t){e.__tad=D(t)},s=function(t){e.__tau=D(t)},r=function(t){if(e.__tad&&e.__tau&&e.__tad[0]===e.__tau[0]&&e.__tad[1]===e.__tau[1]){for(var n=0;n<e.__taSmartClicks.length;n++)e.__taSmartClicks[n].apply(a(t),[t])}};m(e,"mousedown",o,i);m(e,"mouseup",s,i);m(e,"click",r,i);e.__taSmartClicks=[]}e.__taSmartClicks.push(n);n.__taUnstore=function(){c(e.__taSmartClicks,n)}},y={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},g=function(e,t){return function(n,i,o,r){if(i=="contextmenu"&&j)m(n,i,o,r);else{if(n.__taTapHandler==null){var u=n.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:false,taps:0,downSelectors:[]};var h=function(i){var o=a(i),c=l(i,o,n,r!=null),h=false;for(var p=0;p<c.end;p++){if(h)return;o=c.path[p];for(var m=0;m<u.downSelectors.length;m++){if(u.downSelectors[m]==null||s(o,u.downSelectors[m],n)){u.down=true;setTimeout(f,e);setTimeout(d,t);h=true;break}}}},p=function(e){if(u.down){var t=a(e),i,o;u.taps++;var r=I(e);for(var c in y){if(y.hasOwnProperty(c)){var h=y[c];if(h.touches===r&&(h.taps===1||h.taps===u.taps)){for(var p=0;p<u[c].length;p++){o=l(e,t,n,u[c][p][1]!=null);for(var f=0;f<o.end;f++){i=o.path[f];if(u[c][p][1]==null||s(i,u[c][p][1],n)){u[c][p][0].apply(i,[e]);break}}}}}}}},f=function(){u.down=false},d=function(){u.taps=0};m(n,"mousedown",h);m(n,"mouseup",p)}n.__taTapHandler.downSelectors.push(r);n.__taTapHandler[i].push([o,r]);o.__taUnstore=function(){c(n.__taTapHandler[i],o)}}}},b=function(e,t,n,i){for(var o in n.__tamee[e]){if(n.__tamee[e].hasOwnProperty(o)){n.__tamee[e][o].apply(i,[t])}}},x=function(){var e=[];return function(t,n,i,o){if(!t.__tamee){t.__tamee={over:false,mouseenter:[],mouseexit:[]};var r=function(n){var i=a(n);if(o==null&&(i==t&&!t.__tamee.over)||s(i,o,t)&&(i.__tamee==null||!i.__tamee.over)){b("mouseenter",n,t,i);i.__tamee=i.__tamee||{};i.__tamee.over=true;e.push(i)}},l=function(n){var i=a(n);for(var o=0;o<e.length;o++){if(i==e[o]&&!s(n.relatedTarget||n.toElement,"*",i)){i.__tamee.over=false;e.splice(o,1);b("mouseexit",n,t,i)}}};A(t,"mouseover",f(o,t,r,"mouseover"),r);A(t,"mouseout",f(o,t,l,"mouseout"),l)}i.__taUnstore=function(){delete t.__tamee[n][i.__tauid]};h(t,n,i);t.__tamee[n][i.__tauid]=i}},P="ontouchstart"in document.documentElement,j="onmousedown"in document.documentElement,C={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},E=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(n.exec(t)!=null)e=parseFloat(RegExp.$1)}return e}(),_=E>-1&&E<9,w=function(e,t){if(e==null)return[0,0];var n=O(e),i=k(n,0);return[i[t+"X"],i[t+"Y"]]},D=function(e){if(e==null)return[0,0];if(_){return[e.clientX+document.documentElement.scrollLeft,e.clientY+document.documentElement.scrollTop]}else{return w(e,"page")}},S=function(e){return w(e,"screen")},T=function(e){return w(e,"client")},k=function(e,t){return e.item?e.item(t):e[t]},O=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]},I=function(e){return O(e).length},A=function(e,t,n,i){h(e,t,n);i.__tauid=n.__tauid;if(e.addEventListener)e.addEventListener(t,n,false);else if(e.attachEvent){var o=t+n.__tauid;e["e"+o]=n;e[o]=function(){e["e"+o]&&e["e"+o](window.event)};e.attachEvent("on"+t,e[o])}},N=function(e,t,n){if(n==null)return;M(e,function(){var i=r(this);p(i,t,n);if(n.__tauid!=null){if(i.removeEventListener){i.removeEventListener(t,n,false);if(P&&C[t])i.removeEventListener(C[t],n,false)}else if(this.detachEvent){var o=t+n.__tauid;i[o]&&i.detachEvent("on"+t,i[o]);i[o]=null;i["e"+o]=null}}if(n.__taTouchProxy){N(e,n.__taTouchProxy[1],n.__taTouchProxy[0])}})},M=function(e,t){if(e==null)return;e=typeof Window!=="undefined"&&(typeof e.top!=="unknown"&&e==e.top)?[e]:typeof e!=="string"&&(e.tagName==null&&e.length!=null)?e:typeof e==="string"?document.querySelectorAll(e):[e];for(var n=0;n<e.length;n++)t.apply(e[n])},L=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})};o.Mottle=function(e){e=e||{};var t=e.clickThreshold||250,n=e.dblClickThreshold||450,o=new x,s=new g(t,n),a=e.smartClicks,l=function(e,t,n,i){if(n==null)return;M(e,function(){var e=r(this);if(a&&t==="click")v(e,t,n,i);else if(t==="tap"||t==="dbltap"||t==="contextmenu"){s(e,t,n,i)}else if(t==="mouseenter"||t=="mouseexit")o(e,t,n,i);else m(e,t,n,i)})};this.remove=function(e){M(e,function(){var e=r(this);if(e.__ta){for(var t in e.__ta){if(e.__ta.hasOwnProperty(t)){for(var n in e.__ta[t]){if(e.__ta[t].hasOwnProperty(n))N(e,t,e.__ta[t][n])}}}}e.parentNode&&e.parentNode.removeChild(e)});return this};this.on=function(e,t,n,i){var o=arguments[0],s=arguments.length==4?arguments[2]:null,r=arguments[1],a=arguments[arguments.length-1];l(o,r,a,s);return this};this.off=function(e,t,n){N(e,t,n);return this};this.trigger=function(e,t,n,o){var s=j&&(typeof MouseEvent==="undefined"||n==null||n.constructor===MouseEvent);var a=P&&!j&&C[t]?C[t]:t,l=!(P&&!j&&C[t]);var c=D(n),u=S(n),h=T(n);M(e,function(){var e=r(this),p;n=n||{screenX:u[0],screenY:u[1],clientX:h[0],clientY:h[1]};var f=function(e){if(o)e.payload=o};var d={TouchEvent:function(t){var n=i(window,e,0,c[0],c[1],u[0],u[1],h[0],h[1]),o=t.initTouchEvent||t.initEvent;o(a,true,true,window,null,u[0],u[1],h[0],h[1],false,false,false,false,n,n,n,1,0)},MouseEvents:function(t){t.initMouseEvent(a,true,true,window,0,u[0],u[1],h[0],h[1],false,false,false,false,1,e)}};if(document.createEvent){var m=!l&&!s&&(P&&C[t]),v=m?"TouchEvent":"MouseEvents";p=document.createEvent(v);d[v](p);f(p);e.dispatchEvent(p)}else if(document.createEventObject){p=document.createEventObject();p.eventType=p.eventName=a;p.screenX=u[0];p.screenY=u[1];p.clientX=h[0];p.clientY=h[1];f(p);e.fireEvent("on"+a,p)}});return this}};o.Mottle.consume=function(e,t){if(e.stopPropagation)e.stopPropagation();else e.returnValue=false;if(!t&&e.preventDefault)e.preventDefault()};o.Mottle.pageLocation=D;o.Mottle.setForceTouchEvents=function(e){P=e};o.Mottle.setForceMouseEvents=function(e){j=e};o.Mottle.version="0.8.0";{t.Mottle=o.Mottle}}).call(typeof window==="undefined"?commonjsGlobal:window);(function(){var e=this;var n=function(e,t,n){if(e.indexOf(t)===-1){n?e.unshift(t):e.push(t);return true}return false};var i=function(e,t){var n=e.indexOf(t);if(n!==-1)e.splice(n,1)};var o=function(e,t){var n=[];for(var i=0;i<e.length;i++){if(t.indexOf(e[i])===-1)n.push(e[i])}return n};var s=function(e){return e==null?false:typeof e==="string"||e.constructor===String};var r=function(e){var t=e.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,s=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,l=t.top+o-r,c=t.left+s-a;return{top:Math.round(l),left:Math.round(c)}};var a=function(e,t,n){n=n||e.parentNode;var i=n.querySelectorAll(t);for(var o=0;o<i.length;o++){if(i[o]===e)return true}return false};var l=function(e,t,n){if(a(t,n,e)){return t}else{var i=t.parentNode;while(i!=null&&i!==e){if(a(i,n,e)){return i}else{i=i.parentNode}}}};var c=function(e,t,n){var i=null;var o=t.getAttribute("katavorio-draggable"),s=o!=null?"[katavorio-draggable='"+o+"'] ":"";for(var r=0;r<e.length;r++){i=l(t,n,s+e[r].selector);if(i!=null){if(e[r].filter){var c=a(n,e[r].filter,i),u=e[r].filterExclude===true;if(u&&!c||c){return null}}return[e[r],i]}}return null};var u=function(){var e=-1;if(navigator.appName==="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(n.exec(t)!=null)e=parseFloat(RegExp.$1)}return e}(),h=10,p=10,f=u>-1&&u<9,d=u===9,m=function(e){if(f){return[e.clientX+document.documentElement.scrollLeft,e.clientY+document.documentElement.scrollTop]}else{var t=y(e),n=v(t,0);return d?[n.pageX||n.clientX,n.pageY||n.clientY]:[n.pageX,n.pageY]}},v=function(e,t){return e.item?e.item(t):e[t]},y=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]},g={delegatedDraggable:"katavorio-delegated-draggable",draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},b="katavorio-drag-scope",x=["stop","start","drag","drop","over","out","beforeStart"],P=function(){},j=function(){return true},C=function(e,t,n){for(var i=0;i<e.length;i++){if(e[i]!=n)t(e[i])}},E=function(e,t,n,i){C(e,function(e){e.setActive(t);if(t)e.updatePosition();if(n)e.setHover(i,t)})},_=function(e,t){if(e==null)return;e=!s(e)&&(e.tagName==null&&e.length!=null)?e:[e];for(var n=0;n<e.length;n++)t.apply(e[n],[e[n]])},w=function(e){if(e.stopPropagation){e.stopPropagation();e.preventDefault()}else{e.returnValue=false}},D="input,textarea,select,button,option",S=function(e,t,n){var i=e.srcElement||e.target;return!a(i,n.getInputFilterSelector(),t)};var T=function(e,t,n,i){this.params=t||{};this.el=e;this.params.addClass(this.el,this._class);this.uuid=N();var o=true;this.setEnabled=function(e){o=e};this.isEnabled=function(){return o};this.toggleEnabled=function(){o=!o};this.setScope=function(e){this.scopes=e?e.split(/\s+/):[i]};this.addScope=function(e){var t={};_(this.scopes,function(e){t[e]=true});_(e?e.split(/\s+/):[],function(e){t[e]=true});this.scopes=[];for(var n in t)this.scopes.push(n)};this.removeScope=function(e){var t={};_(this.scopes,function(e){t[e]=true});_(e?e.split(/\s+/):[],function(e){delete t[e]});this.scopes=[];for(var n in t)this.scopes.push(n)};this.toggleScope=function(e){var t={};_(this.scopes,function(e){t[e]=true});_(e?e.split(/\s+/):[],function(e){if(t[e])delete t[e];else t[e]=true});this.scopes=[];for(var n in t)this.scopes.push(n)};this.setScope(t.scope);this.k=t.katavorio;return t.katavorio};var k=function(){return true};var O=function(){return false};var I=function(e,t,n,i){this._class=n.draggable;var o=T.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var l=[0,0],u=null,f=null,d=[0,0],v=false,y=[0,0],b=this.params.consumeStartEvent!==false,x=this.el,P=this.params.clone,C=t.multipleDrop!==false,_=false,D=t.ghostProxy===true?k:t.ghostProxy&&typeof t.ghostProxy==="function"?t.ghostProxy:O,I=function(e){return e.cloneNode(true)},A=null,L=[],F=null,W=t.ghostProxyParent,H,R,U,G;if(t.selector){var B=e.getAttribute("katavorio-draggable");if(B==null){B=""+(new Date).getTime();e.setAttribute("katavorio-draggable",B)}L.push(t)}var q=t.snapThreshold,Y=function(e,t,n,i,o){var s=Math.floor(e[0]/t),r=t*s,a=r+t,l=Math.abs(e[0]-r)<=i?r:Math.abs(a-e[0])<=i?a:e[0];var c=Math.floor(e[1]/n),u=n*c,h=u+n,p=Math.abs(e[1]-u)<=o?u:Math.abs(h-e[1])<=o?h:e[1];return[l,p]};this.posses=[];this.posseRoles={};this.toGrid=function(e){if(this.params.grid==null){return e}else{var t=this.params.grid?this.params.grid[0]/2:q?q:h/2,n=this.params.grid?this.params.grid[1]/2:q?q:p/2;return Y(e,this.params.grid[0],this.params.grid[1],t,n)}};this.snap=function(e,t){if(x==null)return;e=e||(this.params.grid?this.params.grid[0]:h);t=t||(this.params.grid?this.params.grid[1]:p);var n=this.params.getPosition(x),i=this.params.grid?this.params.grid[0]/2:q,o=this.params.grid?this.params.grid[1]/2:q;this.params.setPosition(x,Y(n,e,t,i,o))};this.setUseGhostProxy=function(e){D=e?k:O};var X;var z=function(e){return t.allowNegative===false?[Math.max(0,e[0]),Math.max(0,e[1])]:e};var V=function(e){X=typeof e==="function"?e:e?function(e,t,n,i){return z([Math.max(0,Math.min(n.w-i[0],e[0])),Math.max(0,Math.min(n.h-i[1],e[1]))])}.bind(this):function(e){return z(e)}}.bind(this);V(typeof this.params.constrain==="function"?this.params.constrain:this.params.constrain||this.params.containment);this.setConstrain=function(e){V(e)};var $;this.setRevert=function(e){$=e};if(this.params.revert){$=this.params.revert}var J=function(e){if(typeof e==="function"){e._katavorioId=N();return e._katavorioId}else{return e}},Z={},K=function(e){for(var t in Z){var n=Z[t];var i=n[0](e);if(n[1])i=!i;if(!i)return false}return true},Q=this.setFilter=function(t,n){if(t){var i=J(t);Z[i]=[function(n){var i=n.srcElement||n.target,o;if(s(t)){o=a(i,t,e)}else if(typeof t==="function"){o=t(n,e)}return o},n!==false]}},ee=this.addFilter=Q,te=this.removeFilter=function(e){var t=typeof e==="function"?e._katavorioId:e;delete Z[t]};this.clearAllFilters=function(){Z={}};this.canDrag=this.params.canDrag||j;var ne,ie=[],oe=[];this.addSelector=function(e){if(e.selector){L.push(e)}};this.downListener=function(e){if(e.defaultPrevented){return}var t=this.rightButtonCanDrag||e.which!==3&&e.button!==2;if(t&&this.isEnabled()&&this.canDrag()){var i=K(e)&&S(e,this.el,this.k);if(i){F=null;A=null;if(L.length>0){var s=c(L,this.el,e.target||e.srcElement);if(s!=null){F=s[0];A=s[1]}if(A==null){return}}else{A=this.el}if(P){x=A.cloneNode(true);this.params.addClass(x,g.clonedDrag);x.setAttribute("id",null);x.style.position="absolute";if(this.params.parent!=null){var a=this.params.getPosition(this.el);x.style.left=a[0]+"px";x.style.top=a[1]+"px";this.params.parent.appendChild(x)}else{var h=r(A);x.style.left=h.left+"px";x.style.top=h.top+"px";document.body.appendChild(x)}}else{x=A}b&&w(e);l=m(e);if(x&&x.parentNode){y=[x.parentNode.scrollLeft,x.parentNode.scrollTop]}this.params.bind(document,"mousemove",this.moveListener);this.params.bind(document,"mouseup",this.upListener);o.markSelection(this);o.markPosses(this);this.params.addClass(document.body,n.noSelect);re("beforeStart",{el:this.el,pos:u,e:e,drag:this})}else if(this.params.consumeFilteredEvents){w(e)}}}.bind(this);this.moveListener=function(e){if(l){if(!v){var t=re("start",{el:this.el,pos:u,e:e,drag:this});if(t!==false){if(!l){return}this.mark(true);v=true}else{this.abort()}}if(l){oe.length=0;var n=m(e),i=n[0]-l[0],s=n[1]-l[1],r=this.params.ignoreZoom?1:o.getZoom();if(x&&x.parentNode){i+=x.parentNode.scrollLeft-y[0];s+=x.parentNode.scrollTop-y[1]}i/=r;s/=r;this.moveBy(i,s,e);o.updateSelection(i,s,this);o.updatePosses(i,s,this)}}}.bind(this);this.upListener=function(e){if(l){l=null;this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.params.removeClass(document.body,n.noSelect);this.unmark(e);o.unmarkSelection(this,e);o.unmarkPosses(this,e);this.stop(e);o.notifyPosseDragStop(this,e);v=false;oe.length=0;if(P){x&&x.parentNode&&x.parentNode.removeChild(x);x=null}else{if($&&$(x,this.params.getPosition(x))===true){this.params.setPosition(x,u);re("revert",x)}}}}.bind(this);this.getFilters=function(){return Z};this.abort=function(){if(l!=null){this.upListener()}};this.getDragElement=function(e){return e?A||this.el:x||this.el};var se={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};if(t.events.start)se.start.push(t.events.start);if(t.events.beforeStart)se.beforeStart.push(t.events.beforeStart);if(t.events.stop)se.stop.push(t.events.stop);if(t.events.drag)se.drag.push(t.events.drag);if(t.events.revert)se.revert.push(t.events.revert);this.on=function(e,t){if(se[e])se[e].push(t)};this.off=function(e,t){if(se[e]){var n=[];for(var i=0;i<se[e].length;i++){if(se[e][i]!==t)n.push(se[e][i])}se[e]=n}};var re=function(e,t){var n=null;if(F&&F[e]){n=F[e](t)}else if(se[e]){for(var i=0;i<se[e].length;i++){try{var o=se[e][i](t);if(o!=null){n=o}}catch(e){}}}return n};this.notifyStart=function(e){re("start",{el:this.el,pos:this.params.getPosition(x),e:e,drag:this})};this.stop=function(e,t){if(t||v){var n=[],i=o.getSelection(),s=this.params.getPosition(x);if(i.length>0){for(var r=0;r<i.length;r++){var a=this.params.getPosition(i[r].el);n.push([i[r].el,{left:a[0],top:a[1]},i[r]])}}else{n.push([x,{left:s[0],top:s[1]},this])}re("stop",{el:x,pos:ae||s,finalPos:s,e:e,drag:this,selection:n})}};this.mark=function(e){u=this.params.getPosition(x);f=this.params.getPosition(x,true);d=[f[0]-u[0],f[1]-u[1]];this.size=this.params.getSize(x);ie=o.getMatchingDroppables(this);E(ie,true,false,this);this.params.addClass(x,this.params.dragClass||n.drag);var t;if(this.params.getConstrainingRectangle){t=this.params.getConstrainingRectangle(x)}else{t=this.params.getSize(x.parentNode)}ne={w:t[0],h:t[1]};U=0;G=0;if(e){o.notifySelectionDragStart(this)}};var ae;this.unmark=function(e,i){E(ie,false,true,this);if(_&&D(A,x)){ae=[x.offsetLeft-U,x.offsetTop-G];x.parentNode.removeChild(x);x=A}else{ae=null}this.params.removeClass(x,this.params.dragClass||n.drag);ie.length=0;_=false;if(!i){if(oe.length>0&&ae){t.setPosition(A,ae)}oe.sort(M);for(var o=0;o<oe.length;o++){var s=oe[o].drop(this,e);if(s===true)break}}};this.moveBy=function(e,n,i){oe.length=0;var o=this.toGrid([u[0]+e,u[1]+n]),s=X(o,x,ne,this.size);if(D(this.el,x)){if(o[0]!==s[0]||o[1]!==s[1]){if(!_){var r=I(A);t.addClass(r,g.ghostProxy);if(W){W.appendChild(r);H=t.getPosition(A.parentNode,true);R=t.getPosition(t.ghostProxyParent,true);U=H[0]-R[0];G=H[1]-R[1]}else{A.parentNode.appendChild(r)}x=r;_=true}s=o}else{if(_){x.parentNode.removeChild(x);x=A;_=false;H=null;R=null;U=0;G=0}}}var a={x:s[0],y:s[1],w:this.size[0],h:this.size[1]},l={x:a.x+d[0],y:a.y+d[1],w:a.w,h:a.h},c=null;this.params.setPosition(x,[s[0]+U,s[1]+G]);for(var h=0;h<ie.length;h++){var p={x:ie[h].pagePosition[0],y:ie[h].pagePosition[1],w:ie[h].size[0],h:ie[h].size[1]};if(this.params.intersects(l,p)&&(C||c==null||c===ie[h].el)&&ie[h].canDrop(this)){if(!c)c=ie[h].el;oe.push(ie[h]);ie[h].setHover(this,true,i)}else if(ie[h].isHover()){ie[h].setHover(this,false,i)}}re("drag",{el:this.el,pos:s,e:i,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);if(this.params.handle)Q(this.params.handle,false);else Q(this.params.filter,this.params.filterExclude)};var A=function(e,t,n,i){this._class=n.droppable;this.params=t||{};this.rank=t.rank||0;this._activeClass=this.params.activeClass||n.active;this._hoverClass=this.params.hoverClass||n.hover;T.apply(this,arguments);var o=false;this.allowLoopback=this.params.allowLoopback!==false;this.setActive=function(e){this.params[e?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,true);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(e){return true};this.isHover=function(){return o};this.setHover=function(e,t,n){if(t||this.el._katavorioDragHover==null||this.el._katavorioDragHover===e.el._katavorio){this.params[t?"addClass":"removeClass"](this.el,this._hoverClass);this.el._katavorioDragHover=t?e.el._katavorio:null;if(o!==t){this.params.events[t?"over":"out"]({el:this.el,e:n,drag:e,drop:this})}o=t}};this.drop=function(e,t){return this.params.events["drop"]({drag:e,e:t,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;o=null}};var N=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})};var M=function(e,t){return e.rank<t.rank?1:e.rank>t.rank?-1:0};var L=function(e){if(e==null)return null;e=typeof e==="string"||e.constructor===String?document.getElementById(e):e;if(e==null)return null;e._katavorio=e._katavorio||N();return e};e.Katavorio=function(e){var t=[],r={};this._dragsByScope={};this._dropsByScope={};var a=1,l=function(e,t){_(e,function(e){for(var n=0;n<e.scopes.length;n++){t[e.scopes[n]]=t[e.scopes[n]]||[];t[e.scopes[n]].push(e)}})},c=function(t,n){var i=0;_(t,function(t){for(var o=0;o<t.scopes.length;o++){if(n[t.scopes[o]]){var s=e.indexOf(n[t.scopes[o]],t);if(s!==-1){n[t.scopes[o]].splice(s,1);i++}}}});return i>0},u=this.getMatchingDroppables=function(e){var t=[],n={};for(var i=0;i<e.scopes.length;i++){var o=this._dropsByScope[e.scopes[i]];if(o){for(var s=0;s<o.length;s++){if(o[s].canDrop(e)&&!n[o[s].uuid]&&(o[s].allowLoopback||o[s].el!==e.el)){n[o[s].uuid]=true;t.push(o[s])}}}}t.sort(M);return t},h=function(t){t=t||{};var n={events:{}},i;for(i in e)n[i]=e[i];for(i in t)n[i]=t[i];for(i=0;i<x.length;i++){n.events[x[i]]=t[x[i]]||P}n.katavorio=this;return n}.bind(this),p=function(e,t){for(var n=0;n<x.length;n++){if(t[x[n]]){e.on(x[n],t[x[n]])}}}.bind(this),f={},d=e.css||{},m=e.scope||b;for(var v in g)f[v]=g[v];for(var v in d)f[v]=d[v];var y=e.inputFilterSelector||D;this.getInputFilterSelector=function(){return y};this.setInputFilterSelector=function(e){y=e;return this};this.draggable=function(t,n){var i=[];_(t,function(t){t=L(t);if(t!=null){if(t._katavorioDrag==null){var o=h(n);t._katavorioDrag=new I(t,o,f,m);l(t._katavorioDrag,this._dragsByScope);i.push(t._katavorioDrag);e.addClass(t,o.selector?f.delegatedDraggable:f.draggable)}else{p(t._katavorioDrag,n)}}}.bind(this));return i};this.droppable=function(t,n){var i=[];_(t,function(t){t=L(t);if(t!=null){var o=new A(t,h(n),f,m);t._katavorioDrop=t._katavorioDrop||[];t._katavorioDrop.push(o);l(o,this._dropsByScope);i.push(o);e.addClass(t,f.droppable)}}.bind(this));return i};this.select=function(n){_(n,function(){var n=L(this);if(n&&n._katavorioDrag){if(!r[n._katavorio]){t.push(n._katavorioDrag);r[n._katavorio]=[n,t.length-1];e.addClass(n,f.selected)}}});return this};this.deselect=function(n){_(n,function(){var n=L(this);if(n&&n._katavorio){var i=r[n._katavorio];if(i){var o=[];for(var s=0;s<t.length;s++)if(t[s].el!==n)o.push(t[s]);t=o;delete r[n._katavorio];e.removeClass(n,f.selected)}}});return this};this.deselectAll=function(){for(var n in r){var i=r[n];e.removeClass(i[0],f.selected)}t.length=0;r={}};this.markSelection=function(e){C(t,function(e){e.mark()},e)};this.markPosses=function(e){if(e.posses){_(e.posses,function(t){if(e.posseRoles[t]&&T[t]){C(T[t].members,function(e){e.mark()},e)}})}};this.unmarkSelection=function(e,n){C(t,function(e){e.unmark(n)},e)};this.unmarkPosses=function(e,t){if(e.posses){_(e.posses,function(n){if(e.posseRoles[n]&&T[n]){C(T[n].members,function(e){e.unmark(t,true)},e)}})}};this.getSelection=function(){return t.slice(0)};this.updateSelection=function(e,n,i){C(t,function(t){t.moveBy(e,n)},i)};var j=function(e,t){if(t.posses){_(t.posses,function(n){if(t.posseRoles[n]&&T[n]){C(T[n].members,function(t){e(t)},t)}})}};this.updatePosses=function(e,t,n){j(function(n){n.moveBy(e,t)},n)};this.notifyPosseDragStop=function(e,t){j(function(e){e.stop(t,true)},e)};this.notifySelectionDragStop=function(e,n){C(t,function(e){e.stop(n,true)},e)};this.notifySelectionDragStart=function(e,n){C(t,function(e){e.notifyStart(n)},e)};this.setZoom=function(e){a=e};this.getZoom=function(){return a};var E=function(e,t,n,i){_(e,function(e){c(e,n);e[i](t);l(e,n)})};_(["set","add","remove","toggle"],function(e){this[e+"Scope"]=function(t,n){E(t._katavorioDrag,n,this._dragsByScope,e+"Scope");E(t._katavorioDrop,n,this._dropsByScope,e+"Scope")}.bind(this);this[e+"DragScope"]=function(t,n){E(t.constructor===I?t:t._katavorioDrag,n,this._dragsByScope,e+"Scope")}.bind(this);this[e+"DropScope"]=function(t,n){E(t.constructor===A?t:t._katavorioDrop,n,this._dropsByScope,e+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(e,t){for(var n in this._dragsByScope){C(this._dragsByScope[n],function(n){n.snap(e,t)})}};this.getDragsForScope=function(e){return this._dragsByScope[e]};this.getDropsForScope=function(e){return this._dropsByScope[e]};var w=function(e,n,i){e=L(e);if(e[n]){var o=t.indexOf(e[n]);if(o>=0){t.splice(o,1)}if(c(e[n],i)){_(e[n],function(e){e.destroy()})}delete e[n]}};var S=function(e,t,n,i){e=L(e);if(e[t]){e[t].off(n,i)}};this.elementRemoved=function(e){this.destroyDraggable(e);this.destroyDroppable(e)};this.destroyDraggable=function(e,t,n){if(arguments.length===1){w(e,"_katavorioDrag",this._dragsByScope)}else{S(e,"_katavorioDrag",t,n)}};this.destroyDroppable=function(e,t,n){if(arguments.length===1){w(e,"_katavorioDrop",this._dropsByScope)}else{S(e,"_katavorioDrop",t,n)}};this.reset=function(){this._dragsByScope={};this._dropsByScope={};t=[];r={};T={}};var T={};var k=function(e,t,i){var o=s(t)?t:t.id;var r=s(t)?true:t.active!==false;var a=T[o]||function(){var e={name:o,members:[]};T[o]=e;return e}();_(e,function(e){if(e._katavorioDrag){if(i&&e._katavorioDrag.posseRoles[a.name]!=null)return;n(a.members,e._katavorioDrag);n(e._katavorioDrag.posses,a.name);e._katavorioDrag.posseRoles[a.name]=r}});return a};this.addToPosse=function(e,t){var n=[];for(var i=1;i<arguments.length;i++){n.push(k(e,arguments[i]))}return n.length===1?n[0]:n};this.setPosse=function(e,t){var n=[];for(var i=1;i<arguments.length;i++){n.push(k(e,arguments[i],true).name)}_(e,function(e){if(e._katavorioDrag){var t=o(e._katavorioDrag.posses,n);var i=[];Array.prototype.push.apply(i,e._katavorioDrag.posses);for(var s=0;s<t.length;s++){this.removeFromPosse(e,t[s])}}}.bind(this));return n.length===1?n[0]:n};this.removeFromPosse=function(e,t){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var n=1;n<arguments.length;n++){t=arguments[n];_(e,function(e){if(e._katavorioDrag&&e._katavorioDrag.posses){var n=e._katavorioDrag;_(t,function(e){i(T[e].members,n);i(n.posses,e);delete n.posseRoles[e]})}})}};this.removeFromAllPosses=function(e){_(e,function(e){if(e._katavorioDrag&&e._katavorioDrag.posses){var t=e._katavorioDrag;_(t.posses,function(e){i(T[e].members,t)});t.posses.length=0;t.posseRoles={}}})};this.setPosseState=function(e,t,n){var i=T[t];if(i){_(e,function(e){if(e._katavorioDrag&&e._katavorioDrag.posses){e._katavorioDrag.posseRoles[i.name]=n}})}}};e.Katavorio.version="1.0.0";{t.Katavorio=e.Katavorio}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this;e.jsPlumbUtil=e.jsPlumbUtil||{};var n=e.jsPlumbUtil;{t.jsPlumbUtil=n}function i(e){return Object.prototype.toString.call(e)==="[object Array]"}n.isArray=i;function o(e){return Object.prototype.toString.call(e)==="[object Number]"}n.isNumber=o;function s(e){return typeof e==="string"}n.isString=s;function r(e){return typeof e==="boolean"}n.isBoolean=r;function a(e){return e==null}n.isNull=a;function l(e){return e==null?false:Object.prototype.toString.call(e)==="[object Object]"}n.isObject=l;function c(e){return Object.prototype.toString.call(e)==="[object Date]"}n.isDate=c;function u(e){return Object.prototype.toString.call(e)==="[object Function]"}n.isFunction=u;function h(e){return u(e)&&e.name!=null&&e.name.length>0}n.isNamedFunction=h;function p(e){for(var t in e){if(e.hasOwnProperty(t)){return false}}return true}n.isEmpty=p;function f(e){if(s(e)){return""+e}else if(r(e)){return!!e}else if(c(e)){return new Date(e.getTime())}else if(u(e)){return e}else if(i(e)){var t=[];for(var n=0;n<e.length;n++){t.push(f(e[n]))}return t}else if(l(e)){var o={};for(var a in e){o[a]=f(e[a])}return o}else{return e}}n.clone=f;function d(e,t,n,o){var a={},c,u,h={};n=n||[];o=o||[];for(u=0;u<n.length;u++){a[n[u]]=true}for(u=0;u<o.length;u++){h[o[u]]=true}var p=f(e);for(u in t){if(p[u]==null||h[u]){p[u]=t[u]}else if(s(t[u])||r(t[u])){if(!a[u]){p[u]=t[u]}else{c=[];c.push.apply(c,i(p[u])?p[u]:[p[u]]);c.push.apply(c,r(t[u])?t[u]:[t[u]]);p[u]=c}}else{if(i(t[u])){c=[];if(i(p[u])){c.push.apply(c,p[u])}c.push.apply(c,t[u]);p[u]=c}else if(l(t[u])){if(!l(p[u])){p[u]={}}for(var d in t[u]){p[u][d]=t[u][d]}}}}return p}n.merge=d;function m(e,t,n){if(e==null){return}var i=e,o=i;t.replace(/([^\.])+/g,function(e,t,i,s){var r=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),a=i+e.length>=s.length,l=function(){return o[r[1]]||function(){o[r[1]]=[];return o[r[1]]}()};if(a){if(r){l()[r[3]]=n}else{o[e]=n}}else{if(r){var c=l();o=c[r[3]]||function(){c[r[3]]={};return c[r[3]]}()}else{o=o[e]||function(){o[e]={};return o[e]}()}}return""});return e}n.replace=m;function v(e,t,n){for(var i=0;i<n.length;i++){var o=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(o===t){return o}}return e}n.functionChain=v;function y(e,t,n,o){var r=function(e){var n=e.match(/(\${.*?})/g);if(n!=null){for(var i=0;i<n.length;i++){var o=t[n[i].substring(2,n[i].length-1)]||"";if(o!=null){e=e.replace(n[i],o)}}}return e};var a=function(e){if(e!=null){if(s(e)){return r(e)}else if(u(e)&&!o&&(n==null||(e.name||"").indexOf(n)===0)){return e(t)}else if(i(e)){var c=[];for(var h=0;h<e.length;h++){c.push(a(e[h]))}return c}else if(l(e)){var p={};for(var f in e){p[f]=a(e[f])}return p}else{return e}}};return a(e)}n.populate=y;function g(e,t){if(e){for(var n=0;n<e.length;n++){if(t(e[n])){return n}}}return-1}n.findWithFunction=g;function b(e,t){var n=g(e,t);if(n>-1){e.splice(n,1)}return n!==-1}n.removeWithFunction=b;function x(e,t){var n=e.indexOf(t);if(n>-1){e.splice(n,1)}return n!==-1}n.remove=x;function P(e,t,n){if(g(e,n)===-1){e.push(t)}}n.addWithFunction=P;function j(e,t,n,i){var o=e[t];if(o==null){o=[];e[t]=o}o[i?"unshift":"push"](n);return o}n.addToList=j;function C(e,t,n){if(e.indexOf(t)===-1){if(n){e.unshift(t)}else{e.push(t)}return true}return false}n.suggest=C;function E(e,t,n){var o;t=i(t)?t:[t];var s=function(t){var n=t.__proto__;while(n!=null){if(n.prototype!=null){for(var i in n.prototype){if(n.prototype.hasOwnProperty(i)&&!e.prototype.hasOwnProperty(i)){e.prototype[i]=n.prototype[i]}}n=n.prototype.__proto__}else{n=null}}};for(o=0;o<t.length;o++){for(var r in t[o].prototype){if(t[o].prototype.hasOwnProperty(r)&&!e.prototype.hasOwnProperty(r)){e.prototype[r]=t[o].prototype[r]}}s(t[o])}var a=function(e,n){return function(){for(o=0;o<t.length;o++){if(t[o].prototype[e]){t[o].prototype[e].apply(this,arguments)}}return n.apply(this,arguments)}};var l=function(t){for(var n in t){e.prototype[n]=a(n,t[n])}};if(arguments.length>2){for(o=2;o<arguments.length;o++){l(arguments[o])}}return e}n.extend=E;function _(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}n.uuid=_;function w(e){if(e==null){return null}var t=e.replace(/^\s\s*/,""),n=/\s/,i=t.length;while(n.test(t.charAt(--i))){}return t.slice(0,i+1)}n.fastTrim=w;function D(e,t){e=e.length==null||typeof e==="string"?[e]:e;for(var n=0;n<e.length;n++){t(e[n])}}n.each=D;function S(e,t){var n=[];for(var i=0;i<e.length;i++){n.push(t(e[i]))}return n}n.map=S;function T(e,t,n){n=n||"parent";var i=function(e){return e?t[e]:null};var o=function(e){return e?i(e[n]):null};var s=function(e,t){if(e==null){return t}else{var n=["anchor","anchors","cssClass","connector","paintStyle","hoverPaintStyle","endpoint","endpoints"];if(t.mergeStrategy==="override"){Array.prototype.push.apply(n,["events","overlays"])}var i=d(e,t,[],n);return s(o(e),i)}};var r=function(e){if(e==null){return{}}if(typeof e==="string"){return i(e)}else if(e.length){var t=false,n=0,o=void 0;while(!t&&n<e.length){o=r(e[n]);if(o){t=true}else{n++}}return o}};var a=r(e);if(a){return s(o(a),a)}else{return{}}}n.mergeWithParents=T;n.logEnabled=true;function k(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}if(n.logEnabled&&typeof console!=="undefined"){try{var i=arguments[arguments.length-1];console.log(i)}catch(e){}}}n.log=k;function O(e,t,n){return function(){var i=null;try{if(t!=null){i=t.apply(this,arguments)}}catch(e){k("jsPlumb function failed : "+e)}if(e!=null&&(n==null||i!==n)){try{i=e.apply(this,arguments)}catch(e){k("wrapped function failed : "+e)}}return i}}n.wrap=O;var I=function(){function e(){var e=this;this._listeners={};this.eventsSuspended=false;this.tick=false;this.eventsToDieOn={ready:true};this.queue=[];this.bind=function(t,n,i){var o=function(t){j(e._listeners,t,n,i);n.__jsPlumb=n.__jsPlumb||{};n.__jsPlumb[_()]=t};if(typeof t==="string"){o(t)}else if(t.length!=null){for(var s=0;s<t.length;s++){o(t[s])}}return e};this.fire=function(e,t,n){if(!this.tick){this.tick=true;if(!this.eventsSuspended&&this._listeners[e]){var i=this._listeners[e].length,o=0,s=false,r=null;if(!this.shouldFireEvent||this.shouldFireEvent(e,t,n)){while(!s&&o<i&&r!==false){if(this.eventsToDieOn[e]){this._listeners[e][o].apply(this,[t,n])}else{try{r=this._listeners[e][o].apply(this,[t,n])}catch(t){k("jsPlumb: fire failed for event "+e+" : "+t)}}o++;if(this._listeners==null||this._listeners[e]==null){s=true}}}}this.tick=false;this._drain()}else{this.queue.unshift(arguments)}return this};this._drain=function(){var t=e.queue.pop();if(t){e.fire.apply(e,t)}};this.unbind=function(e,t){if(arguments.length===0){this._listeners={}}else if(arguments.length===1){if(typeof e==="string"){delete this._listeners[e]}else if(e.__jsPlumb){var n=void 0;for(var i in e.__jsPlumb){n=e.__jsPlumb[i];x(this._listeners[n]||[],e)}}}else if(arguments.length===2){x(this._listeners[e]||[],t)}return this};this.getListener=function(t){return e._listeners[t]};this.setSuspendEvents=function(t){e.eventsSuspended=t};this.isSuspendEvents=function(){return e.eventsSuspended};this.silently=function(t){e.setSuspendEvents(true);try{t()}catch(e){k("Cannot execute silent function "+e)}e.setSuspendEvents(false)};this.cleanupListeners=function(){for(var t in e._listeners){e._listeners[t]=null}}}return e}();n.EventGenerator=I}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this;e.jsPlumbUtil.matchesSelector=function(e,t,n){n=n||e.parentNode;var i=n.querySelectorAll(t);for(var o=0;o<i.length;o++){if(i[o]===e){return true}}return false};e.jsPlumbUtil.consume=function(e,t){if(e.stopPropagation){e.stopPropagation()}else{e.returnValue=false}if(!t&&e.preventDefault){e.preventDefault()}};e.jsPlumbUtil.sizeElement=function(e,t,n,i,o){if(e){e.style.height=o+"px";e.height=o;e.style.width=i+"px";e.width=i;e.style.left=t+"px";e.style.top=n+"px"}}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e={deriveAnchor:function(e,t,n,i){return{top:["TopRight","TopLeft"],bottom:["BottomRight","BottomLeft"]}[e][t]}};var t=this;var n=function(e){this.count=0;this.instance=e;this.lists={};this.instance.addList=function(e,t){return this.listManager.addList(e,t)};this.instance.removeList=function(e){this.listManager.removeList(e)};this.instance.bind("manageElement",function(e){var t=this.instance.getSelector(e.el,"[jtk-scrollable-list]");for(var n=0;n<t.length;n++){this.addList(t[n])}}.bind(this));this.instance.bind("unmanageElement",function(e){this.removeList(e.el)});this.instance.bind("connection",function(e,t){if(t==null){this._maybeUpdateParentList(e.source);this._maybeUpdateParentList(e.target)}}.bind(this))};t.jsPlumbListManager=n;n.prototype={addList:function(t,n){var o=this.instance.extend({},e);n=this.instance.extend(o,n||{});var s=[this.instance.getInstanceIndex(),this.count++].join("_");this.lists[s]=new i(this.instance,t,n,s)},removeList:function(e){var t=this.lists[e._jsPlumbList];if(t){t.destroy();delete this.lists[e._jsPlumbList]}},_maybeUpdateParentList:function(e){var t=e.parentNode,n=this.instance.getContainer();while(t!=null&&t!==n){if(t._jsPlumbList!=null&&this.lists[t._jsPlumbList]!=null){t._jsPlumbScrollHandler();return}t=t.parentNode}}};var i=function(e,t,n,i){t["_jsPlumbList"]=i;function o(e,t,i,o){return n.anchor?n.anchor:n.deriveAnchor(e,t,i,o)}function s(e,t,i,o){return n.deriveEndpoint?n.deriveEndpoint(e,t,i,o):n.endpoint?n.endpoint:i.type}function r(t){var n=t.parentNode,i=e.getContainer();while(n!=null&&n!==i){if(e.hasClass(n,"jtk-managed")){e.recalculateOffsets(n);return}n=n.parentNode}}var a=function(n){var i=e.getSelector(t,".jtk-managed");var a=e.getId(t);for(var l=0;l<i.length;l++){if(i[l].offsetTop<t.scrollTop){if(!i[l]._jsPlumbProxies){i[l]._jsPlumbProxies=i[l]._jsPlumbProxies||[];e.select({source:i[l]}).each(function(n){e.proxyConnection(n,0,t,a,function(){return s("top",0,n.endpoints[0],n)},function(){return o("top",0,n.endpoints[0],n)});i[l]._jsPlumbProxies.push([n,0])});e.select({target:i[l]}).each(function(n){e.proxyConnection(n,1,t,a,function(){return s("top",1,n.endpoints[1],n)},function(){return o("top",1,n.endpoints[1],n)});i[l]._jsPlumbProxies.push([n,1])})}}else if(i[l].offsetTop>t.scrollTop+t.offsetHeight){if(!i[l]._jsPlumbProxies){i[l]._jsPlumbProxies=i[l]._jsPlumbProxies||[];e.select({source:i[l]}).each(function(n){e.proxyConnection(n,0,t,a,function(){return s("bottom",0,n.endpoints[0],n)},function(){return o("bottom",0,n.endpoints[0],n)});i[l]._jsPlumbProxies.push([n,0])});e.select({target:i[l]}).each(function(n){e.proxyConnection(n,1,t,a,function(){return s("bottom",1,n.endpoints[1],n)},function(){return o("bottom",1,n.endpoints[1],n)});i[l]._jsPlumbProxies.push([n,1])})}}else if(i[l]._jsPlumbProxies){for(var c=0;c<i[l]._jsPlumbProxies.length;c++){e.unproxyConnection(i[l]._jsPlumbProxies[c][0],i[l]._jsPlumbProxies[c][1],a)}delete i[l]._jsPlumbProxies}e.revalidate(i[l])}r(t)};e.setAttribute(t,"jtk-scrollable-list","true");t._jsPlumbScrollHandler=a;e.on(t,"scroll",a);a();this.destroy=function(){e.off(t,"scroll",a);delete t._jsPlumbScrollHandler;var n=e.getSelector(t,".jtk-managed");var i=e.getId(t);for(var o=0;o<n.length;o++){if(n[o]._jsPlumbProxies){for(var s=0;s<n[o]._jsPlumbProxies.length;s++){e.unproxyConnection(n[o]._jsPlumbProxies[s][0],n[o]._jsPlumbProxies[s][1],i)}delete n[o]._jsPlumbProxies}}}}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this;var n=e.jsPlumbUtil,i=function(){return""+(new Date).getTime()},o=function(e){if(e._jsPlumb.paintStyle&&e._jsPlumb.hoverPaintStyle){var t={};m.extend(t,e._jsPlumb.paintStyle);m.extend(t,e._jsPlumb.hoverPaintStyle);delete e._jsPlumb.hoverPaintStyle;if(t.gradient&&e._jsPlumb.paintStyle.fill){delete t.gradient}e._jsPlumb.hoverPaintStyle=t}},s=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],r=function(e,t,n,i){var o=e.getAttachedElements();if(o){for(var s=0,r=o.length;s<r;s++){if(!i||i!==o[s]){o[s].setHover(t,true,n)}}}},a=function(e){return e==null?null:e.split(" ")},l=function(e,t,n){for(var i in t){e[i]=n}},c=function(e,t,i){if(e.getDefaultType){var o=e.getTypeDescriptor(),s={};var r=e.getDefaultType();var a=n.merge({},r);l(s,r,"__default");for(var c=0,u=e._jsPlumb.types.length;c<u;c++){var h=e._jsPlumb.types[c];if(h!=="__default"){var p=e._jsPlumb.instance.getType(h,o);if(p!=null){var f=["anchor","anchors","connector","paintStyle","hoverPaintStyle","endpoint","endpoints","connectorOverlays","connectorStyle","connectorHoverStyle","endpointStyle","endpointHoverStyle"];var d=[];if(p.mergeStrategy==="override"){Array.prototype.push.apply(f,["events","overlays","cssClass"])}else{d.push("cssClass")}a=n.merge(a,p,d,f);l(s,p,h)}}}if(t){a=n.populate(a,t,"_")}e.applyType(a,i,s);if(!i){e.repaint()}}},u=e.jsPlumbUIComponent=function(e){n.EventGenerator.apply(this,arguments);var t=this,i=arguments,o=t.idPrefix,s=o+(new Date).getTime();this._jsPlumb={instance:e._jsPlumb,parameters:e.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:false,beforeDetach:e.beforeDetach,beforeDrop:e.beforeDrop,overlayPlacements:[],hoverClass:e.hoverClass||e._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}};this.cacheTypeItem=function(e,t,n){this._jsPlumb.typeCache[n]=this._jsPlumb.typeCache[n]||{};this._jsPlumb.typeCache[n][e]=t};this.getCachedTypeItem=function(e,t){return this._jsPlumb.typeCache[t]?this._jsPlumb.typeCache[t][e]:null};this.getId=function(){return s};var r=e.overlays||[],a={};if(this.defaultOverlayKeys){for(var l=0;l<this.defaultOverlayKeys.length;l++){Array.prototype.push.apply(r,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[l]]||[])}for(l=0;l<r.length;l++){var c=m.convertToFullOverlaySpec(r[l]);a[c[1].id]=c}}var u={overlays:a,parameters:e.parameters||{},scope:e.scope||this._jsPlumb.instance.getDefaultScope()};this.getDefaultType=function(){return u};this.appendToDefaultType=function(e){for(var t in e){u[t]=e[t]}};if(e.events){for(var h in e.events){t.bind(h,e.events[h])}}this.clone=function(){var e=Object.create(this.constructor.prototype);this.constructor.apply(e,i);return e}.bind(this);this.isDetachAllowed=function(e){var t=true;if(this._jsPlumb.beforeDetach){try{t=this._jsPlumb.beforeDetach(e)}catch(e){n.log("jsPlumb: beforeDetach callback failed",e)}}return t};this.isDropAllowed=function(e,t,i,o,s,r,a){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:e,targetId:t,scope:i,connection:o,dropEndpoint:s,source:r,target:a});if(this._jsPlumb.beforeDrop){try{l=this._jsPlumb.beforeDrop({sourceId:e,targetId:t,scope:i,connection:o,dropEndpoint:s,source:r,target:a})}catch(e){n.log("jsPlumb: beforeDrop callback failed",e)}}return l};var p=[];this.setListenerComponent=function(e){for(var t=0;t<p.length;t++){p[t][3]=e}}};var h=function(e,t){var n=e._jsPlumb.types[t],i=e._jsPlumb.instance.getType(n,e.getTypeDescriptor());if(i!=null&&i.cssClass&&e.canvas){e._jsPlumb.instance.removeClass(e.canvas,i.cssClass)}};n.extend(e.jsPlumbUIComponent,n.EventGenerator,{getParameter:function(e){return this._jsPlumb.parameters[e]},setParameter:function(e,t){this._jsPlumb.parameters[e]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(e){this._jsPlumb.parameters=e},getClass:function(){return m.getClass(this.canvas)},hasClass:function(e){return m.hasClass(this.canvas,e)},addClass:function(e){m.addClass(this.canvas,e)},removeClass:function(e){m.removeClass(this.canvas,e)},updateClasses:function(e,t){m.updateClasses(this.canvas,e,t)},setType:function(e,t,n){this.clearTypes();this._jsPlumb.types=a(e)||[];c(this,t,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(e,t){c(this,e,t)},hasType:function(e){return this._jsPlumb.types.indexOf(e)!==-1},addType:function(e,t,n){var i=a(e),o=false;if(i!=null){for(var s=0,r=i.length;s<r;s++){if(!this.hasType(i[s])){this._jsPlumb.types.push(i[s]);o=true}}if(o){c(this,t,n)}}},removeType:function(e,t,n){var i=a(e),o=false,s=function(e){var t=this._jsPlumb.types.indexOf(e);if(t!==-1){h(this,t);this._jsPlumb.types.splice(t,1);return true}return false}.bind(this);if(i!=null){for(var r=0,l=i.length;r<l;r++){o=s(i[r])||o}if(o){c(this,t,n)}}},clearTypes:function(e,t){var n=this._jsPlumb.types.length;for(var i=0;i<n;i++){h(this,0);this._jsPlumb.types.splice(0,1)}c(this,e,t)},toggleType:function(e,t,n){var i=a(e);if(i!=null){for(var o=0,s=i.length;o<s;o++){var r=this._jsPlumb.types.indexOf(i[o]);if(r!==-1){h(this,r);this._jsPlumb.types.splice(r,1)}else{this._jsPlumb.types.push(i[o])}}c(this,t,n)}},applyType:function(e,t){this.setPaintStyle(e.paintStyle,t);this.setHoverPaintStyle(e.hoverPaintStyle,t);if(e.parameters){for(var n in e.parameters){this.setParameter(n,e.parameters[n])}}this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(e,t){this._jsPlumb.paintStyle=e;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;o(this);if(!t){this.repaint()}},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(e,t){this._jsPlumb.hoverPaintStyle=e;o(this);if(!t){this.repaint()}},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(e){if(e||this.typeId==null){this.cleanupListeners();this.clone=null;this._jsPlumb=null}},isHover:function(){return this._jsPlumb.hover},setHover:function(e,t,n){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=e;var o=e?"addClass":"removeClass";if(this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){this._jsPlumb.instance[o](this.canvas,this._jsPlumb.instance.hoverClass)}if(this._jsPlumb.hoverClass!=null){this._jsPlumb.instance[o](this.canvas,this._jsPlumb.hoverClass)}}if(this._jsPlumb.hoverPaintStyle!=null){this._jsPlumb.paintStyleInUse=e?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle;if(!this._jsPlumb.instance.isSuspendDrawing()){n=n||i();this.repaint({timestamp:n,recalc:false})}}if(this.getAttachedElements&&!t){r(this,e,i(),this)}}}});var p=0,f=function(){var e=p+1;p++;return e};var d=e.jsPlumbInstance=function(t){this.version="2.11.1";this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:false,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:false,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};if(t){m.extend(this.Defaults,t)}this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};n.EventGenerator.apply(this);var o=this,r=f(),a=o.bind,l={},c=1,h=function(e){if(e==null){return null}else if(e.nodeType===3||e.nodeType===8){return{el:e,text:true}}else{var t=o.getElement(e);return{el:t,id:n.isString(e)&&t==null?e:Y(t)}}};this.getInstanceIndex=function(){return r};this.setZoom=function(e,t){c=e;o.fire("zoom",c);if(t){o.repaintEverything()}return true};this.getZoom=function(){return c};for(var p in this.Defaults){l[p]=this.Defaults[p]}var d,v=[];this.unbindContainer=function(){if(d!=null&&v.length>0){for(var e=0;e<v.length;e++){o.off(d,v[e][0],v[e][1])}}};this.setContainer=function(e){this.unbindContainer();e=this.getElement(e);this.select().each(function(t){t.moveParent(e)});this.selectEndpoints().each(function(t){t.moveParent(e)});var t=d;d=e;v.length=0;var n={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"};var i=function(e,t,i){var s=t.srcElement||t.target,r=(s&&s.parentNode?s.parentNode._jsPlumb:null)||(s?s._jsPlumb:null)||(s&&s.parentNode&&s.parentNode.parentNode?s.parentNode.parentNode._jsPlumb:null);if(r){r.fire(e,r,t);var a=i?n[i+e]||e:e;o.fire(a,r.component||r,t)}};var r=function(e,t,n){v.push([e,n]);o.on(d,e,t,n)};var a=function(e){r(e,".jtk-connector",function(t){i(e,t)});r(e,".jtk-endpoint",function(t){i(e,t,"endpoint")});r(e,".jtk-overlay",function(t){i(e,t)})};for(var l=0;l<s.length;l++){a(s[l])}for(var c in j){var u=j[c].el;if(u.parentNode===t){t.removeChild(u);d.appendChild(u)}}};this.getContainer=function(){return d};this.bind=function(e,t){if("ready"===e&&g){t()}else{a.apply(o,[e,t])}};o.importDefaults=function(e){for(var t in e){o.Defaults[t]=e[t]}if(e.Container){o.setContainer(e.Container)}return o};o.restoreDefaults=function(){o.Defaults=m.extend({},l);return o};var y=null,g=false,b=[],x={},P={},j={},C={},E={},_=false,w=[],D=false,S=null,T=this.Defaults.Scope,k=1,O=function(){return""+k++},I=function(e,t){if(d){d.appendChild(e)}else if(!t){this.appendToRoot(e)}else{this.getElement(t).appendChild(e)}}.bind(this),A=function(e,t,n,s){if(!D){var r=Y(e),a,l=o.getDragManager();if(l){a=l.getElementsForDraggable(r)}if(n==null){n=i()}var c=me({elId:r,offset:t,recalc:false,timestamp:n});if(a&&c&&c.o){for(var u in a){me({elId:a[u].id,offset:{left:c.o.left+a[u].offset.left,top:c.o.top+a[u].offset.top},recalc:false,timestamp:n})}}o.anchorManager.redraw(r,t,n,null,s);if(a){for(var h in a){o.anchorManager.redraw(a[h].id,t,n,a[h].offset,s,true)}}}},N=function(e){return P[e]},M=function(e,t){var n=e.scope.split(/\s/),i=t.scope.split(/\s/);for(var o=0;o<n.length;o++){for(var s=0;s<i.length;s++){if(i[s]===n[o]){return true}}}return false},L=function(e,t){var n=m.extend({},e);for(var i in t){if(t[i]){n[i]=t[i]}}return n},F=function(e,t){var i=m.extend({},e);if(t){m.extend(i,t)}if(i.source){if(i.source.endpoint){i.sourceEndpoint=i.source}else{i.source=o.getElement(i.source)}}if(i.target){if(i.target.endpoint){i.targetEndpoint=i.target}else{i.target=o.getElement(i.target)}}if(e.uuids){i.sourceEndpoint=N(e.uuids[0]);i.targetEndpoint=N(e.uuids[1])}if(i.sourceEndpoint&&i.sourceEndpoint.isFull()){n.log(o,"could not add connection; source endpoint is full");return}if(i.targetEndpoint&&i.targetEndpoint.isFull()){n.log(o,"could not add connection; target endpoint is full");return}if(!i.type&&i.sourceEndpoint){i.type=i.sourceEndpoint.connectionType}if(i.sourceEndpoint&&i.sourceEndpoint.connectorOverlays){i.overlays=i.overlays||[];for(var s=0,r=i.sourceEndpoint.connectorOverlays.length;s<r;s++){i.overlays.push(i.sourceEndpoint.connectorOverlays[s])}}if(i.sourceEndpoint&&i.sourceEndpoint.scope){i.scope=i.sourceEndpoint.scope}if(!i["pointer-events"]&&i.sourceEndpoint&&i.sourceEndpoint.connectorPointerEvents){i["pointer-events"]=i.sourceEndpoint.connectorPointerEvents}var a=function(e,t,n){return o.addEndpoint(e,L(t,{anchor:i.anchors?i.anchors[n]:i.anchor,endpoint:i.endpoints?i.endpoints[n]:i.endpoint,paintStyle:i.endpointStyles?i.endpointStyles[n]:i.endpointStyle,hoverPaintStyle:i.endpointHoverStyles?i.endpointHoverStyles[n]:i.endpointHoverStyle}))};var l=function(e,t,n,o){if(i[e]&&!i[e].endpoint&&!i[e+"Endpoint"]&&!i.newConnection){var s=Y(i[e]),r=n[s];r=r?r[o]:null;if(r){if(!r.enabled){return false}var l=r.endpoint!=null&&r.endpoint._jsPlumb?r.endpoint:a(i[e],r.def,t);if(l.isFull()){return false}i[e+"Endpoint"]=l;if(!i.scope&&r.def.scope){i.scope=r.def.scope}if(r.uniqueEndpoint){if(!r.endpoint){r.endpoint=l;l.setDeleteOnEmpty(false)}else{l.finalEndpoint=r.endpoint}}else{l.setDeleteOnEmpty(true)}if(t===0&&r.def.connectorOverlays){i.overlays=i.overlays||[];Array.prototype.push.apply(i.overlays,r.def.connectorOverlays)}}}};if(l("source",0,this.sourceEndpointDefinitions,i.type||"default")===false){return}if(l("target",1,this.targetEndpointDefinitions,i.type||"default")===false){return}if(i.sourceEndpoint&&i.targetEndpoint){if(!M(i.sourceEndpoint,i.targetEndpoint)){i=null}}return i}.bind(o),W=function(e){var t=o.Defaults.ConnectionType||o.getDefaultConnectionType();e._jsPlumb=o;e.newConnection=W;e.newEndpoint=R;e.endpointsByUUID=P;e.endpointsByElement=x;e.finaliseConnection=H;e.id="con_"+O();var n=new t(e);if(n.isDetachable()){n.endpoints[0].initDraggable("_jsPlumbSource");n.endpoints[1].initDraggable("_jsPlumbTarget")}return n},H=o.finaliseConnection=function(e,t,n,i){t=t||{};if(!e.suspendedEndpoint){b.push(e)}e.pending=null;e.endpoints[0].isTemporarySource=false;if(i!==false){o.anchorManager.newConnection(e)}A(e.source);if(!t.doNotFireConnectionEvent&&t.fireEvent!==false){var s={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};o.fire("connection",s,n)}},R=function(e,t){var n=o.Defaults.EndpointType||m.Endpoint;var i=m.extend({},e);i._jsPlumb=o;i.newConnection=W;i.newEndpoint=R;i.endpointsByUUID=P;i.endpointsByElement=x;i.fireDetachEvent=V;i.elementId=t||Y(i.source);var s=new n(i);s.id="ep_"+O();fe(i.elementId,i.source);if(!m.headless){o.getDragManager().endpointAdded(i.source,t)}return s},U=function(e,t,n){var i=x[e];if(i&&i.length){for(var o=0,s=i.length;o<s;o++){for(var r=0,a=i[o].connections.length;r<a;r++){var l=t(i[o].connections[r]);if(l){return}}if(n){n(i[o])}}}},G=function(e,t,n){t=t==="block";var i=null;if(n){i=function(e){e.setVisible(t,true,true)}}var o=h(e);U(o.id,function(e){if(t&&n){var i=e.sourceId===o.id?1:0;if(e.endpoints[i].isVisible()){e.setVisible(true)}}else{e.setVisible(t)}},i)},B=function(e,t){var n=null;if(t){n=function(e){var t=e.isVisible();e.setVisible(!t)}}U(e,function(e){var t=e.isVisible();e.setVisible(!t)},n)},q=function(e){var t=C[e];if(!t){return me({elId:e})}else{return{o:t,s:w[e]}}},Y=function(e,t,i){if(n.isString(e)){return e}if(e==null){return null}var s=o.getAttribute(e,"id");if(!s||s==="undefined"){if(arguments.length===2&&arguments[1]!==undefined){s=t}else if(arguments.length===1||arguments.length===3&&!arguments[2]){s="jsPlumb_"+r+"_"+O()}if(!i){o.setAttribute(e,"id",s)}}return s};this.setConnectionBeingDragged=function(e){_=e};this.isConnectionBeingDragged=function(){return _};this.getManagedElements=function(){return j};this.connectorClass="jtk-connector";this.connectorOutlineClass="jtk-connector-outline";this.connectedClass="jtk-connected";this.hoverClass="jtk-hover";this.endpointClass="jtk-endpoint";this.endpointConnectedClass="jtk-endpoint-connected";this.endpointFullClass="jtk-endpoint-full";this.endpointDropAllowedClass="jtk-endpoint-drop-allowed";this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden";this.overlayClass="jtk-overlay";this.draggingClass="jtk-dragging";this.elementDraggingClass="jtk-element-dragging";this.sourceElementDraggingClass="jtk-source-element-dragging";this.targetElementDraggingClass="jtk-target-element-dragging";this.endpointAnchorClassPrefix="jtk-endpoint-anchor";this.hoverSourceClass="jtk-source-hover";this.hoverTargetClass="jtk-target-hover";this.dragSelectClass="jtk-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";this.addEndpoint=function(e,t,i){i=i||{};var s=m.extend({},i);m.extend(s,t);s.endpoint=s.endpoint||o.Defaults.Endpoint;s.paintStyle=s.paintStyle||o.Defaults.EndpointStyle;var r=[],a=n.isArray(e)||e.length!=null&&!n.isString(e)?e:[e];for(var l=0,c=a.length;l<c;l++){s.source=o.getElement(a[l]);he(s.source);var u=Y(s.source),h=R(s,u);var p=fe(u,s.source).info.o;n.addToList(x,u,h);if(!D){h.paint({anchorLoc:h.anchor.compute({xy:[p.left,p.top],wh:w[u],element:h,timestamp:S}),timestamp:S})}r.push(h)}return r.length===1?r[0]:r};this.addEndpoints=function(e,t,i){var s=[];for(var r=0,a=t.length;r<a;r++){var l=o.addEndpoint(e,t[r],i);if(n.isArray(l)){Array.prototype.push.apply(s,l)}else{s.push(l)}}return s};this.animate=function(e,t,i){if(!this.animationSupported){return false}i=i||{};var s=o.getElement(e),r=Y(s),a=m.animEvents.step,l=m.animEvents.complete;i[a]=n.wrap(i[a],function(){o.revalidate(r)});i[l]=n.wrap(i[l],function(){o.revalidate(r)});o.doAnimate(s,t,i)};this.checkCondition=function(e,t){var i=o.getListener(e),s=true;if(i&&i.length>0){var r=Array.prototype.slice.call(arguments,1);try{for(var a=0,l=i.length;a<l;a++){s=s&&i[a].apply(i[a],r)}}catch(t){n.log(o,"cannot check condition ["+e+"]"+t)}}return s};this.connect=function(e,t){var i=F(e,t),o;if(i){if(i.source==null&&i.sourceEndpoint==null){n.log("Cannot establish connection - source does not exist");return}if(i.target==null&&i.targetEndpoint==null){n.log("Cannot establish connection - target does not exist");return}he(i.source);o=W(i);H(o,i)}return o};var X=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];var z=function(e,t,n,i){var o,s=X[n],r=e[s.elId],a,l,c=e.endpoints[n];var u={index:n,originalSourceId:n===0?r:e.sourceId,newSourceId:e.sourceId,originalTargetId:n===1?r:e.targetId,newTargetId:e.targetId,connection:e};if(t.constructor===m.Endpoint){o=t;o.addConnection(e);t=o.element}else{a=Y(t);l=this[s.epDefs][a];if(a===e[s.elId]){o=null}else if(l){for(var h in l){if(!l[h].enabled){return}o=l[h].endpoint!=null&&l[h].endpoint._jsPlumb?l[h].endpoint:this.addEndpoint(t,l[h].def);if(l[h].uniqueEndpoint){l[h].endpoint=o}o.addConnection(e)}}else{o=e.makeEndpoint(n===0,t,a)}}if(o!=null){c.detachFromConnection(e);e.endpoints[n]=o;e[s.el]=o.element;e[s.elId]=o.elementId;u[n===0?"newSourceId":"newTargetId"]=o.elementId;$(u);if(!i){e.repaint()}}u.element=t;return u}.bind(this);this.setSource=function(e,t,n){var i=z(e,t,0,n);this.anchorManager.sourceChanged(i.originalSourceId,i.newSourceId,e,i.el)};this.setTarget=function(e,t,n){var i=z(e,t,1,n);this.anchorManager.updateOtherEndpoint(i.originalSourceId,i.originalTargetId,i.newTargetId,e)};this.deleteEndpoint=function(e,t,n){var i=typeof e==="string"?P[e]:e;if(i){o.deleteObject({endpoint:i,dontUpdateHover:t,deleteAttachedObjects:n})}return o};this.deleteEveryEndpoint=function(){var e=o.setSuspendDrawing(true);for(var t in x){var n=x[t];if(n&&n.length){for(var i=0,s=n.length;i<s;i++){o.deleteEndpoint(n[i],true)}}}x={};j={};P={};C={};E={};o.anchorManager.reset();var r=o.getDragManager();if(r){r.reset()}if(!e){o.setSuspendDrawing(false)}return o};var V=function(e,t,n){var i=o.Defaults.ConnectionType||o.getDefaultConnectionType(),s=e.constructor===i,r=s?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;if(t){o.fire("connectionDetached",r,n)}o.fire("internal.connectionDetached",r,n);o.anchorManager.connectionDetached(r)};var $=o.fireMoveEvent=function(e,t){o.fire("connectionMoved",e,t)};this.unregisterEndpoint=function(e){if(e._jsPlumb.uuid){P[e._jsPlumb.uuid]=null}o.anchorManager.deleteEndpoint(e);for(var t in x){var n=x[t];if(n){var i=[];for(var s=0,r=n.length;s<r;s++){if(n[s]!==e){i.push(n[s])}}x[t]=i}if(x[t].length<1){delete x[t]}}};var J="isDetachAllowed";var Z="beforeDetach";var K="checkCondition";this.deleteConnection=function(e,t){if(e!=null){t=t||{};if(t.force||n.functionChain(true,false,[[e.endpoints[0],J,[e]],[e.endpoints[1],J,[e]],[e,J,[e]],[o,K,[Z,e]]])){e.setHover(false);V(e,!e.pending&&t.fireEvent!==false,t.originalEvent);e.endpoints[0].detachFromConnection(e);e.endpoints[1].detachFromConnection(e);n.removeWithFunction(b,function(t){return e.id===t.id});e.cleanup();e.destroy();return true}}return false};this.deleteEveryConnection=function(e){e=e||{};var t=b.length,n=0;o.batch(function(){for(var i=0;i<t;i++){n+=o.deleteConnection(b[0],e)?1:0}});return n};this.deleteConnectionsForElement=function(e,t){t=t||{};e=o.getElement(e);var n=Y(e),i=x[n];if(i&&i.length){for(var s=0,r=i.length;s<r;s++){i[s].deleteEveryConnection(t)}}return o};this.deleteObject=function(e){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},i=e.deleteAttachedObjects!==false;var s=function(n){if(n!=null&&t.connections[n.id]==null){if(!e.dontUpdateHover&&n._jsPlumb!=null){n.setHover(false)}t.connections[n.id]=n;t.connectionCount++}};var r=function(n){if(n!=null&&t.endpoints[n.id]==null){if(!e.dontUpdateHover&&n._jsPlumb!=null){n.setHover(false)}t.endpoints[n.id]=n;t.endpointCount++;if(i){for(var o=0;o<n.connections.length;o++){var r=n.connections[o];s(r)}}}};if(e.connection){s(e.connection)}else{r(e.endpoint)}for(var a in t.connections){var l=t.connections[a];if(l._jsPlumb){n.removeWithFunction(b,function(e){return l.id===e.id});V(l,e.fireEvent===false?false:!l.pending,e.originalEvent);var c=e.deleteAttachedObjects==null?null:!e.deleteAttachedObjects;l.endpoints[0].detachFromConnection(l,null,c);l.endpoints[1].detachFromConnection(l,null,c);l.cleanup(true);l.destroy(true)}}for(var u in t.endpoints){var h=t.endpoints[u];if(h._jsPlumb){o.unregisterEndpoint(h);h.cleanup(true);h.destroy(true)}}return t};var Q=function(e,t,n,i){for(var o=0,s=e.length;o<s;o++){e[o][t].apply(e[o],n)}return i(e)},ee=function(e,t,n){var i=[];for(var o=0,s=e.length;o<s;o++){i.push([e[o][t].apply(e[o],n),e[o]])}return i},te=function(e,t,n){return function(){return Q(e,t,arguments,n)}},ne=function(e,t){return function(){return ee(e,t,arguments)}},ie=function(e,t){var n=[];if(e){if(typeof e==="string"){if(e==="*"){return e}n.push(e)}else{if(t){n=e}else{if(e.length){for(var i=0,o=e.length;i<o;i++){n.push(h(e[i]).id)}}else{n.push(h(e).id)}}}}return n},oe=function(e,t,n){if(e==="*"){return true}return e.length>0?e.indexOf(t)!==-1:!n};this.getConnections=function(e,t){if(!e){e={}}else if(e.constructor===String){e={scope:e}}var n=e.scope||o.getDefaultScope(),i=ie(n,true),s=ie(e.source),r=ie(e.target),a=!t&&i.length>1?{}:[],l=function(e,n){if(!t&&i.length>1){var o=a[e];if(o==null){o=a[e]=[]}o.push(n)}else{a.push(n)}};for(var c=0,u=b.length;c<u;c++){var h=b[c],p=h.proxies&&h.proxies[0]?h.proxies[0].originalEp.elementId:h.sourceId,f=h.proxies&&h.proxies[1]?h.proxies[1].originalEp.elementId:h.targetId;if(oe(i,h.scope)&&oe(s,p)&&oe(r,f)){l(h.scope,h)}}return a};var se=function(e,t){return function(n){for(var i=0,o=e.length;i<o;i++){n(e[i])}return t(e)}},re=function(e){return function(t){return e[t]}};var ae=function(e,t){var n={length:e.length,each:se(e,t),get:re(e)},i=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],o=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],s,r;for(s=0,r=i.length;s<r;s++){n[i[s]]=te(e,i[s],t)}for(s=0,r=o.length;s<r;s++){n[o[s]]=ne(e,o[s])}return n};var le=function(e){var t=ae(e,le);return m.extend(t,{setDetachable:te(e,"setDetachable",le),setReattach:te(e,"setReattach",le),setConnector:te(e,"setConnector",le),delete:function(){for(var t=0,n=e.length;t<n;t++){o.deleteConnection(e[t])}},isDetachable:ne(e,"isDetachable"),isReattach:ne(e,"isReattach")})};var ce=function(e){var t=ae(e,ce);return m.extend(t,{setEnabled:te(e,"setEnabled",ce),setAnchor:te(e,"setAnchor",ce),isEnabled:ne(e,"isEnabled"),deleteEveryConnection:function(){for(var t=0,n=e.length;t<n;t++){e[t].deleteEveryConnection()}},delete:function(){for(var t=0,n=e.length;t<n;t++){o.deleteEndpoint(e[t])}}})};this.select=function(e){e=e||{};e.scope=e.scope||"*";return le(e.connections||o.getConnections(e,true))};this.selectEndpoints=function(e){e=e||{};e.scope=e.scope||"*";var t=!e.element&&!e.source&&!e.target,n=t?"*":ie(e.element),i=t?"*":ie(e.source),o=t?"*":ie(e.target),s=ie(e.scope,true);var r=[];for(var a in x){var l=oe(n,a,true),c=oe(i,a,true),u=i!=="*",h=oe(o,a,true),p=o!=="*";if(l||c||h){e:for(var f=0,d=x[a].length;f<d;f++){var m=x[a][f];if(oe(s,m.scope,true)){var v=u&&i.length>0&&!m.isSource,y=p&&o.length>0&&!m.isTarget;if(v||y){continue e}r.push(m)}}}}return ce(r)};this.getAllConnections=function(){return b};this.getDefaultScope=function(){return T};this.getEndpoint=N;this.getEndpoints=function(e){return x[h(e).id]||[]};this.getDefaultEndpointType=function(){return m.Endpoint};this.getDefaultConnectionType=function(){return m.Connection};this.getId=Y;this.draw=A;this.info=h;this.appendElement=I;var ue=false;this.isHoverSuspended=function(){return ue};this.setHoverSuspended=function(e){ue=e};this.hide=function(e,t){G(e,"none",t);return o};this.idstamp=O;var he=function(e){if(!d&&e){var t=o.getElement(e);if(t.offsetParent){o.setContainer(t.offsetParent)}}};var pe=function(){if(o.Defaults.Container){o.setContainer(o.Defaults.Container)}};var fe=o.manage=function(e,t,n){if(!j[e]){j[e]={el:t,endpoints:[],connections:[]};j[e].info=me({elId:e,timestamp:S});o.addClass(t,"jtk-managed");if(!n){o.fire("manageElement",{id:e,info:j[e].info,el:t})}}return j[e]};var de=o.unmanage=function(e){if(j[e]){var t=j[e].el;o.removeClass(t,"jtk-managed");delete j[e];o.fire("unmanageElement",{id:e,el:t})}};var me=function(e){var t=e.timestamp,n=e.recalc,i=e.offset,s=e.elId,r;if(D&&!t){t=S}if(!n){if(t&&t===E[s]){return{o:e.offset||C[s],s:w[s]}}}if(n||!i&&C[s]==null){r=j[s]?j[s].el:null;if(r!=null){w[s]=o.getSize(r);C[s]=o.getOffset(r);E[s]=t}}else{C[s]=i||C[s];if(w[s]==null){r=j[s].el;if(r!=null){w[s]=o.getSize(r)}}E[s]=t}if(C[s]&&!C[s].right){C[s].right=C[s].left+w[s][0];C[s].bottom=C[s].top+w[s][1];C[s].width=w[s][0];C[s].height=w[s][1];C[s].centerx=C[s].left+C[s].width/2;C[s].centery=C[s].top+C[s].height/2}return{o:C[s],s:w[s]}};this.updateOffset=me;this.init=function(){if(!g){pe();o.anchorManager=new e.jsPlumb.AnchorManager({jsPlumbInstance:o});g=true;o.fire("ready",o)}}.bind(this);this.log=y;this.jsPlumbUIComponent=u;this.makeAnchor=function(){var t,i=function(t,n){if(e.jsPlumb.Anchors[t]){return new e.jsPlumb.Anchors[t](n)}if(!o.Defaults.DoNotThrowErrors){throw{msg:"jsPlumb: unknown anchor type '"+t+"'"}}};if(arguments.length===0){return null}var s=arguments[0],r=arguments[1],a=null;if(s.compute&&s.getOrientation){return s}else if(typeof s==="string"){a=i(arguments[0],{elementId:r,jsPlumbInstance:o})}else if(n.isArray(s)){if(n.isArray(s[0])||n.isString(s[0])){if(s.length===2&&n.isObject(s[1])){if(n.isString(s[0])){t=e.jsPlumb.extend({elementId:r,jsPlumbInstance:o},s[1]);a=i(s[0],t)}else{t=e.jsPlumb.extend({elementId:r,jsPlumbInstance:o,anchors:s[0]},s[1]);a=new e.jsPlumb.DynamicAnchor(t)}}else{a=new m.DynamicAnchor({anchors:s,selector:null,elementId:r,jsPlumbInstance:o})}}else{var l={x:s[0],y:s[1],orientation:s.length>=4?[s[2],s[3]]:[0,0],offsets:s.length>=6?[s[4],s[5]]:[0,0],elementId:r,jsPlumbInstance:o,cssClass:s.length===7?s[6]:null};a=new e.jsPlumb.Anchor(l);a.clone=function(){return new e.jsPlumb.Anchor(l)}}}if(!a.id){a.id="anchor_"+O()}return a};this.makeAnchors=function(t,i,s){var r=[];for(var a=0,l=t.length;a<l;a++){if(typeof t[a]==="string"){r.push(e.jsPlumb.Anchors[t[a]]({elementId:i,jsPlumbInstance:s}))}else if(n.isArray(t[a])){r.push(o.makeAnchor(t[a],i,s))}}return r};this.makeDynamicAnchor=function(t,n){return new e.jsPlumb.DynamicAnchor({anchors:t,selector:n,elementId:null,jsPlumbInstance:o})};this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};var ve=function(e,t,n,i,o){var s=e.target||e.srcElement,r=false,a=i.getSelector(t,n);for(var l=0;l<a.length;l++){if(a[l]===s){r=true;break}}return o?!r:r};var ye=function(t,i,s,r,a){var l=new u(i);var c=i._jsPlumb.EndpointDropHandler({jsPlumb:o,enabled:function(){return t.def.enabled},isFull:function(){var e=o.select({target:t.id}).length;return t.def.maxConnections>0&&e>=t.def.maxConnections},element:t.el,elementId:t.id,isSource:r,isTarget:a,addClass:function(e){o.addClass(t.el,e)},removeClass:function(e){o.removeClass(t.el,e)},onDrop:function(e){var t=e.endpoints[0];t.anchor.unlock()},isDropAllowed:function(){return l.isDropAllowed.apply(l,arguments)},isRedrop:function(e){return e.suspendedElement!=null&&e.suspendedEndpoint!=null&&e.suspendedEndpoint.element===t.el},getEndpoint:function(n){var s=t.def.endpoint;if(s==null||s._jsPlumb==null){var r=o.deriveEndpointAndAnchorSpec(n.getType().join(" "),true);var a=r.endpoints?e.jsPlumb.extend(i,{endpoint:t.def.def.endpoint||r.endpoints[1]}):i;if(r.anchors){a=e.jsPlumb.extend(a,{anchor:t.def.def.anchor||r.anchors[1]})}s=o.addEndpoint(t.el,a);s._mtNew=true}if(i.uniqueEndpoint){t.def.endpoint=s}s.setDeleteOnEmpty(true);if(n.isDetachable()){s.initDraggable()}if(s.anchor.positionFinder!=null){var l=o.getUIPosition(arguments,o.getZoom()),c=o.getOffset(t.el),u=o.getSize(t.el),h=l==null?[0,0]:s.anchor.positionFinder(l,c,u,s.anchor.constructorParams);s.anchor.x=h[0];s.anchor.y=h[1]}return s},maybeCleanup:function(e){if(e._mtNew&&e.connections.length===0){o.deleteObject({endpoint:e})}else{delete e._mtNew}}});var h=e.jsPlumb.dragEvents.drop;s.scope=s.scope||(i.scope||o.Defaults.Scope);s[h]=n.wrap(s[h],c,true);s.rank=i.rank||0;if(a){s[e.jsPlumb.dragEvents.over]=function(){return true}}if(i.allowLoopback===false){s.canDrop=function(e){var n=e.getDragElement()._jsPlumbRelatedElement;return n!==t.el}}o.initDroppable(t.el,s,"internal");return c};this.makeTarget=function(t,n,i){var s=e.jsPlumb.extend({_jsPlumb:this},i);e.jsPlumb.extend(s,n);var r=s.maxConnections||-1,a=function(t){var n=h(t),i=n.id,a=e.jsPlumb.extend({},s.dropOptions||{}),l=s.connectionType||"default";this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[i]||{};he(i);if(n.el._isJsPlumbGroup&&a.rank==null){a.rank=-1}var c={def:e.jsPlumb.extend({},s),uniqueEndpoint:s.uniqueEndpoint,maxConnections:r,enabled:true};if(s.createEndpoint){c.uniqueEndpoint=true;c.endpoint=o.addEndpoint(t,c.def);c.endpoint.setDeleteOnEmpty(false)}n.def=c;this.targetEndpointDefinitions[i][l]=c;ye(n,s,a,s.isSource===true,true);n.el._katavorioDrop[n.el._katavorioDrop.length-1].targetDef=c}.bind(this);var l=t.length&&t.constructor!==String?t:[t];for(var c=0,u=l.length;c<u;c++){a(l[c])}return this};this.unmakeTarget=function(e,t){var n=h(e);o.destroyDroppable(n.el,"internal");if(!t){delete this.targetEndpointDefinitions[n.id]}return this};this.makeSource=function(t,i,s){var r=e.jsPlumb.extend({_jsPlumb:this},s);e.jsPlumb.extend(r,i);var a=r.connectionType||"default";var l=o.deriveEndpointAndAnchorSpec(a);r.endpoint=r.endpoint||l.endpoints[0];r.anchor=r.anchor||l.anchors[0];var u=r.maxConnections||-1,p=r.onMaxConnections,f=function(i){var s=i.id,l=this.getElement(i.el);this.sourceEndpointDefinitions[s]=this.sourceEndpointDefinitions[s]||{};he(s);var h={def:e.jsPlumb.extend({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:u,enabled:true};if(r.createEndpoint){h.uniqueEndpoint=true;h.endpoint=o.addEndpoint(t,h.def);h.endpoint.setDeleteOnEmpty(false)}this.sourceEndpointDefinitions[s][a]=h;i.def=h;var f=e.jsPlumb.dragEvents.stop,d=e.jsPlumb.dragEvents.drag,m=e.jsPlumb.extend({},r.dragOptions||{}),v=m.drag,y=m.stop,g=null,b=false;m.scope=m.scope||r.scope;m[d]=n.wrap(m[d],function(){if(v){v.apply(this,arguments)}b=false});m[f]=n.wrap(m[f],function(){if(y){y.apply(this,arguments)}this.currentlyDragging=false;if(g._jsPlumb!=null){var e=r.anchor||this.Defaults.Anchor,t=g.anchor,n=g.connections[0];var i=this.makeAnchor(e,s,this),a=g.element;if(i.positionFinder!=null){var l=o.getOffset(a),c=this.getSize(a),u={left:l.left+t.x*c[0],top:l.top+t.y*c[1]},h=i.positionFinder(u,l,c,i.constructorParams);i.x=h[0];i.y=h[1]}g.setAnchor(i,true);g.repaint();this.repaint(g.elementId);if(n!=null){this.repaint(n.targetId)}}}.bind(this));var x=function(t){if(t.which===3||t.button===2){return}var h=this.sourceEndpointDefinitions[s][a];if(!h.enabled){return}s=this.getId(this.getElement(i.el));if(r.filter){var f=n.isString(r.filter)?ve(t,i.el,r.filter,this,r.filterExclude):r.filter(t,i.el);if(f===false){return}}var d=this.select({source:s}).length;if(h.maxConnections>=0&&d>=h.maxConnections){if(p){p({element:i.el,maxConnections:u},t)}return false}var v=e.jsPlumb.getPositionOnElement(t,l,c);var y={};e.jsPlumb.extend(y,h.def);y.isTemporarySource=true;y.anchor=[v[0],v[1],0,0];y.dragOptions=m;if(h.def.scope){y.scope=h.def.scope}g=this.addEndpoint(s,y);b=true;g.setDeleteOnEmpty(true);if(h.uniqueEndpoint){if(!h.endpoint){h.endpoint=g;g.setDeleteOnEmpty(false)}else{g.finalEndpoint=h.endpoint}}var x=function(){o.off(g.canvas,"mouseup",x);o.off(i.el,"mouseup",x);if(b){b=false;o.deleteEndpoint(g)}};o.on(g.canvas,"mouseup",x);o.on(i.el,"mouseup",x);var P={};if(h.def.extract){for(var j in h.def.extract){var C=(t.srcElement||t.target).getAttribute(j);if(C){P[h.def.extract[j]]=C}}}o.trigger(g.canvas,"mousedown",t,P);n.consume(t)}.bind(this);this.on(i.el,"mousedown",x);h.trigger=x;if(r.filter&&(n.isString(r.filter)||n.isFunction(r.filter))){o.setDragFilter(i.el,r.filter)}var P=e.jsPlumb.extend({},r.dropOptions||{});ye(i,r,P,true,r.isTarget===true)}.bind(this);var d=t.length&&t.constructor!==String?t:[t];for(var m=0,v=d.length;m<v;m++){f(h(d[m]))}return this};this.unmakeSource=function(e,t,n){var i=h(e);o.destroyDroppable(i.el,"internal");var s=this.sourceEndpointDefinitions[i.id];if(s){for(var r in s){if(t==null||t===r){var a=s[r].trigger;if(a){o.off(i.el,"mousedown",a)}if(!n){delete this.sourceEndpointDefinitions[i.id][r]}}}}return this};this.unmakeEverySource=function(){for(var e in this.sourceEndpointDefinitions){o.unmakeSource(e,null,true)}this.sourceEndpointDefinitions={};return this};var ge=function(e,t,i){t=n.isArray(t)?t:[t];var o=Y(e);i=i||"default";for(var s=0;s<t.length;s++){var r=this[t[s]][o];if(r&&r[i]){return r[i].def.scope||this.Defaults.Scope}}}.bind(this);var be=function(e,t,i,o){i=n.isArray(i)?i:[i];var s=Y(e);o=o||"default";for(var r=0;r<i.length;r++){var a=this[i[r]][s];if(a&&a[o]){a[o].def.scope=t}}}.bind(this);this.getScope=function(e,t){return ge(e,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(e){return ge(e,"sourceEndpointDefinitions")};this.getTargetScope=function(e){return ge(e,"targetEndpointDefinitions")};this.setScope=function(e,t,n){this.setSourceScope(e,t,n);this.setTargetScope(e,t,n)};this.setSourceScope=function(e,t,n){be(e,t,"sourceEndpointDefinitions",n);this.setDragScope(e,t)};this.setTargetScope=function(e,t,n){be(e,t,"targetEndpointDefinitions",n);this.setDropScope(e,t)};this.unmakeEveryTarget=function(){for(var e in this.targetEndpointDefinitions){o.unmakeTarget(e,true)}this.targetEndpointDefinitions={};return this};var xe=function(e,t,i,s,r){var a=e==="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,l,c,u;r=r||"default";if(t.length&&!n.isString(t)){l=[];for(var p=0,f=t.length;p<f;p++){c=h(t[p]);if(a[c.id]&&a[c.id][r]){l[p]=a[c.id][r].enabled;u=s?!l[p]:i;a[c.id][r].enabled=u;o[u?"removeClass":"addClass"](c.el,"jtk-"+e+"-disabled")}}}else{c=h(t);var d=c.id;if(a[d]&&a[d][r]){l=a[d][r].enabled;u=s?!l:i;a[d][r].enabled=u;o[u?"removeClass":"addClass"](c.el,"jtk-"+e+"-disabled")}}return l}.bind(this);var Pe=function(e,t){if(n.isString(e)||!e.length){return t.apply(this,[e])}else if(e.length){return t.apply(this,[e[0]])}}.bind(this);this.toggleSourceEnabled=function(e,t){xe("source",e,null,true,t);return this.isSourceEnabled(e,t)};this.setSourceEnabled=function(e,t,n){return xe("source",e,t,null,n)};this.isSource=function(e,t){t=t||"default";return Pe(e,function(e){var n=this.sourceEndpointDefinitions[h(e).id];return n!=null&&n[t]!=null}.bind(this))};this.isSourceEnabled=function(e,t){t=t||"default";return Pe(e,function(e){var n=this.sourceEndpointDefinitions[h(e).id];return n&&n[t]&&n[t].enabled===true}.bind(this))};this.toggleTargetEnabled=function(e,t){xe("target",e,null,true,t);return this.isTargetEnabled(e,t)};this.isTarget=function(e,t){t=t||"default";return Pe(e,function(e){var n=this.targetEndpointDefinitions[h(e).id];return n!=null&&n[t]!=null}.bind(this))};this.isTargetEnabled=function(e,t){t=t||"default";return Pe(e,function(e){var n=this.targetEndpointDefinitions[h(e).id];return n&&n[t]&&n[t].enabled===true}.bind(this))};this.setTargetEnabled=function(e,t,n){return xe("target",e,t,null,n)};this.ready=function(e){o.bind("ready",e)};var je=function(e,t){if(typeof e==="object"&&e.length){for(var n=0,i=e.length;n<i;n++){t(e[n])}}else{t(e)}return o};this.repaint=function(e,t,n){return je(e,function(e){A(e,t,n)})};this.revalidate=function(e,t,n){return je(e,function(e){var i=n?e:o.getId(e);o.updateOffset({elId:i,recalc:true,timestamp:t});var s=o.getDragManager();if(s){s.updateOffsets(i)}o.repaint(e)})};this.repaintEverything=function(){var e=i(),t;for(t in x){o.updateOffset({elId:t,recalc:true,timestamp:e})}for(t in x){A(t,null,e)}return this};this.removeAllEndpoints=function(e,t,n){n=n||[];var i=function(e){var s=h(e),r=x[s.id],a,l;if(r){n.push(s);for(a=0,l=r.length;a<l;a++){o.deleteEndpoint(r[a],false)}}delete x[s.id];if(t){if(s.el&&s.el.nodeType!==3&&s.el.nodeType!==8){for(a=0,l=s.el.childNodes.length;a<l;a++){i(s.el.childNodes[a])}}}};i(e);return this};var Ce=function(e,t){o.removeAllEndpoints(e.id,true,t);var n=o.getDragManager();var i=function(e){if(n){n.elementRemoved(e.id)}o.anchorManager.clearFor(e.id);o.anchorManager.removeFloatingConnection(e.id);if(o.isSource(e.el)){o.unmakeSource(e.el)}if(o.isTarget(e.el)){o.unmakeTarget(e.el)}o.destroyDraggable(e.el);o.destroyDroppable(e.el);delete o.floatingConnections[e.id];delete j[e.id];delete C[e.id];if(e.el){o.removeElement(e.el);e.el._jsPlumb=null}};for(var s=1;s<t.length;s++){i(t[s])}i(e)};this.remove=function(e,t){var n=h(e),i=[];if(n.text){n.el.parentNode.removeChild(n.el)}else if(n.id){o.batch(function(){Ce(n,i)},t===true)}return o};this.empty=function(e,t){var n=[];var i=function(e,t){var o=h(e);if(o.text){o.el.parentNode.removeChild(o.el)}else if(o.el){while(o.el.childNodes.length>0){i(o.el.childNodes[0])}if(!t){Ce(o,n)}}};o.batch(function(){i(e,true)},t===false);return o};this.reset=function(e){o.silently(function(){ue=false;o.removeAllGroups();o.removeGroupManager();o.deleteEveryEndpoint();if(!e){o.unbind()}this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};b.length=0;if(this.doReset){this.doReset()}}.bind(this))};var Ee=function(e){if(e.canvas&&e.canvas.parentNode){e.canvas.parentNode.removeChild(e.canvas)}e.cleanup();e.destroy()};this.clear=function(){o.select().each(Ee);o.selectEndpoints().each(Ee);x={};P={}};this.setDefaultScope=function(e){T=e;return o};this.deriveEndpointAndAnchorSpec=function(e,t){var n=((t?"":"default ")+e).split(/[\s]/),i=null,s=null,r=null,a=null;for(var l=0;l<n.length;l++){var c=o.getType(n[l],"connection");if(c){if(c.endpoints){i=c.endpoints}if(c.endpoint){s=c.endpoint}if(c.anchors){a=c.anchors}if(c.anchor){r=c.anchor}}}return{endpoints:i?i:[s,s],anchors:a?a:[r,r]}};this.setId=function(e,t,i){var o;if(n.isString(e)){o=e}else{e=this.getElement(e);o=this.getId(e)}var s=this.getConnections({source:o,scope:"*"},true),r=this.getConnections({target:o,scope:"*"},true);t=""+t;if(!i){e=this.getElement(o);this.setAttribute(e,"id",t)}else{e=this.getElement(t)}x[t]=x[o]||[];for(var a=0,l=x[t].length;a<l;a++){x[t][a].setElementId(t);x[t][a].setReferenceElement(e)}delete x[o];this.sourceEndpointDefinitions[t]=this.sourceEndpointDefinitions[o];delete this.sourceEndpointDefinitions[o];this.targetEndpointDefinitions[t]=this.targetEndpointDefinitions[o];delete this.targetEndpointDefinitions[o];this.anchorManager.changeId(o,t);var c=this.getDragManager();if(c){c.changeId(o,t)}j[t]=j[o];delete j[o];var u=function(n,i,o){for(var s=0,r=n.length;s<r;s++){n[s].endpoints[i].setElementId(t);n[s].endpoints[i].setReferenceElement(e);n[s][o+"Id"]=t;n[s][o]=e}};u(s,0,"source");u(r,1,"target");this.repaint(t)};this.setDebugLog=function(e){y=e};this.setSuspendDrawing=function(e,t){var n=D;D=e;if(e){S=(new Date).getTime()}else{S=null}if(t){this.repaintEverything()}return n};this.isSuspendDrawing=function(){return D};this.getSuspendedAt=function(){return S};this.batch=function(e,t){var i=this.isSuspendDrawing();if(!i){this.setSuspendDrawing(true)}try{e()}catch(e){n.log("Function run while suspended failed",e)}if(!i){this.setSuspendDrawing(false,!t)}};this.doWhileSuspended=this.batch;this.getCachedData=q;this.timestamp=i;this.show=function(e,t){G(e,"block",t);return o};this.toggleVisible=B;this.addListener=this.bind;var _e=[];this.registerFloatingConnection=function(e,t,i){_e[e.id]=t;n.addToList(x,e.id,i)};this.getFloatingConnectionFor=function(e){return _e[e]};this.listManager=new e.jsPlumbListManager(this)};n.extend(e.jsPlumbInstance,n.EventGenerator,{setAttribute:function(e,t,n){this.setAttribute(e,t,n)},getAttribute:function(t,n){return this.getAttribute(e.jsPlumb.getElement(t),n)},convertToFullOverlaySpec:function(e){if(n.isString(e)){e=[e,{}]}e[1].id=e[1].id||n.uuid();return e},registerConnectionType:function(t,n){this._connectionTypes[t]=e.jsPlumb.extend({},n);if(n.overlays){var i={};for(var o=0;o<n.overlays.length;o++){var s=this.convertToFullOverlaySpec(n.overlays[o]);i[s[1].id]=s}this._connectionTypes[t].overlays=i}},registerConnectionTypes:function(e){for(var t in e){this.registerConnectionType(t,e[t])}},registerEndpointType:function(t,n){this._endpointTypes[t]=e.jsPlumb.extend({},n);if(n.overlays){var i={};for(var o=0;o<n.overlays.length;o++){var s=this.convertToFullOverlaySpec(n.overlays[o]);i[s[1].id]=s}this._endpointTypes[t].overlays=i}},registerEndpointTypes:function(e){for(var t in e){this.registerEndpointType(t,e[t])}},getType:function(e,t){return t==="connection"?this._connectionTypes[e]:this._endpointTypes[e]},setIdChanged:function(e,t){this.setId(e,t,true)},setParent:function(e,t){var n=this.getElement(e),i=this.getId(n),o=this.getElement(t),s=this.getId(o),r=this.getDragManager();n.parentNode.removeChild(n);o.appendChild(n);if(r){r.setParent(n,i,o,s)}},extend:function(e,t,n){var i;if(n){for(i=0;i<n.length;i++){e[n[i]]=t[n[i]]}}else{for(i in t){e[i]=t[i]}}return e},floatingConnections:{},getFloatingAnchorIndex:function(e){return e.endpoints[0].isFloating()?0:e.endpoints[1].isFloating()?1:-1},proxyConnection:function(e,t,n,i,o,s){var r,a=e.endpoints[t].elementId,l=e.endpoints[t];e.proxies=e.proxies||[];if(e.proxies[t]){r=e.proxies[t].ep}else{r=this.addEndpoint(n,{endpoint:o(e,t),anchor:s(e,t),parameters:{isProxyEndpoint:true}})}r.setDeleteOnEmpty(true);e.proxies[t]={ep:r,originalEp:l};if(t===0){this.anchorManager.sourceChanged(a,i,e,n)}else{this.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,a,i,e);e.target=n;e.targetId=i}l.detachFromConnection(e,null,true);r.connections=[e];e.endpoints[t]=r;l.setVisible(false);e.setVisible(true);this.revalidate(n)},unproxyConnection:function(e,t,n){if(e._jsPlumb==null||e.proxies==null||e.proxies[t]==null){return}var i=e.proxies[t].originalEp.element,o=e.proxies[t].originalEp.elementId;e.endpoints[t]=e.proxies[t].originalEp;if(t===0){this.anchorManager.sourceChanged(n,o,e,i)}else{this.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,n,o,e);e.target=i;e.targetId=o}e.proxies[t].ep.detachFromConnection(e,null);e.proxies[t].originalEp.addConnection(e);if(e.isVisible()){e.proxies[t].originalEp.setVisible(true)}delete e.proxies[t]}});var m=new d;e.jsPlumb=m;m.getInstance=function(e,t){var n=new d(e);if(t){for(var i in t){n[i]=t[i]}}n.init();return n};m.each=function(e,t){if(e==null){return}if(typeof e==="string"){t(m.getElement(e))}else if(e.length!=null){for(var n=0;n<e.length;n++){t(m.getElement(e[n]))}}else{t(e)}};{t.jsPlumb=m}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i="__label",o=function(e,n){var o={cssClass:n.cssClass,labelStyle:e.labelStyle,id:i,component:e,_jsPlumb:e._jsPlumb.instance},s=t.extend(o,n);return new(t.Overlays[e._jsPlumb.instance.getRenderMode()].Label)(s)},s=function(e,i){var o=null;if(n.isArray(i)){var s=i[0],r=t.extend({component:e,_jsPlumb:e._jsPlumb.instance},i[1]);if(i.length===3){t.extend(r,i[2])}o=new(t.Overlays[e._jsPlumb.instance.getRenderMode()][s])(r)}else if(i.constructor===String){o=new(t.Overlays[e._jsPlumb.instance.getRenderMode()][i])({component:e,_jsPlumb:e._jsPlumb.instance})}else{o=i}o.id=o.id||n.uuid();e.cacheTypeItem("overlay",o,o.id);e._jsPlumb.overlays[o.id]=o;return o};t.OverlayCapableJsPlumbUIComponent=function(t){e.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};if(t.label){this.getDefaultType().overlays[i]=["Label",{label:t.label,location:t.labelLocation||this.defaultLabelLocation||.5,labelStyle:t.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:i}]}this.setListenerComponent=function(e){if(this._jsPlumb){for(var t in this._jsPlumb.overlays){this._jsPlumb.overlays[t].setListenerComponent(e)}}}};t.OverlayCapableJsPlumbUIComponent.applyType=function(e,t){if(t.overlays){var n={},i;for(i in t.overlays){var o=e._jsPlumb.overlays[t.overlays[i][1].id];if(o){o.updateFrom(t.overlays[i][1]);n[t.overlays[i][1].id]=true}else{var s=e.getCachedTypeItem("overlay",t.overlays[i][1].id);if(s!=null){s.reattach(e._jsPlumb.instance,e);s.setVisible(true);s.updateFrom(t.overlays[i][1]);e._jsPlumb.overlays[s.id]=s}else{s=e.addOverlay(t.overlays[i],true)}n[s.id]=true}}for(i in e._jsPlumb.overlays){if(n[e._jsPlumb.overlays[i].id]==null){e.removeOverlay(e._jsPlumb.overlays[i].id,true)}}}};n.extend(t.OverlayCapableJsPlumbUIComponent,e.jsPlumbUIComponent,{setHover:function(e,t){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var n in this._jsPlumb.overlays){this._jsPlumb.overlays[n][e?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(e,t){var n=s(this,e);if(!t){this.repaint()}return n},getOverlay:function(e){return this._jsPlumb.overlays[e]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(e){var t=this.getOverlay(e);if(t){t.hide()}},hideOverlays:function(){for(var e in this._jsPlumb.overlays){this._jsPlumb.overlays[e].hide()}},showOverlay:function(e){var t=this.getOverlay(e);if(t){t.show()}},showOverlays:function(){for(var e in this._jsPlumb.overlays){this._jsPlumb.overlays[e].show()}},removeAllOverlays:function(e){for(var t in this._jsPlumb.overlays){if(this._jsPlumb.overlays[t].cleanup){this._jsPlumb.overlays[t].cleanup()}}this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;this._jsPlumb.overlayPlacements={};if(!e){this.repaint()}},removeOverlay:function(e,t){var n=this._jsPlumb.overlays[e];if(n){n.setVisible(false);if(!t&&n.cleanup){n.cleanup()}delete this._jsPlumb.overlays[e];if(this._jsPlumb.overlayPositions){delete this._jsPlumb.overlayPositions[e]}if(this._jsPlumb.overlayPlacements){delete this._jsPlumb.overlayPlacements[e]}}},removeOverlays:function(){for(var e=0,t=arguments.length;e<t;e++){this.removeOverlay(arguments[e])}},moveParent:function(e){if(this.bgCanvas){this.bgCanvas.parentNode.removeChild(this.bgCanvas);e.appendChild(this.bgCanvas)}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);e.appendChild(this.canvas);for(var t in this._jsPlumb.overlays){if(this._jsPlumb.overlays[t].isAppendedAtTopLevel){var n=this._jsPlumb.overlays[t].getElement();n.parentNode.removeChild(n);e.appendChild(n)}}}},getLabel:function(){var e=this.getOverlay(i);return e!=null?e.getLabel():null},getLabelOverlay:function(){return this.getOverlay(i)},setLabel:function(e){var t=this.getOverlay(i);if(!t){var n=e.constructor===String||e.constructor===Function?{label:e}:e;t=o(this,n);this._jsPlumb.overlays[i]=t}else{if(e.constructor===String||e.constructor===Function){t.setLabel(e)}else{if(e.label){t.setLabel(e.label)}if(e.location){t.setLocation(e.location)}}}if(!this._jsPlumb.instance.isSuspendDrawing()){this.repaint()}},cleanup:function(e){for(var t in this._jsPlumb.overlays){this._jsPlumb.overlays[t].cleanup(e);this._jsPlumb.overlays[t].destroy(e)}if(e){this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null}},setVisible:function(e){this[e?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(e,t){this._jsPlumb.overlayPositions[e.id]=t},getAbsoluteOverlayPosition:function(e){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[e.id]:null},_clazzManip:function(e,t,n){if(!n){for(var i in this._jsPlumb.overlays){this._jsPlumb.overlays[i][e+"Class"](t)}}},addClass:function(e,t){this._clazzManip("add",e,t)},removeClass:function(e,t){this._clazzManip("remove",e,t)}})}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i=function(e,t,n){var i=false;return{drag:function(){if(i){i=false;return true}if(t.element){var o=n.getUIPosition(arguments,n.getZoom());if(o!=null){n.setPosition(t.element,o)}n.repaint(t.element,o);e.paint({anchorPoint:e.anchor.getCurrentLocation({element:e})})}},stopDrag:function(){i=true}}};var o=function(e,t,n,i){var o=t.createElement("div",{position:"absolute"});t.appendElement(o);var s=t.getId(o);t.setPosition(o,n);o.style.width=i[0]+"px";o.style.height=i[1]+"px";t.manage(s,o,true);e.id=s;e.element=o};var s=function(e,n,i,o,s,r,a,l){var c=new t.FloatingAnchor({reference:n,referenceCanvas:o,jsPlumbInstance:r});return a({paintStyle:e,endpoint:i,anchor:c,source:s,scope:l})};var r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];var a=function(e,t){var n=0;if(t!=null){for(var i=0;i<e.connections.length;i++){if(e.connections[i].sourceId===t||e.connections[i].targetId===t){n=i;break}}}return e.connections[n]};t.Endpoint=function(e){var l=e._jsPlumb,c=e.newConnection,u=e.newEndpoint;this.idPrefix="_jsplumb_e_";this.defaultLabelLocation=[.5,.5];this.defaultOverlayKeys=["Overlays","EndpointOverlays"];t.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.appendToDefaultType({connectionType:e.connectionType,maxConnections:e.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:e.maxConnections,paintStyle:e.endpointStyle||e.paintStyle||e.style||this._jsPlumb.instance.Defaults.EndpointStyle||t.Defaults.EndpointStyle,hoverPaintStyle:e.endpointHoverStyle||e.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||t.Defaults.EndpointHoverStyle,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector,connectorTooltip:e.connectorTooltip});this._jsPlumb.enabled=!(e.enabled===false);this._jsPlumb.visible=true;this.element=t.getElement(e.source);this._jsPlumb.uuid=e.uuid;this._jsPlumb.floatingEndpoint=null;if(this._jsPlumb.uuid){e.endpointsByUUID[this._jsPlumb.uuid]=this}this.elementId=e.elementId;this.dragProxy=e.dragProxy;this._jsPlumb.connectionCost=e.connectionCost;this._jsPlumb.connectionsDirected=e.connectionsDirected;this._jsPlumb.currentAnchorClass="";this._jsPlumb.events={};var h=e.deleteOnEmpty===true;this.setDeleteOnEmpty=function(e){h=e};var p=function(){var e=l.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var n=l.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(e);this.addClass(n);t.updateClasses(this.element,n,e)}.bind(this);this.prepareAnchor=function(e){var t=this._jsPlumb.instance.makeAnchor(e,this.elementId,l);t.bind("anchorChanged",function(e){this.fire("anchorChanged",{endpoint:this,anchor:e});p()}.bind(this));return t};this.setPreparedAnchor=function(e,t){this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);this.anchor=e;p();if(!t){this._jsPlumb.instance.repaint(this.elementId)}return this};this.setAnchor=function(e,t){var n=this.prepareAnchor(e);this.setPreparedAnchor(n,t);return this};var f=function(e){if(this.connections.length>0){for(var t=0;t<this.connections.length;t++){this.connections[t].setHover(e,false)}}else{this.setHover(e)}}.bind(this);this.bind("mouseover",function(){f(true)});this.bind("mouseout",function(){f(false)});if(!e._transient){this._jsPlumb.instance.anchorManager.add(this,this.elementId)}this.prepareEndpoint=function(i,o){var s=function(e,n){var i=l.getRenderMode();if(t.Endpoints[i][e]){return new t.Endpoints[i][e](n)}if(!l.Defaults.DoNotThrowErrors){throw{msg:"jsPlumb: unknown endpoint type '"+e+"'"}}};var r={_jsPlumb:this._jsPlumb.instance,cssClass:e.cssClass,container:e.container,tooltip:e.tooltip,connectorTooltip:e.connectorTooltip,endpoint:this};var a;if(n.isString(i)){a=s(i,r)}else if(n.isArray(i)){r=n.merge(i[1],r);a=s(i[0],r)}else{a=i.clone()}a.clone=function(){if(n.isString(i)){return s(i,r)}else if(n.isArray(i)){r=n.merge(i[1],r);return s(i[0],r)}}.bind(this);a.typeId=o;return a};this.setEndpoint=function(e,t){var n=this.prepareEndpoint(e);this.setPreparedEndpoint(n,true)};this.setPreparedEndpoint=function(e,t){if(this.endpoint!=null){this.endpoint.cleanup();this.endpoint.destroy()}this.endpoint=e;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas};t.extend(this,e,r);this.isSource=e.isSource||false;this.isTemporarySource=e.isTemporarySource||false;this.isTarget=e.isTarget||false;this.connections=e.connections||[];this.connectorPointerEvents=e["connector-pointer-events"];this.scope=e.scope||l.getDefaultScope();this.timestamp=null;this.reattachConnections=e.reattach||l.Defaults.ReattachConnections;this.connectionsDetachable=l.Defaults.ConnectionsDetachable;if(e.connectionsDetachable===false||e.detachable===false){this.connectionsDetachable=false}this.dragAllowedWhenFull=e.dragAllowedWhenFull!==false;if(e.onMaxConnections){this.bind("maxConnections",e.onMaxConnections)}this.addConnection=function(e){this.connections.push(e);this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)};this.detachFromConnection=function(e,t,n){t=t==null?this.connections.indexOf(e):t;if(t>=0){this.connections.splice(t,1);this[(this.connections.length>0?"add":"remove")+"Class"](l.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](l.endpointFullClass)}if(!n&&h&&this.connections.length===0){l.deleteObject({endpoint:this,fireEvent:false,deleteAttachedObjects:n!==true})}};this.deleteEveryConnection=function(e){var t=this.connections.length;for(var n=0;n<t;n++){l.deleteConnection(this.connections[0],e)}};this.detachFrom=function(e,t,n){var i=[];for(var o=0;o<this.connections.length;o++){if(this.connections[o].endpoints[1]===e||this.connections[o].endpoints[0]===e){i.push(this.connections[o])}}for(var s=0,r=i.length;s<r;s++){l.deleteConnection(i[0])}return this};this.getElement=function(){return this.element};this.setElement=function(i){var o=this._jsPlumb.instance.getId(i),s=this.elementId;n.removeWithFunction(e.endpointsByElement[this.elementId],function(e){return e.id===this.id}.bind(this));this.element=t.getElement(i);this.elementId=l.getId(this.element);l.anchorManager.rehomeEndpoint(this,s,this.element);l.dragManager.endpointAdded(this.element);n.addToList(e.endpointsByElement,o,this);return this};this.makeInPlaceCopy=function(){var t=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),o={bind:function(){},compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return n},getCssClass:function(){return i}};return u({dropOptions:e.dropOptions,anchor:o,source:this.element,paintStyle:this.getPaintStyle(),endpoint:e.hideOnDrag?"Blank":this.endpoint,_transient:true,scope:this.scope,reference:this})};this.connectorSelector=function(){return this.connections[0]};this.setStyle=this.setPaintStyle;this.paint=function(e){e=e||{};var t=e.timestamp,n=!(e.recalc===false);if(!t||this.timestamp!==t){var i=l.updateOffset({elId:this.elementId,timestamp:t});var o=e.offset?e.offset.o:i.o;if(o!=null){var s=e.anchorPoint,r=e.connectorPaintStyle;if(s==null){var c=e.dimensions||i.s,u={xy:[o.left,o.top],wh:c,element:this,timestamp:t};if(n&&this.anchor.isDynamic&&this.connections.length>0){var h=a(this,e.elementWithPrecedence),p=h.endpoints[0]===this?1:0,f=p===0?h.sourceId:h.targetId,d=l.getCachedData(f),m=d.o,v=d.s;u.index=p===0?1:0;u.connection=h;u.txy=[m.left,m.top];u.twh=v;u.tElement=h.endpoints[p]}else if(this.connections.length>0){u.connection=this.connections[0]}s=this.anchor.compute(u)}this.endpoint.compute(s,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,r||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=t;for(var y in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(y)){var g=this._jsPlumb.overlays[y];if(g.isVisible()){this._jsPlumb.overlayPlacements[y]=g.draw(this.endpoint,this._jsPlumb.paintStyleInUse);g.paint(this._jsPlumb.overlayPlacements[y])}}}}}};this.getTypeDescriptor=function(){return"endpoint"};this.isVisible=function(){return this._jsPlumb.visible};this.repaint=this.paint;var d=false;this.initDraggable=function(){if(!d&&t.isDragSupported(this.element)){var r={id:null,element:null},a=null,h=false,p=null,f=i(this,r,l),m=e.dragOptions||{},v={},y=t.dragEvents.start,g=t.dragEvents.stop,b=t.dragEvents.drag,x=t.dragEvents.beforeStart,P;var j=function(e){P=e.e.payload||{}};var C=function(n){a=this.connectorSelector();var i=true;if(!this.isEnabled()){i=false}if(a==null&&!this.isSource&&!this.isTemporarySource){i=false}if(this.isSource&&this.isFull()&&!(a!=null&&this.dragAllowedWhenFull)){i=false}if(a!=null&&!a.isDetachable(this)){if(this.isFull()){i=false}else{a=null}}var d=l.checkCondition(a==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:a});if(d===false){i=false}else if(typeof d==="object"){t.extend(d,P||{})}else{d=P||{}}if(i===false){if(l.stopDrag){l.stopDrag(this.canvas)}f.stopDrag();return false}for(var m=0;m<this.connections.length;m++){this.connections[m].setHover(false)}this.addClass("endpointDrag");l.setConnectionBeingDragged(true);if(a&&!this.isFull()&&this.isSource){a=null}l.updateOffset({elId:this.elementId});var v=this._jsPlumb.instance.getOffset(this.canvas),y=this.canvas,g=this._jsPlumb.instance.getSize(this.canvas);o(r,l,v,g);l.setAttributes(this.canvas,{dragId:r.id,elId:this.elementId});var b=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var x=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);if(x.endpoints[1]){b=x.endpoints[1]}}var j=this._jsPlumb.instance.makeAnchor("Center");j.isFloating=true;this._jsPlumb.floatingEndpoint=s(this.getPaintStyle(),j,b,this.canvas,r.element,l,u,this.scope);var C=this._jsPlumb.floatingEndpoint.anchor;if(a==null){this.setHover(false,false);a=c({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:r.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:e.connectorStyle,hoverPaintStyle:e.connectorHoverStyle,connector:e.connector,overlays:e.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:e.scope,data:d});a.pending=true;a.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.anchor=C;l.fire("connectionDrag",a);l.anchorManager.newConnection(a)}else{h=true;a.setHover(false);var E=a.endpoints[0].id===this.id?0:1;this.detachFromConnection(a,null,true);var _=l.getDragScope(y);l.setAttribute(this.canvas,"originalScope",_);l.fire("connectionDrag",a);if(E===0){p=[a.source,a.sourceId,y,_];l.anchorManager.sourceChanged(a.endpoints[E].elementId,r.id,a,r.element)}else{p=[a.target,a.targetId,y,_];a.target=r.element;a.targetId=r.id;l.anchorManager.updateOtherEndpoint(a.sourceId,a.endpoints[E].elementId,a.targetId,a)}a.suspendedEndpoint=a.endpoints[E];a.suspendedElement=a.endpoints[E].getElement();a.suspendedElementId=a.endpoints[E].elementId;a.suspendedElementType=E===0?"source":"target";a.suspendedEndpoint.setHover(false);this._jsPlumb.floatingEndpoint.referenceEndpoint=a.suspendedEndpoint;a.endpoints[E]=this._jsPlumb.floatingEndpoint;a.addClass(l.draggingClass);this._jsPlumb.floatingEndpoint.addClass(l.draggingClass)}l.registerFloatingConnection(r,a,this._jsPlumb.floatingEndpoint);l.currentlyDragging=true}.bind(this);var E=function(){l.setConnectionBeingDragged(false);if(a&&a.endpoints!=null){var e=l.getDropEvent(arguments);var t=l.getFloatingAnchorIndex(a);a.endpoints[t===0?1:0].anchor.unlock();a.removeClass(l.draggingClass);if(this._jsPlumb&&(a.deleteConnectionNow||a.endpoints[t]===this._jsPlumb.floatingEndpoint)){if(h&&a.suspendedEndpoint){if(t===0){a.floatingElement=a.source;a.floatingId=a.sourceId;a.floatingEndpoint=a.endpoints[0];a.floatingIndex=0;a.source=p[0];a.sourceId=p[1]}else{a.floatingElement=a.target;a.floatingId=a.targetId;a.floatingEndpoint=a.endpoints[1];a.floatingIndex=1;a.target=p[0];a.targetId=p[1]}var n=this._jsPlumb.floatingEndpoint;l.setDragScope(p[2],p[3]);a.endpoints[t]=a.suspendedEndpoint;if(a.isReattach()||a._forceReattach||a._forceDetach||!l.deleteConnection(a,{originalEvent:e})){a.setHover(false);a._forceDetach=null;a._forceReattach=null;this._jsPlumb.floatingEndpoint.detachFromConnection(a);a.suspendedEndpoint.addConnection(a);if(t===1){l.anchorManager.updateOtherEndpoint(a.sourceId,a.floatingId,a.targetId,a)}else{l.anchorManager.sourceChanged(a.floatingId,a.sourceId,a,a.source)}l.repaint(p[1])}else{l.deleteObject({endpoint:n})}}}if(this.deleteAfterDragStop){l.deleteObject({endpoint:this})}else{if(this._jsPlumb){this.paint({recalc:false})}}l.fire("connectionDragStop",a,e);if(a.pending){l.fire("connectionAborted",a,e)}l.currentlyDragging=false;a.suspendedElement=null;a.suspendedEndpoint=null;a=null}if(r&&r.element){l.remove(r.element,false,false)}if(this._jsPlumb){this.canvas.style.visibility="visible";this.anchor.unlock();this._jsPlumb.floatingEndpoint=null}}.bind(this);m=t.extend(v,m);m.scope=this.scope||m.scope;m[x]=n.wrap(m[x],j,false);m[y]=n.wrap(m[y],C,false);m[b]=n.wrap(m[b],f.drag);m[g]=n.wrap(m[g],E);m.multipleDrop=false;m.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0&&this.connectionsDetachable!==false}.bind(this);l.initDraggable(this.canvas,m,"internal");this.canvas._jsPlumbRelatedElement=this.element;d=true}};var m=e.endpoint||this._jsPlumb.instance.Defaults.Endpoint||t.Defaults.Endpoint;this.setEndpoint(m,true);var v=e.anchor?e.anchor:e.anchors?e.anchors:l.Defaults.Anchor||"Top";this.setAnchor(v,true);var y=["default",e.type||""].join(" ");this.addType(y,e.data,true);this.canvas=this.endpoint.canvas;this.canvas._jsPlumb=this;this.initDraggable();var g=function(i,o,s,r){if(t.isDropSupported(this.element)){var a=e.dropOptions||l.Defaults.DropOptions||t.Defaults.DropOptions;a=t.extend({},a);a.scope=a.scope||this.scope;var c=t.dragEvents.drop,u=t.dragEvents.over,h=t.dragEvents.out,p=this,f=l.EndpointDropHandler({getEndpoint:function(){return p},jsPlumb:l,enabled:function(){return s!=null?s.isEnabled():true},isFull:function(){return s.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(e){p.addClass(e)},removeClass:function(e){p.removeClass(e)},isDropAllowed:function(){return p.isDropAllowed.apply(p,arguments)},reference:r,isRedrop:function(e,t){return e.suspendedEndpoint&&t.reference&&e.suspendedEndpoint.id===t.reference.id}});a[c]=n.wrap(a[c],f,true);a[u]=n.wrap(a[u],function(){var e=t.getDragObject(arguments),n=l.getAttribute(t.getElement(e),"dragId"),i=l.getFloatingConnectionFor(n);if(i!=null){var o=l.getFloatingAnchorIndex(i);var s=this.isTarget&&o!==0||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===i.suspendedEndpoint.id;if(s){var r=l.checkCondition("checkDropAllowed",{sourceEndpoint:i.endpoints[o],targetEndpoint:this,connection:i});this[(r?"add":"remove")+"Class"](l.endpointDropAllowedClass);this[(r?"remove":"add")+"Class"](l.endpointDropForbiddenClass);i.endpoints[o].anchor.over(this.anchor,this)}}}.bind(this));a[h]=n.wrap(a[h],function(){var e=t.getDragObject(arguments),n=e==null?null:l.getAttribute(t.getElement(e),"dragId"),i=n?l.getFloatingConnectionFor(n):null;if(i!=null){var o=l.getFloatingAnchorIndex(i);var s=this.isTarget&&o!==0||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===i.suspendedEndpoint.id;if(s){this.removeClass(l.endpointDropAllowedClass);this.removeClass(l.endpointDropForbiddenClass);i.endpoints[o].anchor.out()}}}.bind(this));l.initDroppable(i,a,"internal",o)}}.bind(this);if(!this.anchor.isFloating){g(this.canvas,!(e._transient||this.anchor.isFloating),this,e.reference)}return this};n.extend(t.Endpoint,t.OverlayCapableJsPlumbUIComponent,{setVisible:function(e,t,n){this._jsPlumb.visible=e;if(this.canvas){this.canvas.style.display=e?"block":"none"}this[e?"showOverlays":"hideOverlays"]();if(!t){for(var i=0;i<this.connections.length;i++){this.connections[i].setVisible(e);if(!n){var o=this===this.connections[i].endpoints[0]?1:0;if(this.connections[i].endpoints[o].connections.length===1){this.connections[i].endpoints[o].setVisible(e,true,true)}}}}},getAttachedElements:function(){return this.connections},applyType:function(e,n){this.setPaintStyle(e.endpointStyle||e.paintStyle,n);this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle,n);if(e.maxConnections!=null){this._jsPlumb.maxConnections=e.maxConnections}if(e.scope){this.scope=e.scope}t.extend(this,e,r);if(e.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,e.cssClass)}t.OverlayCapableJsPlumbUIComponent.applyType(this,e)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(e){this._jsPlumb.enabled=e},cleanup:function(){var e=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");t.removeClass(this.element,e);this.anchor=null;this.endpoint.cleanup(true);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(e){if(this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.endpoint.setHover(e)}},isFull:function(){return this._jsPlumb.maxConnections===0?true:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(e){var t=false;if(e){for(var n=0;n<this.connections.length;n++){if(this.connections[n].endpoints[1]===e||this.connections[n].endpoints[0]===e){t=true;break}}}return t},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(e){this._jsPlumb.connectionCost=e},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(e){this._jsPlumb.connectionsDirected=e},setElementId:function(e){this.elementId=e;this.anchor.elementId=e},setReferenceElement:function(e){this.element=t.getElement(e)},setDragAllowedWhenFull:function(e){this.dragAllowedWhenFull=e},equals:function(e){return this.anchor.equals(e.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(e){return this.anchor.compute(e)}});e.jsPlumbInstance.prototype.EndpointDropHandler=function(e){return function(t){var i=e.jsPlumb;e.removeClass(i.endpointDropAllowedClass);e.removeClass(i.endpointDropForbiddenClass);var o=i.getDropEvent(arguments),s=i.getDragObject(arguments),r=i.getAttribute(s,"dragId"),a=i.getAttribute(s,"elId"),l=i.getAttribute(s,"originalScope"),c=i.getFloatingConnectionFor(r);if(c==null){return}var u=c.suspendedEndpoint!=null;if(u&&c.suspendedEndpoint._jsPlumb==null){return}var h=e.getEndpoint(c);if(h==null){return}if(e.isRedrop(c,e)){c._forceReattach=true;c.setHover(false);if(e.maybeCleanup){e.maybeCleanup(h)}return}var p=i.getFloatingAnchorIndex(c);if(p===0&&!e.isSource||p===1&&!e.isTarget){if(e.maybeCleanup){e.maybeCleanup(h)}return}if(e.onDrop){e.onDrop(c)}if(l){i.setDragScope(s,l)}var f=e.isFull(t);if(f){h.fire("maxConnections",{endpoint:this,connection:c,maxConnections:h._jsPlumb.maxConnections},o)}if(!f&&e.enabled()){var d=true;if(p===0){c.floatingElement=c.source;c.floatingId=c.sourceId;c.floatingEndpoint=c.endpoints[0];c.floatingIndex=0;c.source=e.element;c.sourceId=e.elementId}else{c.floatingElement=c.target;c.floatingId=c.targetId;c.floatingEndpoint=c.endpoints[1];c.floatingIndex=1;c.target=e.element;c.targetId=e.elementId}if(u&&c.suspendedEndpoint.id!==h.id){if(!c.isDetachAllowed(c)||!c.endpoints[p].isDetachAllowed(c)||!c.suspendedEndpoint.isDetachAllowed(c)||!i.checkCondition("beforeDetach",c)){d=false}}var m=function(t){c.endpoints[p].detachFromConnection(c);if(c.suspendedEndpoint){c.suspendedEndpoint.detachFromConnection(c)}c.endpoints[p]=h;h.addConnection(c);var s=h.getParameters();for(var r in s){c.setParameter(r,s[r])}if(!u){if(s.draggable){i.initDraggable(this.element,e.dragOptions,"internal",i)}}else{var a=c.suspendedEndpoint.elementId;i.fireMoveEvent({index:p,originalSourceId:p===0?a:c.sourceId,newSourceId:p===0?h.elementId:c.sourceId,originalTargetId:p===1?a:c.targetId,newTargetId:p===1?h.elementId:c.targetId,originalSourceEndpoint:p===0?c.suspendedEndpoint:c.endpoints[0],newSourceEndpoint:p===0?h:c.endpoints[0],originalTargetEndpoint:p===1?c.suspendedEndpoint:c.endpoints[1],newTargetEndpoint:p===1?h:c.endpoints[1],connection:c},o)}if(p===1){i.anchorManager.updateOtherEndpoint(c.sourceId,c.floatingId,c.targetId,c)}else{i.anchorManager.sourceChanged(c.floatingId,c.sourceId,c,c.source)}if(c.endpoints[0].finalEndpoint){var l=c.endpoints[0];l.detachFromConnection(c);c.endpoints[0]=c.endpoints[0].finalEndpoint;c.endpoints[0].addConnection(c)}if(n.isObject(t)){c.mergeData(t)}i.finaliseConnection(c,null,o,false);c.setHover(false);i.revalidate(c.endpoints[0].element)}.bind(this);var v=function(){if(c.suspendedEndpoint){c.endpoints[p]=c.suspendedEndpoint;c.setHover(false);c._forceDetach=true;if(p===0){c.source=c.suspendedEndpoint.element;c.sourceId=c.suspendedEndpoint.elementId}else{c.target=c.suspendedEndpoint.element;c.targetId=c.suspendedEndpoint.elementId}c.suspendedEndpoint.addConnection(c);if(p===1){i.anchorManager.updateOtherEndpoint(c.sourceId,c.floatingId,c.targetId,c)}else{i.anchorManager.sourceChanged(c.floatingId,c.sourceId,c,c.source)}i.repaint(c.sourceId);c._forceDetach=false}};d=d&&e.isDropAllowed(c.sourceId,c.targetId,c.scope,c,h);if(d){m(d);return true}else{v()}}if(e.maybeCleanup){e.maybeCleanup(h)}i.currentlyDragging=false}}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i=function(e,i,o,s,r){t.Connectors[i]=t.Connectors[i]||{};if(t.Connectors[i][o]==null){if(t.Connectors[o]==null){if(!e.Defaults.DoNotThrowErrors){throw new TypeError("jsPlumb: unknown connector type '"+o+"'")}else{return null}}t.Connectors[i][o]=function(){t.Connectors[o].apply(this,arguments);t.ConnectorRenderers[i].apply(this,arguments)};n.extend(t.Connectors[i][o],[t.Connectors[o],t.ConnectorRenderers[i]])}return new t.Connectors[i][o](s,r)},o=function(e,t,n){return e?n.makeAnchor(e,t,n):null},s=function(e,t,i,o){if(t!=null){t._jsPlumbConnections=t._jsPlumbConnections||{};if(o){delete t._jsPlumbConnections[e.id]}else{t._jsPlumbConnections[e.id]=true}if(n.isEmpty(t._jsPlumbConnections)){i.removeClass(t,i.connectedClass)}else{i.addClass(t,i.connectedClass)}}};t.Connection=function(e){var i=e.newEndpoint;this.id=e.id;this.connector=null;this.idPrefix="_jsplumb_c_";this.defaultLabelLocation=.5;this.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.previousConnection=e.previousConnection;this.source=t.getElement(e.source);this.target=t.getElement(e.target);t.OverlayCapableJsPlumbUIComponent.apply(this,arguments);if(e.sourceEndpoint){this.source=e.sourceEndpoint.getElement();this.sourceId=e.sourceEndpoint.elementId}else{this.sourceId=this._jsPlumb.instance.getId(this.source)}if(e.targetEndpoint){this.target=e.targetEndpoint.getElement();this.targetId=e.targetEndpoint.elementId}else{this.targetId=this._jsPlumb.instance.getId(this.target)}this.scope=e.scope;this.endpoints=[];this.endpointStyles=[];var o=this._jsPlumb.instance;o.manage(this.sourceId,this.source);o.manage(this.targetId,this.target);this._jsPlumb.visible=true;this._jsPlumb.params={cssClass:e.cssClass,container:e.container,"pointer-events":e["pointer-events"],editorParams:e.editorParams,overlays:e.overlays};this._jsPlumb.lastPaintedAt=null;this.bind("mouseover",function(){this.setHover(true)}.bind(this));this.bind("mouseout",function(){this.setHover(false)}.bind(this));this.makeEndpoint=function(t,n,s,r){s=s||this._jsPlumb.instance.getId(n);return this.prepareEndpoint(o,i,this,r,t?0:1,e,n,s)};if(e.type){e.endpoints=e.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(e.type).endpoints}var s=this.makeEndpoint(true,this.source,this.sourceId,e.sourceEndpoint),r=this.makeEndpoint(false,this.target,this.targetId,e.targetEndpoint);if(s){n.addToList(e.endpointsByElement,this.sourceId,s)}if(r){n.addToList(e.endpointsByElement,this.targetId,r)}if(!this.scope){this.scope=this.endpoints[0].scope}if(e.deleteEndpointsOnEmpty!=null){this.endpoints[0].setDeleteOnEmpty(e.deleteEndpointsOnEmpty);this.endpoints[1].setDeleteOnEmpty(e.deleteEndpointsOnEmpty)}var a=o.Defaults.ConnectionsDetachable;if(e.detachable===false){a=false}if(this.endpoints[0].connectionsDetachable===false){a=false}if(this.endpoints[1].connectionsDetachable===false){a=false}var l=e.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||o.Defaults.ReattachConnections;this.appendToDefaultType({detachable:a,reattach:l,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||e.paintStyle||o.Defaults.PaintStyle||t.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||e.hoverPaintStyle||o.Defaults.HoverPaintStyle||t.Defaults.HoverPaintStyle});var c=o.getSuspendedAt();if(!o.isSuspendDrawing()){var u=o.getCachedData(this.sourceId),h=u.o,p=u.s,f=o.getCachedData(this.targetId),d=f.o,m=f.s,v=c||o.timestamp(),y=this.endpoints[0].anchor.compute({xy:[h.left,h.top],wh:p,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[d.left,d.top],twh:m,tElement:this.endpoints[1],timestamp:v});this.endpoints[0].paint({anchorLoc:y,timestamp:v});y=this.endpoints[1].anchor.compute({xy:[d.left,d.top],wh:m,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[h.left,h.top],twh:p,tElement:this.endpoints[0],timestamp:v});this.endpoints[1].paint({anchorLoc:y,timestamp:v})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(e){return this._jsPlumb.detachable===false?false:e!=null?e.connectionsDetachable===true:this._jsPlumb.detachable===true};this.setDetachable=function(e){this._jsPlumb.detachable=e===true};this.isReattach=function(){return this._jsPlumb.reattach===true||this.endpoints[0].reattachConnections===true||this.endpoints[1].reattachConnections===true};this.setReattach=function(e){this._jsPlumb.reattach=e===true};this._jsPlumb.cost=e.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=e.directed;if(e.directed==null){this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected()}var g=t.extend({},this.endpoints[1].getParameters());t.extend(g,this.endpoints[0].getParameters());t.extend(g,this.getParameters());this.setParameters(g);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||e.connector||o.Defaults.Connector||t.Defaults.Connector,true);var b=e.data==null||!n.isObject(e.data)?{}:e.data;this.getData=function(){return b};this.setData=function(e){b=e||{}};this.mergeData=function(e){b=t.extend(b,e)};var x=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,e.type].join(" ");if(/[^\s]/.test(x)){this.addType(x,e.data,true)}this.updateConnectedClass()};n.extend(t.Connection,t.OverlayCapableJsPlumbUIComponent,{applyType:function(e,n,i){var o=null;if(e.connector!=null){o=this.getCachedTypeItem("connector",i.connector);if(o==null){o=this.prepareConnector(e.connector,i.connector);this.cacheTypeItem("connector",o,i.connector)}this.setPreparedConnector(o)}if(e.detachable!=null){this.setDetachable(e.detachable)}if(e.reattach!=null){this.setReattach(e.reattach)}if(e.scope){this.scope=e.scope}if(e.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,e.cssClass)}var s=null;if(e.anchor){s=this.getCachedTypeItem("anchors",i.anchor);if(s==null){s=[this._jsPlumb.instance.makeAnchor(e.anchor),this._jsPlumb.instance.makeAnchor(e.anchor)];this.cacheTypeItem("anchors",s,i.anchor)}}else if(e.anchors){s=this.getCachedTypeItem("anchors",i.anchors);if(s==null){s=[this._jsPlumb.instance.makeAnchor(e.anchors[0]),this._jsPlumb.instance.makeAnchor(e.anchors[1])];this.cacheTypeItem("anchors",s,i.anchors)}}if(s!=null){this.endpoints[0].anchor=s[0];this.endpoints[1].anchor=s[1];if(this.endpoints[1].anchor.isDynamic){this._jsPlumb.instance.repaint(this.endpoints[1].elementId)}}t.OverlayCapableJsPlumbUIComponent.applyType(this,e)},addClass:function(e,t){if(t){this.endpoints[0].addClass(e);this.endpoints[1].addClass(e);if(this.suspendedEndpoint){this.suspendedEndpoint.addClass(e)}}if(this.connector){this.connector.addClass(e)}},removeClass:function(e,t){if(t){this.endpoints[0].removeClass(e);this.endpoints[1].removeClass(e);if(this.suspendedEndpoint){this.suspendedEndpoint.removeClass(e)}}if(this.connector){this.connector.removeClass(e)}},isVisible:function(){return this._jsPlumb.visible},setVisible:function(e){this._jsPlumb.visible=e;if(this.connector){this.connector.setVisible(e)}this.repaint()},cleanup:function(){this.updateConnectedClass(true);this.endpoints=null;this.source=null;this.target=null;if(this.connector!=null){this.connector.cleanup(true);this.connector.destroy(true)}this.connector=null},updateConnectedClass:function(e){if(this._jsPlumb){s(this,this.source,this._jsPlumb.instance,e);s(this,this.target,this._jsPlumb.instance,e)}},setHover:function(t){if(this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.connector.setHover(t);e.jsPlumb[t?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass);e.jsPlumb[t?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass)}},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-Infinity},setCost:function(e){this._jsPlumb.cost=e},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(e,t){var o={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},s=this._jsPlumb.instance.getRenderMode(),r;if(n.isString(e)){r=i(this._jsPlumb.instance,s,e,o,this)}else if(n.isArray(e)){if(e.length===1){r=i(this._jsPlumb.instance,s,e[0],o,this)}else{r=i(this._jsPlumb.instance,s,e[0],n.merge(e[1],o),this)}}if(t!=null){r.typeId=t}return r},setPreparedConnector:function(e,t,n,i){if(this.connector!==e){var o,s="";if(this.connector!=null){o=this.connector;s=o.getClass();this.connector.cleanup();this.connector.destroy()}this.connector=e;if(i){this.cacheTypeItem("connector",e,i)}this.canvas=this.connector.canvas;this.bgCanvas=this.connector.bgCanvas;this.connector.reattach(this._jsPlumb.instance);this.addClass(s);if(this.canvas){this.canvas._jsPlumb=this}if(this.bgCanvas){this.bgCanvas._jsPlumb=this}if(o!=null){var r=this.getOverlays();for(var a=0;a<r.length;a++){if(r[a].transfer){r[a].transfer(this.connector)}}}if(!n){this.setListenerComponent(this.connector)}if(!t){this.repaint()}}},setConnector:function(e,t,n,i){var o=this.prepareConnector(e,i);this.setPreparedConnector(o,t,n,i)},paint:function(e){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){e=e||{};var t=e.timestamp,n=false,i=n?this.sourceId:this.targetId,o=n?this.targetId:this.sourceId,s=n?0:1,r=n?1:0;if(t==null||t!==this._jsPlumb.lastPaintedAt){var a=this._jsPlumb.instance.updateOffset({elId:o}).o,l=this._jsPlumb.instance.updateOffset({elId:i}).o,c=this.endpoints[r],u=this.endpoints[s];var h=c.anchor.getCurrentLocation({xy:[a.left,a.top],wh:[a.width,a.height],element:c,timestamp:t}),p=u.anchor.getCurrentLocation({xy:[l.left,l.top],wh:[l.width,l.height],element:u,timestamp:t});this.connector.resetBounds();this.connector.compute({sourcePos:h,targetPos:p,sourceOrientation:c.anchor.getOrientation(c),targetOrientation:u.anchor.getOrientation(u),sourceEndpoint:this.endpoints[r],targetEndpoint:this.endpoints[s],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:a,targetInfo:l});var f={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(var d in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(d)){var m=this._jsPlumb.overlays[d];if(m.isVisible()){this._jsPlumb.overlayPlacements[d]=m.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(m));f.minX=Math.min(f.minX,this._jsPlumb.overlayPlacements[d].minX);f.maxX=Math.max(f.maxX,this._jsPlumb.overlayPlacements[d].maxX);f.minY=Math.min(f.minY,this._jsPlumb.overlayPlacements[d].minY);f.maxY=Math.max(f.maxY,this._jsPlumb.overlayPlacements[d].maxY)}}}var v=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,y=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),g={xmin:Math.min(this.connector.bounds.minX-(v+y),f.minX),ymin:Math.min(this.connector.bounds.minY-(v+y),f.minY),xmax:Math.max(this.connector.bounds.maxX+(v+y),f.maxX),ymax:Math.max(this.connector.bounds.maxY+(v+y),f.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,g);for(var b in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(b)){var x=this._jsPlumb.overlays[b];if(x.isVisible()){x.paint(this._jsPlumb.overlayPlacements[b],g)}}}}this._jsPlumb.lastPaintedAt=t}},repaint:function(e){var t=jsPlumb.extend(e||{},{});t.elId=this.sourceId;this.paint(t)},prepareEndpoint:function(e,n,i,s,r,a,l,c){var u;if(s){i.endpoints[r]=s;s.addConnection(i)}else{if(!a.endpoints){a.endpoints=[null,null]}var h=a.endpoints[r]||a.endpoint||e.Defaults.Endpoints[r]||t.Defaults.Endpoints[r]||e.Defaults.Endpoint||t.Defaults.Endpoint;if(!a.endpointStyles){a.endpointStyles=[null,null]}if(!a.endpointHoverStyles){a.endpointHoverStyles=[null,null]}var p=a.endpointStyles[r]||a.endpointStyle||e.Defaults.EndpointStyles[r]||t.Defaults.EndpointStyles[r]||e.Defaults.EndpointStyle||t.Defaults.EndpointStyle;if(p.fill==null&&a.paintStyle!=null){p.fill=a.paintStyle.stroke}if(p.outlineStroke==null&&a.paintStyle!=null){p.outlineStroke=a.paintStyle.outlineStroke}if(p.outlineWidth==null&&a.paintStyle!=null){p.outlineWidth=a.paintStyle.outlineWidth}var f=a.endpointHoverStyles[r]||a.endpointHoverStyle||e.Defaults.EndpointHoverStyles[r]||t.Defaults.EndpointHoverStyles[r]||e.Defaults.EndpointHoverStyle||t.Defaults.EndpointHoverStyle;if(a.hoverPaintStyle!=null){if(f==null){f={}}if(f.fill==null){f.fill=a.hoverPaintStyle.stroke}}var d=a.anchors?a.anchors[r]:a.anchor?a.anchor:o(e.Defaults.Anchors[r],c,e)||o(t.Defaults.Anchors[r],c,e)||o(e.Defaults.Anchor,c,e)||o(t.Defaults.Anchor,c,e),m=a.uuids?a.uuids[r]:null;u=n({paintStyle:p,hoverPaintStyle:f,endpoint:h,connections:[i],uuid:m,anchor:d,source:l,scope:a.scope,reattach:a.reattach||e.Defaults.ReattachConnections,detachable:a.detachable||e.Defaults.ConnectionsDetachable});if(s==null){u.setDeleteOnEmpty(true)}i.endpoints[r]=u;if(a.drawEndpoints===false){u.setVisible(false,true,true)}}return u}})}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumbUtil,n=e.jsPlumb;n.AnchorManager=function(e){var i={},o={},s={},r={},a=this,l={},c=e.jsPlumbInstance,u={},h=function(e,t,n,i,o,s,r){var a=[],l=t[o?0:1]/(i.length+1);for(var c=0;c<i.length;c++){var u=(c+1)*l,h=s*t[o?1:0];if(r){u=t[o?0:1]-u}var p=o?u:h,f=n[0]+p,d=p/t[0],m=o?h:u,v=n[1]+m,y=m/t[1];a.push([f,v,d,y,i[c][1],i[c][2]])}return a},p=function(e){return function(t,n){var i=true;if(e){i=t[0][0]<n[0][0]}else{i=t[0][0]>n[0][0]}return i===false?-1:1}},f=function(e,t){var n=e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0],i=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];if(n>i){return 1}else{return-1}},d={top:function(e,t){return e[0]>t[0]?1:-1},right:p(true),bottom:p(true),left:f},m=function(e,t){return e.sort(t)},v=function(e,t){var n=c.getCachedData(e),i=n.s,r=n.o,a=function(t,n,i,r,a,l,c){if(r.length>0){var u=m(r,d[t]),p=t==="right"||t==="top",f=h(t,n,i,u,a,l,p);var v=function(e,t){o[e.id]=[t[0],t[1],t[2],t[3]];s[e.id]=c};for(var y=0;y<f.length;y++){var g=f[y][4],b=g.endpoints[0].elementId===e,x=g.endpoints[1].elementId===e;if(b){v(g.endpoints[0],f[y])}if(x){v(g.endpoints[1],f[y])}}}};a("bottom",i,[r.left,r.top],t.bottom,true,1,[0,1]);a("top",i,[r.left,r.top],t.top,true,0,[0,-1]);a("left",i,[r.left,r.top],t.left,false,0,[-1,0]);a("right",i,[r.left,r.top],t.right,false,1,[1,0])};this.reset=function(){i={};r={};l={}};this.addFloatingConnection=function(e,t){u[e]=t};this.removeFloatingConnection=function(e){delete u[e]};this.newConnection=function(e){var i=e.sourceId,o=e.targetId,s=e.endpoints,a=true,l=function(l,c,u,h,p){if(i===o&&u.isContinuous){e._jsPlumb.instance.removeElement(s[1].canvas);a=false}t.addToList(r,h,[p,c,u.constructor===n.DynamicAnchor])};l(0,s[0],s[0].anchor,o,e);if(a){l(1,s[1],s[1].anchor,i,e)}};var y=function(e){(function(e,n){if(e){var i=function(e){return e[4]===n};t.removeWithFunction(e.top,i);t.removeWithFunction(e.left,i);t.removeWithFunction(e.bottom,i);t.removeWithFunction(e.right,i)}})(l[e.elementId],e.id)};this.connectionDetached=function(e,n){var i=e.connection||e,o=e.sourceId,s=e.targetId,l=i.endpoints,c=function(e,n,i,o,s){t.removeWithFunction(r[o],function(e){return e[0].id===s.id})};c(1,l[1],l[1].anchor,o,i);c(0,l[0],l[0].anchor,s,i);if(i.floatingId){c(i.floatingIndex,i.floatingEndpoint,i.floatingEndpoint.anchor,i.floatingId,i);y(i.floatingEndpoint)}y(i.endpoints[0]);y(i.endpoints[1]);if(!n){a.redraw(i.sourceId);if(i.targetId!==i.sourceId){a.redraw(i.targetId)}}};this.add=function(e,n){t.addToList(i,n,e)};this.changeId=function(e,t){r[t]=r[e];i[t]=i[e];delete r[e];delete i[e]};this.getConnectionsFor=function(e){return r[e]||[]};this.getEndpointsFor=function(e){return i[e]||[]};this.deleteEndpoint=function(e){t.removeWithFunction(i[e.elementId],function(t){return t.id===e.id});y(e)};this.clearFor=function(e){delete i[e];i[e]=[]};var g=function(n,i,o,s,r,a,l,c,u,h,p,f){var d=-1,m=s.endpoints[l],v=m.id,y=[1,0][l],g=[[i,o],s,r,a,v],b=n[u],x=m._continuousAnchorEdge?n[m._continuousAnchorEdge]:null,P,j;if(x){var C=t.findWithFunction(x,function(e){return e[4]===v});if(C!==-1){x.splice(C,1);for(P=0;P<x.length;P++){j=x[P][1];t.addWithFunction(p,j,function(e){return e.id===j.id});t.addWithFunction(f,x[P][1].endpoints[l],function(e){return e.id===j.endpoints[l].id});t.addWithFunction(f,x[P][1].endpoints[y],function(e){return e.id===j.endpoints[y].id})}}}for(P=0;P<b.length;P++){j=b[P][1];if(e.idx===1&&b[P][3]===a&&d===-1){d=P}t.addWithFunction(p,j,function(e){return e.id===j.id});t.addWithFunction(f,b[P][1].endpoints[l],function(e){return e.id===j.endpoints[l].id});t.addWithFunction(f,b[P][1].endpoints[y],function(e){return e.id===j.endpoints[y].id})}{var E=c?d!==-1?d:0:b.length;b.splice(E,0,g)}m._continuousAnchorEdge=u};this.updateOtherEndpoint=function(e,i,o,s){var a=t.findWithFunction(r[e],function(e){return e[0].id===s.id}),l=t.findWithFunction(r[i],function(e){return e[0].id===s.id});if(a!==-1){r[e][a][0]=s;r[e][a][1]=s.endpoints[1];r[e][a][2]=s.endpoints[1].anchor.constructor===n.DynamicAnchor}if(l>-1){r[i].splice(l,1);t.addToList(r,o,[s,s.endpoints[0],s.endpoints[0].anchor.constructor===n.DynamicAnchor])}s.updateConnectedClass()};this.sourceChanged=function(e,i,o,s){if(e!==i){o.sourceId=i;o.source=s;t.removeWithFunction(r[e],function(e){return e[0].id===o.id});var a=t.findWithFunction(r[o.targetId],function(e){return e[0].id===o.id});if(a>-1){r[o.targetId][a][0]=o;r[o.targetId][a][1]=o.endpoints[0];r[o.targetId][a][2]=o.endpoints[0].anchor.constructor===n.DynamicAnchor}t.addToList(r,i,[o,o.endpoints[1],o.endpoints[1].anchor.constructor===n.DynamicAnchor]);if(o.endpoints[1].anchor.isContinuous){if(o.source===o.target){o._jsPlumb.instance.removeElement(o.endpoints[1].canvas)}else{if(o.endpoints[1].canvas.parentNode==null){o._jsPlumb.instance.appendElement(o.endpoints[1].canvas)}}}o.updateConnectedClass()}};this.rehomeEndpoint=function(e,t,n){var o=i[t]||[],s=c.getId(n);if(s!==t){var r=o.indexOf(e);if(r>-1){var l=o.splice(r,1)[0];a.add(l,s)}}for(var u=0;u<e.connections.length;u++){if(e.connections[u].sourceId===t){a.sourceChanged(t,e.elementId,e.connections[u],e.element)}else if(e.connections[u].targetId===t){e.connections[u].targetId=e.elementId;e.connections[u].target=e.element;a.updateOtherEndpoint(e.connections[u].sourceId,t,e.elementId,e.connections[u])}}};this.redraw=function(e,o,s,a,h,p){if(!c.isSuspendDrawing()){var f=i[e]||[],d=r[e]||[],m=[],y=[],b=[];s=s||c.timestamp();a=a||{left:0,top:0};if(o){o={left:o.left+a.left,top:o.top+a.top}}var x=c.updateOffset({elId:e,offset:o,recalc:false,timestamp:s}),P={};for(var j=0;j<d.length;j++){var C=d[j][0],E=C.sourceId,_=C.targetId,w=C.endpoints[0].anchor.isContinuous,D=C.endpoints[1].anchor.isContinuous;if(w||D){var S=E+"_"+_,T=P[S],k=C.sourceId===e?1:0;if(w&&!l[E]){l[E]={top:[],right:[],bottom:[],left:[]}}if(D&&!l[_]){l[_]={top:[],right:[],bottom:[],left:[]}}if(e!==_){c.updateOffset({elId:_,timestamp:s})}if(e!==E){c.updateOffset({elId:E,timestamp:s})}var O=c.getCachedData(_),I=c.getCachedData(E);if(_===E&&(w||D)){g(l[E],-Math.PI/2,0,C,false,_,0,false,"top",E,m,y);g(l[_],-Math.PI/2,0,C,false,E,1,false,"top",_,m,y)}else{if(!T){T=this.calculateOrientation(E,_,I.o,O.o,C.endpoints[0].anchor,C.endpoints[1].anchor,C);P[S]=T}if(w){g(l[E],T.theta,0,C,false,_,0,false,T.a[0],E,m,y)}if(D){g(l[_],T.theta2,-1,C,true,E,1,true,T.a[1],_,m,y)}}if(w){t.addWithFunction(b,E,function(e){return e===E})}if(D){t.addWithFunction(b,_,function(e){return e===_})}t.addWithFunction(m,C,function(e){return e.id===C.id});if(w&&k===0||D&&k===1){t.addWithFunction(y,C.endpoints[k],function(e){return e.id===C.endpoints[k].id})}}}for(j=0;j<f.length;j++){if(f[j].connections.length===0&&f[j].anchor.isContinuous){if(!l[e]){l[e]={top:[],right:[],bottom:[],left:[]}}g(l[e],-Math.PI/2,0,{endpoints:[f[j],f[j]],paint:function(){}},false,e,0,false,f[j].anchor.getDefaultFace(),e,m,y);t.addWithFunction(b,e,function(t){return t===e})}}for(j=0;j<b.length;j++){v(b[j],l[b[j]])}for(j=0;j<f.length;j++){f[j].paint({timestamp:s,offset:x,dimensions:x.s,recalc:p!==true})}for(j=0;j<y.length;j++){var A=c.getCachedData(y[j].elementId);y[j].paint({timestamp:null,offset:A,dimensions:A.s})}for(j=0;j<d.length;j++){var N=d[j][1];if(N.anchor.constructor===n.DynamicAnchor){N.paint({elementWithPrecedence:e,timestamp:s});t.addWithFunction(m,d[j][0],function(e){return e.id===d[j][0].id});for(var M=0;M<N.connections.length;M++){if(N.connections[M]!==d[j][0]){t.addWithFunction(m,N.connections[M],function(e){return e.id===N.connections[M].id})}}}else{t.addWithFunction(m,d[j][0],function(e){return e.id===d[j][0].id})}}var L=u[e];if(L){L.paint({timestamp:s,recalc:false,elId:e})}for(j=0;j<m.length;j++){m[j].paint({elId:e,timestamp:null,recalc:false,clearEdits:h})}}};var b=function(e){t.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=true;this.isContinuous=true;var n=e.faces||["top","right","bottom","left"],i=!(e.clockwise===false),r={},a={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},c={top:"left",right:"top",left:"bottom",bottom:"right"},u=i?l:c,h=i?c:l,p=e.cssClass||"",f=null,d=null,m=["left","right"],v=["top","bottom"],y=null;for(var g=0;g<n.length;g++){r[n[g]]=true}this.getDefaultFace=function(){return n.length===0?"top":n[0]};this.isRelocatable=function(){return true};this.isSnapOnRelocate=function(){return true};this.verifyEdge=function(e){if(r[e]){return e}else if(r[a[e]]){return a[e]}else if(r[u[e]]){return u[e]}else if(r[h[e]]){return h[e]}return e};this.isEdgeSupported=function(e){return y==null?d==null?r[e]===true:d===e:y.indexOf(e)!==-1};this.setCurrentFace=function(e,t){f=e;if(t&&d!=null){d=f}};this.getCurrentFace=function(){return f};this.getSupportedFaces=function(){var e=[];for(var t in r){if(r[t]){e.push(t)}}return e};this.lock=function(){d=f};this.unlock=function(){d=null};this.isLocked=function(){return d!=null};this.lockCurrentAxis=function(){if(f!=null){y=f==="left"||f==="right"?m:v}};this.unlockCurrentAxis=function(){y=null};this.compute=function(e){return o[e.element.id]||[0,0]};this.getCurrentLocation=function(e){return o[e.element.id]||[0,0]};this.getOrientation=function(e){return s[e.id]||[0,0]};this.getCssClass=function(){return p}};c.continuousAnchorFactory={get:function(e){return new b(e)},clear:function(e){delete o[e]}}};n.AnchorManager.prototype.calculateOrientation=function(e,t,n,i,o,s){var r={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},a=["left","top","right","bottom"];if(e===t){return{orientation:r.IDENTITY,a:["top","top"]}}var l=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),c=Math.atan2(n.centery-i.centery,n.centerx-i.centerx);var u=[],h={};(function(e,t){for(var n=0;n<e.length;n++){h[e[n]]={left:[t[n].left,t[n].centery],right:[t[n].right,t[n].centery],top:[t[n].centerx,t[n].top],bottom:[t[n].centerx,t[n].bottom]}}})(["source","target"],[n,i]);for(var p=0;p<a.length;p++){for(var f=0;f<a.length;f++){u.push({source:a[p],target:a[f],dist:Biltong.lineLength(h.source[a[p]],h.target[a[f]])})}}u.sort(function(e,t){return e.dist<t.dist?-1:e.dist>t.dist?1:0});var d=u[0].source,m=u[0].target;for(var v=0;v<u.length;v++){if(!o.isContinuous||o.isEdgeSupported(u[v].source)){d=u[v].source}else{d=null}if(!s.isContinuous||s.isEdgeSupported(u[v].target)){m=u[v].target}else{m=null}if(d!=null&&m!=null){break}}if(o.isContinuous){o.setCurrentFace(d)}if(s.isContinuous){s.setCurrentFace(m)}return{a:[d,m],theta:l,theta2:c}};n.Anchor=function(e){this.x=e.x||0;this.y=e.y||0;this.elementId=e.elementId;this.cssClass=e.cssClass||"";this.userDefinedLocation=null;this.orientation=e.orientation||[0,0];this.lastReturnValue=null;this.offsets=e.offsets||[0,0];this.timestamp=null;var n=e.relocatable!==false;this.isRelocatable=function(){return n};this.setRelocatable=function(e){n=e};var i=e.snapOnRelocate!==false;this.isSnapOnRelocate=function(){return i};var o=false;this.lock=function(){o=true};this.unlock=function(){o=false};this.isLocked=function(){return o};t.EventGenerator.apply(this);this.compute=function(e){var t=e.xy,n=e.wh,i=e.timestamp;if(e.clearUserDefinedLocation){this.userDefinedLocation=null}if(i&&i===this.timestamp){return this.lastReturnValue}if(this.userDefinedLocation!=null){this.lastReturnValue=this.userDefinedLocation}else{this.lastReturnValue=[t[0]+this.x*n[0]+this.offsets[0],t[1]+this.y*n[1]+this.offsets[1],this.x,this.y]}this.timestamp=i;return this.lastReturnValue};this.getCurrentLocation=function(e){e=e||{};return this.lastReturnValue==null||e.timestamp!=null&&this.timestamp!==e.timestamp?this.compute(e):this.lastReturnValue};this.setPosition=function(e,t,n,i,s){if(!o||s){this.x=e;this.y=t;this.orientation=[n,i];this.lastReturnValue=null}}};t.extend(n.Anchor,t.EventGenerator,{equals:function(e){if(!e){return false}var t=e.getOrientation(),n=this.getOrientation();return this.x===e.x&&this.y===e.y&&this.offsets[0]===e.offsets[0]&&this.offsets[1]===e.offsets[1]&&n[0]===t[0]&&n[1]===t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(e){this.userDefinedLocation=e},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});n.FloatingAnchor=function(e){n.Anchor.apply(this,arguments);var t=e.reference,i=e.referenceCanvas,o=n.getSize(i),s=0,r=0,a=null,l=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(e){var t=e.xy,n=[t[0]+o[0]/2,t[1]+o[1]/2];l=n;return n};this.getOrientation=function(e){if(a){return a}else{var n=t.getOrientation(e);return[Math.abs(n[0])*s*-1,Math.abs(n[1])*r*-1]}};this.over=function(e,t){a=e.getOrientation(t)};this.out=function(){a=null};this.getCurrentLocation=function(e){return l==null?this.compute(e):l}};t.extend(n.FloatingAnchor,n.Anchor);var i=function(e,t,i){return e.constructor===n.Anchor?e:t.makeAnchor(e,i,t)};n.DynamicAnchor=function(e){n.Anchor.apply(this,arguments);this.isDynamic=true;this.anchors=[];this.elementId=e.elementId;this.jsPlumbInstance=e.jsPlumbInstance;for(var t=0;t<e.anchors.length;t++){this.anchors[t]=i(e.anchors[t],this.jsPlumbInstance,this.elementId)}this.getAnchors=function(){return this.anchors};var o=this.anchors.length>0?this.anchors[0]:null,s=o,r=this,a=function(e,t,n,i,o){var s=i[0]+e.x*o[0],r=i[1]+e.y*o[1],a=i[0]+o[0]/2,l=i[1]+o[1]/2;return Math.sqrt(Math.pow(t-s,2)+Math.pow(n-r,2))+Math.sqrt(Math.pow(a-s,2)+Math.pow(l-r,2))},l=e.selector||function(e,t,n,i,o){var s=n[0]+i[0]/2,r=n[1]+i[1]/2;var l=-1,c=Infinity;for(var u=0;u<o.length;u++){var h=a(o[u],s,r,e,t);if(h<c){l=u+0;c=h}}return o[l]};this.compute=function(e){var t=e.xy,n=e.wh,i=e.txy,a=e.twh;this.timestamp=e.timestamp;var c=r.getUserDefinedLocation();if(c!=null){return c}if(this.isLocked()||i==null||a==null){return o.compute(e)}else{e.timestamp=null}o=l(t,n,i,a,this.anchors);this.x=o.x;this.y=o.y;if(o!==s){this.fire("anchorChanged",o)}s=o;return o.compute(e)};this.getCurrentLocation=function(e){return this.getUserDefinedLocation()||(o!=null?o.getCurrentLocation(e):null)};this.getOrientation=function(e){return o!=null?o.getOrientation(e):[0,0]};this.over=function(e,t){if(o!=null){o.over(e,t)}};this.out=function(){if(o!=null){o.out()}};this.setAnchor=function(e){o=e};this.getCssClass=function(){return o&&o.getCssClass()||""};this.setAnchorCoordinates=function(e){var t=jsPlumbUtil.findWithFunction(this.anchors,function(t){return t.x===e[0]&&t.y===e[1]});if(t!==-1){this.setAnchor(this.anchors[t]);return true}else{return false}}};t.extend(n.DynamicAnchor,n.Anchor);var o=function(e,t,i,o,s,r){n.Anchors[s]=function(n){var a=n.jsPlumbInstance.makeAnchor([e,t,i,o,0,0],n.elementId,n.jsPlumbInstance);a.type=s;if(r){r(a,n)}return a}};o(.5,0,0,-1,"TopCenter");o(.5,1,0,1,"BottomCenter");o(0,.5,-1,0,"LeftMiddle");o(1,.5,1,0,"RightMiddle");o(.5,0,0,-1,"Top");o(.5,1,0,1,"Bottom");o(0,.5,-1,0,"Left");o(1,.5,1,0,"Right");o(.5,.5,0,0,"Center");o(1,0,0,-1,"TopRight");o(1,1,0,1,"BottomRight");o(0,0,0,-1,"TopLeft");o(0,1,0,1,"BottomLeft");n.Defaults.DynamicAnchors=function(e){return e.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],e.elementId,e.jsPlumbInstance)};n.Anchors.AutoDefault=function(e){var t=e.jsPlumbInstance.makeDynamicAnchor(n.Defaults.DynamicAnchors(e));t.type="AutoDefault";return t};var s=function(e,t){n.Anchors[e]=function(n){var i=n.jsPlumbInstance.makeAnchor(["Continuous",{faces:t}],n.elementId,n.jsPlumbInstance);i.type=e;return i}};n.Anchors.Continuous=function(e){return e.jsPlumbInstance.continuousAnchorFactory.get(e)};s("ContinuousLeft",["left"]);s("ContinuousTop",["top"]);s("ContinuousBottom",["bottom"]);s("ContinuousRight",["right"]);o(0,0,0,0,"Assign",function(e,t){var n=t.position||"Fixed";e.positionFinder=n.constructor===String?t.jsPlumbInstance.AnchorPositionFinders[n]:n;e.constructorParams=t});e.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(e,t,n){return[(e.left-t.left)/n[0],(e.top-t.top)/n[1]]},Grid:function(e,t,n,i){var o=e.left-t.left,s=e.top-t.top,r=n[0]/i.grid[0],a=n[1]/i.grid[1],l=Math.floor(o/r),c=Math.floor(s/a);return[(l*r+r/2)/n[0],(c*a+a/2)/n[1]]}};n.Anchors.Perimeter=function(e){e=e||{};var t=e.anchorCount||60,n=e.shape;if(!n){throw new Error("no shape supplied to Perimeter Anchor type")}var i=function(){var e=.5,n=Math.PI*2/t,i=0,o=[];for(var s=0;s<t;s++){var r=e+e*Math.sin(i),a=e+e*Math.cos(i);o.push([r,a,0,0]);i+=n}return o},o=function(e){var n=t/e.length,i=[],o=function(e,o,s,r,a,l,c){n=t*a;var u=(s-e)/n,h=(r-o)/n;for(var p=0;p<n;p++){i.push([e+u*p,o+h*p,l==null?0:l,c==null?0:c])}};for(var s=0;s<e.length;s++){o.apply(null,e[s])}return i},s=function(e){var t=[];for(var n=0;n<e.length;n++){t.push([e[n][0],e[n][1],e[n][2],e[n][3],1/e.length,e[n][4],e[n][5]])}return o(t)},r=function(){return s([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]])};var a={Circle:i,Ellipse:i,Diamond:function(){return s([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:r,Square:r,Triangle:function(){return s([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(e){var t=e.points,n=[],i=0;for(var s=0;s<t.length-1;s++){var r=Math.sqrt(Math.pow(t[s][2]-t[s][0])+Math.pow(t[s][3]-t[s][1]));i+=r;n.push([t[s][0],t[s][1],t[s+1][0],t[s+1][1],r])}for(var a=0;a<n.length;a++){n[a][4]=n[a][4]/i}return o(n)}},l=function(e,t){var n=[],i=t/180*Math.PI;for(var o=0;o<e.length;o++){var s=e[o][0]-.5,r=e[o][1]-.5;n.push([.5+(s*Math.cos(i)-r*Math.sin(i)),.5+(s*Math.sin(i)+r*Math.cos(i)),e[o][2],e[o][3]])}return n};if(!a[n]){throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type")}var c=a[n](e);if(e.rotation){c=l(c,e.rotation)}var u=e.jsPlumbInstance.makeDynamicAnchor(c);u.type="Perimeter";return u}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil,i=e.Biltong;t.Segments={AbstractSegment:function(e){this.params=e;this.findClosestPointOnPath=function(e,t){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(e.x1,e.x2),minY:Math.min(e.y1,e.y2),maxX:Math.max(e.x1,e.x2),maxY:Math.max(e.y1,e.y2)}};this.lineIntersection=function(e,t,n,i){return[]};this.boxIntersection=function(e,t,n,i){var o=[];o.push.apply(o,this.lineIntersection(e,t,e+n,t));o.push.apply(o,this.lineIntersection(e+n,t,e+n,t+i));o.push.apply(o,this.lineIntersection(e+n,t+i,e,t+i));o.push.apply(o,this.lineIntersection(e,t+i,e,t));return o};this.boundingBoxIntersection=function(e){return this.boxIntersection(e.x,e.y,e.w,e.y)}},Straight:function(e){var n=t.Segments.AbstractSegment.apply(this,arguments),o,s,r,a,l,c,u,h=function(){o=Math.sqrt(Math.pow(l-a,2)+Math.pow(u-c,2));s=i.gradient({x:a,y:c},{x:l,y:u});r=-1/s};this.type="Straight";this.getLength=function(){return o};this.getGradient=function(){return s};this.getCoordinates=function(){return{x1:a,y1:c,x2:l,y2:u}};this.setCoordinates=function(e){a=e.x1;c=e.y1;l=e.x2;u=e.y2;h()};this.setCoordinates({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2});this.getBounds=function(){return{minX:Math.min(a,l),minY:Math.min(c,u),maxX:Math.max(a,l),maxY:Math.max(c,u)}};this.pointOnPath=function(e,t){if(e===0&&!t){return{x:a,y:c}}else if(e===1&&!t){return{x:l,y:u}}else{var n=t?e>0?e:o+e:e*o;return i.pointOnLine({x:a,y:c},{x:l,y:u},n)}};this.gradientAtPoint=function(e){return s};this.pointAlongPathFrom=function(e,t,n){var o=this.pointOnPath(e,n),s=t<=0?{x:a,y:c}:{x:l,y:u};if(t<=0&&Math.abs(t)>1){t*=-1}return i.pointOnLine(o,s,t)};var p=function(e,t,n){return n>=Math.min(e,t)&&n<=Math.max(e,t)};var f=function(e,t,n){return Math.abs(n-e)<Math.abs(n-t)?e:t};this.findClosestPointOnPath=function(e,t){var n={d:Infinity,x:null,y:null,l:null,x1:a,x2:l,y1:c,y2:u};if(s===0){n.y=c;n.x=p(a,l,e)?e:f(a,l,e)}else if(s===Infinity||s===-Infinity){n.x=a;n.y=p(c,u,t)?t:f(c,u,t)}else{var h=c-s*a,d=t-r*e,m=(d-h)/(s-r),v=s*m+h;n.x=p(a,l,m)?m:f(a,l,m);n.y=p(c,u,v)?v:f(c,u,v)}var y=i.lineLength([n.x,n.y],[a,c]);n.d=i.lineLength([e,t],[n.x,n.y]);n.l=y/o;return n};var d=function(e,t,n){return n>t?t<=e&&e<=n:t>=e&&e>=n},m=d;this.lineIntersection=function(e,t,n,o){var r=Math.abs(i.gradient({x:e,y:t},{x:n,y:o})),h=Math.abs(s),p=h===Infinity?a:c-h*a,f=[],d=r===Infinity?e:t-r*e;if(r!==h){if(r===Infinity&&h===0){if(m(e,a,l)&&m(c,t,o)){f=[e,c]}}else if(r===0&&h===Infinity){if(m(t,c,u)&&m(a,e,n)){f=[a,t]}}else{var v,y;if(r===Infinity){v=e;if(m(v,a,l)){y=h*e+p;if(m(y,t,o)){f=[v,y]}}}else if(r===0){y=t;if(m(y,c,u)){v=(t-p)/h;if(m(v,e,n)){f=[v,y]}}}else{v=(d-p)/(h-r);y=h*v+p;if(m(v,a,l)&&m(y,c,u)){f=[v,y]}}}}return f};this.boxIntersection=function(e,t,n,i){var o=[];o.push.apply(o,this.lineIntersection(e,t,e+n,t));o.push.apply(o,this.lineIntersection(e+n,t,e+n,t+i));o.push.apply(o,this.lineIntersection(e+n,t+i,e,t+i));o.push.apply(o,this.lineIntersection(e,t+i,e,t));return o};this.boundingBoxIntersection=function(e){return this.boxIntersection(e.x,e.y,e.w,e.h)}},Arc:function(e){var n=t.Segments.AbstractSegment.apply(this,arguments),o=function(t,n){return i.theta([e.cx,e.cy],[t,n])},s=function(e,t){if(e.anticlockwise){var n=e.startAngle<e.endAngle?e.startAngle+r:e.startAngle,i=Math.abs(n-e.endAngle);return n-i*t}else{var o=e.endAngle<e.startAngle?e.endAngle+r:e.endAngle,s=Math.abs(o-e.startAngle);return e.startAngle+s*t}},r=2*Math.PI;this.radius=e.r;this.anticlockwise=e.ac;this.type="Arc";if(e.startAngle&&e.endAngle){this.startAngle=e.startAngle;this.endAngle=e.endAngle;this.x1=e.cx+this.radius*Math.cos(e.startAngle);this.y1=e.cy+this.radius*Math.sin(e.startAngle);this.x2=e.cx+this.radius*Math.cos(e.endAngle);this.y2=e.cy+this.radius*Math.sin(e.endAngle)}else{this.startAngle=o(e.x1,e.y1);this.endAngle=o(e.x2,e.y2);this.x1=e.x1;this.y1=e.y1;this.x2=e.x2;this.y2=e.y2}if(this.endAngle<0){this.endAngle+=r}if(this.startAngle<0){this.startAngle+=r}var a=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(a-this.startAngle);if(this.anticlockwise){this.sweep=r-this.sweep}var l=2*Math.PI*this.radius,c=this.sweep/r,u=l*c;this.getLength=function(){return u};this.getBounds=function(){return{minX:e.cx-e.r,maxX:e.cx+e.r,minY:e.cy-e.r,maxY:e.cy+e.r}};var h=1e-10,p=function(e){var t=Math.floor(e),n=Math.ceil(e);if(e-t<h){return t}else if(n-e<h){return n}return e};this.pointOnPath=function(t,n){if(t===0){return{x:this.x1,y:this.y1,theta:this.startAngle}}else if(t===1){return{x:this.x2,y:this.y2,theta:this.endAngle}}if(n){t=t/u}var i=s(this,t),o=e.cx+e.r*Math.cos(i),r=e.cy+e.r*Math.sin(i);return{x:p(o),y:p(r),theta:i}};this.gradientAtPoint=function(t,n){var o=this.pointOnPath(t,n);var s=i.normal([e.cx,e.cy],[o.x,o.y]);if(!this.anticlockwise&&(s===Infinity||s===-Infinity)){s*=-1}return s};this.pointAlongPathFrom=function(t,n,i){var o=this.pointOnPath(t,i),s=n/l*2*Math.PI,r=this.anticlockwise?-1:1,a=o.theta+r*s,c=e.cx+this.radius*Math.cos(a),u=e.cy+this.radius*Math.sin(a);return{x:c,y:u}}},Bezier:function(n){this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}];var i=t.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)};this.type="Bezier";var o=function(t,n,i){if(i){n=e.jsBezier.locationAlongCurveFrom(t,n>0?0:1,n)}return n};this.pointOnPath=function(t,n){t=o(this.curve,t,n);return e.jsBezier.pointOnCurve(this.curve,t)};this.gradientAtPoint=function(t,n){t=o(this.curve,t,n);return e.jsBezier.gradientAtPoint(this.curve,t)};this.pointAlongPathFrom=function(t,n,i){t=o(this.curve,t,i);return e.jsBezier.pointAlongCurveFrom(this.curve,t,n)};this.getLength=function(){return e.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds};this.findClosestPointOnPath=function(t,n){var i=e.jsBezier.nearestPointOnCurve({x:t,y:n},this.curve);return{d:Math.sqrt(Math.pow(i.point.x-t,2)+Math.pow(i.point.y-n,2)),x:i.point.x,y:i.point.y,l:i.location,s:this}};this.lineIntersection=function(t,n,i,o){return e.jsBezier.lineIntersection(t,n,i,o,this.curve)}}};t.SegmentRenderer={getPath:function(e,t){return{Straight:function(t){var n=e.getCoordinates();return(t?"M "+n.x1+" "+n.y1+" ":"")+"L "+n.x2+" "+n.y2},Bezier:function(t){var n=e.params;return(t?"M "+n.x2+" "+n.y2+" ":"")+"C "+n.cp2x+" "+n.cp2y+" "+n.cp1x+" "+n.cp1y+" "+n.x1+" "+n.y1},Arc:function(t){var n=e.params,i=e.sweep>Math.PI?1:0,o=e.anticlockwise?0:1;return(t?"M"+e.x1+" "+e.y1+" ":"")+"A "+e.radius+" "+n.r+" 0 "+i+","+o+" "+e.x2+" "+e.y2}}[e.type](t)}};var o=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};t.Connectors.AbstractConnector=function(e){o.apply(this,arguments);var s=[],r=0,a=[],l=[],c=e.stub||0,u=n.isArray(c)?c[0]:c,h=n.isArray(c)?c[1]:c,p=e.gap||0,f=n.isArray(p)?p[0]:p,d=n.isArray(p)?p[1]:p,m=null,v=null;this.getPathData=function(){var e="";for(var n=0;n<s.length;n++){e+=t.SegmentRenderer.getPath(s[n],n===0);e+=" "}return e};this.findSegmentForPoint=function(e,t){var n={d:Infinity,s:null,x:null,y:null,l:null};for(var i=0;i<s.length;i++){var o=s[i].findClosestPointOnPath(e,t);if(o.d<n.d){n.d=o.d;n.l=o.l;n.x=o.x;n.y=o.y;n.s=s[i];n.x1=o.x1;n.x2=o.x2;n.y1=o.y1;n.y2=o.y2;n.index=i}}return n};this.lineIntersection=function(e,t,n,i){var o=[];for(var r=0;r<s.length;r++){o.push.apply(o,s[r].lineIntersection(e,t,n,i))}return o};this.boxIntersection=function(e,t,n,i){var o=[];for(var r=0;r<s.length;r++){o.push.apply(o,s[r].boxIntersection(e,t,n,i))}return o};this.boundingBoxIntersection=function(e){var t=[];for(var n=0;n<s.length;n++){t.push.apply(t,s[n].boundingBoxIntersection(e))}return t};var y=function(){var e=0;for(var t=0;t<s.length;t++){var n=s[t].getLength();l[t]=n/r;a[t]=[e,e+=n/r]}},g=function(e,t){if(t){e=e>0?e/r:(r+e)/r}var n=a.length-1,i=1;for(var o=0;o<a.length;o++){if(a[o][1]>=e){n=o;i=e===1?1:e===0?0:(e-a[o][0])/l[o];break}}return{segment:s[n],proportion:i,index:n}},b=function(e,n,i){if(i.x1===i.x2&&i.y1===i.y2){return}var o=new t.Segments[n](i);s.push(o);r+=o.getLength();e.updateBounds(o)},x=function(){r=s.length=a.length=l.length=0};this.setSegments=function(e){m=[];r=0;for(var t=0;t<e.length;t++){m.push(e[t]);r+=e[t].getLength()}};this.getLength=function(){return r};var P=function(e){this.strokeWidth=e.strokeWidth;var t=i.quadrant(e.sourcePos,e.targetPos),n=e.targetPos[0]<e.sourcePos[0],o=e.targetPos[1]<e.sourcePos[1],s=e.strokeWidth||1,r=e.sourceEndpoint.anchor.getOrientation(e.sourceEndpoint),a=e.targetEndpoint.anchor.getOrientation(e.targetEndpoint),l=n?e.targetPos[0]:e.sourcePos[0],c=o?e.targetPos[1]:e.sourcePos[1],p=Math.abs(e.targetPos[0]-e.sourcePos[0]),m=Math.abs(e.targetPos[1]-e.sourcePos[1]);if(r[0]===0&&r[1]===0||a[0]===0&&a[1]===0){var v=p>m?0:1,y=[1,0][v];r=[];a=[];r[v]=e.sourcePos[v]>e.targetPos[v]?-1:1;a[v]=e.sourcePos[v]>e.targetPos[v]?1:-1;r[y]=0;a[y]=0}var g=n?p+f*r[0]:f*r[0],b=o?m+f*r[1]:f*r[1],x=n?d*a[0]:p+d*a[0],P=o?d*a[1]:m+d*a[1],j=r[0]*a[0]+r[1]*a[1];var C={sx:g,sy:b,tx:x,ty:P,lw:s,xSpan:Math.abs(x-g),ySpan:Math.abs(P-b),mx:(g+x)/2,my:(b+P)/2,so:r,to:a,x:l,y:c,w:p,h:m,segment:t,startStubX:g+r[0]*u,startStubY:b+r[1]*u,endStubX:x+a[0]*h,endStubY:P+a[1]*h,isXGreaterThanStubTimes2:Math.abs(g-x)>u+h,isYGreaterThanStubTimes2:Math.abs(b-P)>u+h,opposite:j===-1,perpendicular:j===0,orthogonal:j===1,sourceAxis:r[0]===0?"y":"x",points:[l,c,p,m,g,b,x,P],stubs:[u,h]};C.anchorOrientation=C.opposite?"opposite":C.orthogonal?"orthogonal":"perpendicular";return C};this.getSegments=function(){return s};this.updateBounds=function(e){var t=e.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)};this.pointOnPath=function(e,t){var n=g(e,t);return n.segment&&n.segment.pointOnPath(n.proportion,false)||[0,0]};this.gradientAtPoint=function(e,t){var n=g(e,t);return n.segment&&n.segment.gradientAtPoint(n.proportion,false)||0};this.pointAlongPathFrom=function(e,t,n){var i=g(e,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,t,false)||[0,0]};this.compute=function(e){v=P.call(this,e);x();this._compute(v,e);this.x=v.points[0];this.y=v.points[1];this.w=v.points[2];this.h=v.points[3];this.segment=v.segment;y()};return{addSegment:b,prepareCompute:P,sourceStub:u,targetStub:h,maxStub:Math.max(u,h),sourceGap:f,targetGap:d,maxGap:Math.max(f,d)}};n.extend(t.Connectors.AbstractConnector,o);t.Endpoints.AbstractEndpoint=function(e){o.apply(this,arguments);var t=this.compute=function(e,t,n,i){var o=this._compute.apply(this,arguments);this.x=o[0];this.y=o[1];this.w=o[2];this.h=o[3];this.bounds.minX=this.x;this.bounds.minY=this.y;this.bounds.maxX=this.x+this.w;this.bounds.maxY=this.y+this.h;return o};return{compute:t,cssClass:e.cssClass}};n.extend(t.Endpoints.AbstractEndpoint,o);t.Endpoints.Dot=function(e){this.type="Dot";var n=t.Endpoints.AbstractEndpoint.apply(this,arguments);e=e||{};this.radius=e.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(e,t,n,i){this.radius=n.radius||this.radius;var o=e[0]-this.radius,s=e[1]-this.radius,r=this.radius*2,a=this.radius*2;if(n.stroke){var l=n.strokeWidth||1;o-=l;s-=l;r+=l*2;a+=l*2}return[o,s,r,a,this.radius]}};n.extend(t.Endpoints.Dot,t.Endpoints.AbstractEndpoint);t.Endpoints.Rectangle=function(e){this.type="Rectangle";var n=t.Endpoints.AbstractEndpoint.apply(this,arguments);e=e||{};this.width=e.width||20;this.height=e.height||20;this._compute=function(e,t,n,i){var o=n.width||this.width,s=n.height||this.height,r=e[0]-o/2,a=e[1]-s/2;return[r,a,o,s]}};n.extend(t.Endpoints.Rectangle,t.Endpoints.AbstractEndpoint);var s=function(e){t.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};n.extend(s,t.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(e){this._jsPlumb.displayElements.push(e)}});t.Endpoints.Image=function(i){this.type="Image";s.apply(this,arguments);t.Endpoints.AbstractEndpoint.apply(this,arguments);var o=i.onload,r=i.src||i.url,a=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=false;this._jsPlumb.initialized=false;this._jsPlumb.deleted=false;this._jsPlumb.widthToUse=i.width;this._jsPlumb.heightToUse=i.height;this._jsPlumb.endpoint=i.endpoint;this._jsPlumb.img.onload=function(){if(this._jsPlumb!=null){this._jsPlumb.ready=true;this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width;this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height;if(o){o(this)}}}.bind(this);this._jsPlumb.endpoint.setImage=function(e,t){var n=e.constructor===String?e:e.src;o=t;this._jsPlumb.img.src=n;if(this.canvas!=null){this.canvas.setAttribute("src",this._jsPlumb.img.src)}}.bind(this);this._jsPlumb.endpoint.setImage(r,o);this._compute=function(e,t,n,i){this.anchorPoint=e;if(this._jsPlumb.ready){return[e[0]-this._jsPlumb.widthToUse/2,e[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]}else{return[0,0,0,0]}};this.canvas=t.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+a);if(this._jsPlumb.widthToUse){this.canvas.setAttribute("width",this._jsPlumb.widthToUse)}if(this._jsPlumb.heightToUse){this.canvas.setAttribute("height",this._jsPlumb.heightToUse)}this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(e,t,i){if(!this._jsPlumb.deleted){if(!this._jsPlumb.initialized){this.canvas.setAttribute("src",this._jsPlumb.img.src);this.appendDisplayElement(this.canvas);this._jsPlumb.initialized=true}var o=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,s=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;n.sizeElement(this.canvas,o,s,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(t,n){if(this._jsPlumb!=null){if(this._jsPlumb.ready){this.actuallyPaint(t,n)}else{e.setTimeout(function(){this.paint(t,n)}.bind(this),200)}}}};n.extend(t.Endpoints.Image,[s,t.Endpoints.AbstractEndpoint],{cleanup:function(e){if(e){this._jsPlumb.deleted=true;if(this.canvas){this.canvas.parentNode.removeChild(this.canvas)}this.canvas=null}}});t.Endpoints.Blank=function(e){var i=t.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";s.apply(this,arguments);this._compute=function(e,t,n,i){return[e[0],e[1],10,0]};var o=e.cssClass?" "+e.cssClass:"";this.canvas=t.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+o);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(e,t){n.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};n.extend(t.Endpoints.Blank,[t.Endpoints.AbstractEndpoint,s],{cleanup:function(){if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}}});t.Endpoints.Triangle=function(e){this.type="Triangle";t.Endpoints.AbstractEndpoint.apply(this,arguments);var n=this;e=e||{};e.width=e.width||55;e.height=e.height||55;this.width=e.width;this.height=e.height;this._compute=function(e,t,i,o){var s=i.width||n.width,r=i.height||n.height,a=e[0]-s/2,l=e[1]-r/2;return[a,l,s,r]}};var r=t.Overlays.AbstractOverlay=function(e){this.visible=true;this.isAppendedAtTopLevel=true;this.component=e.component;this.loc=e.location==null?.5:e.location;this.endpointLoc=e.endpointLocation==null?[.5,.5]:e.endpointLocation;this.visible=e.visible!==false};r.prototype={cleanup:function(e){if(e){this.component=null;this.canvas=null;this.endpointLoc=null}},reattach:function(e,t){},setVisible:function(e){this.visible=e;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},incrementLocation:function(e){this.loc+=e;this.component.repaint()},setLocation:function(e){this.loc=e;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};t.Overlays.Arrow=function(e){this.type="Arrow";r.apply(this,arguments);this.isAppendedAtTopLevel=false;e=e||{};var o=this;this.length=e.length||20;this.width=e.width||20;this.id=e.id;this.direction=(e.direction||1)<0?-1:1;var s=e.paintStyle||{"stroke-width":1},a=e.foldback||.623;this.computeMaxSize=function(){return o.width*1.5};this.elementCreated=function(n,i){this.path=n;if(e.events){for(var o in e.events){t.on(n,o,e.events[o])}}};this.draw=function(e,t){var o,r,l,c,u;if(e.pointAlongPathFrom){if(n.isString(this.loc)||this.loc>1||this.loc<0){var h=parseInt(this.loc,10),p=this.loc<0?1:0;o=e.pointAlongPathFrom(p,h,false);r=e.pointAlongPathFrom(p,h-this.direction*this.length/2,false);l=i.pointOnLine(o,r,this.length)}else if(this.loc===1){o=e.pointOnPath(this.loc);r=e.pointAlongPathFrom(this.loc,-this.length);l=i.pointOnLine(o,r,this.length);if(this.direction===-1){var f=l;l=o;o=f}}else if(this.loc===0){l=e.pointOnPath(this.loc);r=e.pointAlongPathFrom(this.loc,this.length);o=i.pointOnLine(l,r,this.length);if(this.direction===-1){var d=l;l=o;o=d}}else{o=e.pointAlongPathFrom(this.loc,this.direction*this.length/2);r=e.pointOnPath(this.loc);l=i.pointOnLine(o,r,this.length)}c=i.perpendicularLineTo(o,l,this.width);u=i.pointOnLine(o,l,a*this.length);var m={hxy:o,tail:c,cxy:u},v=s.stroke||t.stroke,y=s.fill||t.stroke,g=s.strokeWidth||t.strokeWidth;return{component:e,d:m,"stroke-width":g,stroke:v,fill:y,minX:Math.min(o.x,c[0].x,c[1].x),maxX:Math.max(o.x,c[0].x,c[1].x),minY:Math.min(o.y,c[0].y,c[1].y),maxY:Math.max(o.y,c[0].y,c[1].y)}}else{return{component:e,minX:0,maxX:0,minY:0,maxY:0}}}};n.extend(t.Overlays.Arrow,r,{updateFrom:function(e){this.length=e.length||this.length;this.width=e.width||this.width;this.direction=e.direction!=null?e.direction:this.direction;this.foldback=e.foldback||this.foldback},cleanup:function(){if(this.path&&this.canvas){this.canvas.removeChild(this.path)}}});t.Overlays.PlainArrow=function(e){e=e||{};var n=t.extend(e,{foldback:1});t.Overlays.Arrow.call(this,n);this.type="PlainArrow"};n.extend(t.Overlays.PlainArrow,t.Overlays.Arrow);t.Overlays.Diamond=function(e){e=e||{};var n=e.length||40,i=t.extend(e,{length:n/2,foldback:2});t.Overlays.Arrow.call(this,i);this.type="Diamond"};n.extend(t.Overlays.Diamond,t.Overlays.Arrow);var a=function(e,t){if(e._jsPlumb.cachedDimensions==null||t){e._jsPlumb.cachedDimensions=e.getDimensions()}return e._jsPlumb.cachedDimensions};var l=function(e){t.jsPlumbUIComponent.apply(this,arguments);r.apply(this,arguments);var i=this.fire;this.fire=function(){i.apply(this,arguments);if(this.component){this.component.fire.apply(this.component,arguments)}};this.detached=false;this.id=e.id;this._jsPlumb.div=null;this._jsPlumb.initialised=false;this._jsPlumb.component=e.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=e.create;this._jsPlumb.initiallyInvisible=e.visible===false;this.getElement=function(){if(this._jsPlumb.div==null){var n=this._jsPlumb.div=t.getElement(this._jsPlumb.create(this._jsPlumb.component));n.style.position="absolute";jsPlumb.addClass(n,this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:e.cssClass?e.cssClass:""));this._jsPlumb.instance.appendElement(n);this._jsPlumb.instance.getId(n);this.canvas=n;var i="translate(-50%, -50%)";n.style.webkitTransform=i;n.style.mozTransform=i;n.style.msTransform=i;n.style.oTransform=i;n.style.transform=i;n._jsPlumb=this;if(e.visible===false){n.style.display="none"}}return this._jsPlumb.div};this.draw=function(e,t,i){var o=a(this);if(o!=null&&o.length===2){var s={x:0,y:0};if(i){s={x:i[0],y:i[1]}}else if(e.pointOnPath){var r=this.loc,l=false;if(n.isString(this.loc)||this.loc<0||this.loc>1){r=parseInt(this.loc,10);l=true}s=e.pointOnPath(r,l)}else{var c=this.loc.constructor===Array?this.loc:this.endpointLoc;s={x:c[0]*e.w,y:c[1]*e.h}}var u=s.x-o[0]/2,h=s.y-o[1]/2;return{component:e,d:{minx:u,miny:h,td:o,cxy:s},minX:u,maxX:u+o[0],minY:h,maxY:h+o[1]}}else{return{minX:0,maxX:0,minY:0,maxY:0}}}};n.extend(l,[t.jsPlumbUIComponent,r],{getDimensions:function(){return[1,1]},setVisible:function(e){if(this._jsPlumb.div){this._jsPlumb.div.style.display=e?"block":"none";if(e&&this._jsPlumb.initiallyInvisible){a(this,true);this.component.repaint();this._jsPlumb.initiallyInvisible=false}}},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(e){if(e){if(this._jsPlumb.div!=null){this._jsPlumb.div._jsPlumb=null;this._jsPlumb.instance.removeElement(this._jsPlumb.div)}}else{if(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}this.detached=true}},reattach:function(e,t){if(this._jsPlumb.div!=null){e.getContainer().appendChild(this._jsPlumb.div)}this.detached=false},computeMaxSize:function(){var e=a(this);return Math.max(e[0],e[1])},paint:function(e,t){if(!this._jsPlumb.initialised){this.getElement();e.component.appendDisplayElement(this._jsPlumb.div);this._jsPlumb.initialised=true;if(this.detached){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}}this._jsPlumb.div.style.left=e.component.x+e.d.minx+"px";this._jsPlumb.div.style.top=e.component.y+e.d.miny+"px"}});t.Overlays.Custom=function(e){this.type="Custom";l.apply(this,arguments)};n.extend(t.Overlays.Custom,l);t.Overlays.GuideLines=function(){var e=this;e.length=50;e.strokeWidth=5;this.type="GuideLines";r.apply(this,arguments);t.jsPlumbUIComponent.apply(this,arguments);this.draw=function(t,n){var o=t.pointAlongPathFrom(e.loc,e.length/2),s=t.pointOnPath(e.loc),r=i.pointOnLine(o,s,e.length),a=i.perpendicularLineTo(o,r,40),l=i.perpendicularLineTo(r,o,20);return{connector:t,head:o,tail:r,headLine:l,tailLine:a,minX:Math.min(o.x,r.x,l[0].x,l[1].x),minY:Math.min(o.y,r.y,l[0].y,l[1].y),maxX:Math.max(o.x,r.x,l[0].x,l[1].x),maxY:Math.max(o.y,r.y,l[0].y,l[1].y)}}};t.Overlays.Label=function(e){this.labelStyle=e.labelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var n=t.extend({create:function(){return t.createElement("div")}},e);t.Overlays.Custom.call(this,n);this.type="Label";this.label=e.label||"";this.labelText=null;if(this.labelStyle){var i=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif";i.style.font=this.labelStyle.font;i.style.color=this.labelStyle.color||"black";if(this.labelStyle.fill){i.style.background=this.labelStyle.fill}if(this.labelStyle.borderWidth>0){var o=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";i.style.border=this.labelStyle.borderWidth+"px solid "+o}if(this.labelStyle.padding){i.style.padding=this.labelStyle.padding}}};n.extend(t.Overlays.Label,t.Overlays.Custom,{cleanup:function(e){if(e){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null}},getLabel:function(){return this.label},setLabel:function(e){this.label=e;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){this.update();return l.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label==="function"){var e=this.label(this);this.getElement().innerHTML=e.replace(/\r\n/g,"<br/>")}else{if(this.labelText==null){this.labelText=this.label;this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>")}}},updateFrom:function(e){if(e.label!=null){this.setLabel(e.label)}}})}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumbUtil,n=e.jsPlumbInstance;var i="jtk-group-collapsed";var o="jtk-group-expanded";var s="[jtk-group-content]";var r="elementDraggable";var a="stop";var l="revert";var c="_groupManager";var u="_jsPlumbGroup";var h="_jsPlumbGroupDrag";var p="group:addMember";var f="group:removeMember";var d="group:add";var m="group:remove";var v="group:expand";var y="group:collapse";var g="groupDragStop";var b="connectionMoved";var x="internal.connectionDetached";var P="removeAll";var j="orphanAll";var C="show";var E="hide";var _=function(e){var n={},s={},r={},a=this;e.bind("connection",function(e){if(e.source[u]!=null&&e.target[u]!=null&&e.source[u]===e.target[u]){s[e.connection.id]=e.source[u];r[e.connection.id]=e.source[u]}else{if(e.source[u]!=null){t.suggest(e.source[u].connections.source,e.connection);s[e.connection.id]=e.source[u]}if(e.target[u]!=null){t.suggest(e.target[u].connections.target,e.connection);r[e.connection.id]=e.target[u]}}});function l(e){delete e.proxies;var n=s[e.id],i;if(n!=null){i=function(t){return t.id===e.id};t.removeWithFunction(n.connections.source,i);t.removeWithFunction(n.connections.target,i);delete s[e.id]}n=r[e.id];if(n!=null){i=function(t){return t.id===e.id};t.removeWithFunction(n.connections.source,i);t.removeWithFunction(n.connections.target,i);delete r[e.id]}}e.bind(x,function(e){l(e.connection)});e.bind(b,function(e){var t=e.index===0?s:r;var n=t[e.connection.id];if(n){var i=n.connections[e.index===0?"source":"target"];var o=i.indexOf(e.connection);if(o!==-1){i.splice(o,1)}}});this.addGroup=function(t){e.addClass(t.getEl(),o);n[t.id]=t;t.manager=this;g(t);e.fire(d,{group:t})};this.addToGroup=function(t,n,i){t=this.getGroup(t);if(t){var o=t.getEl();if(n._isJsPlumbGroup){return}var s=n._jsPlumbGroup;if(s!==t){var r=e.getOffset(n,true);var l=t.collapsed?e.getOffset(o,true):e.getOffset(t.getDragArea(),true);if(s!=null){s.remove(n,false,i,false,t);a.updateConnectionsForGroup(s)}t.add(n,i);var c=function(e,n){var i=n===0?1:0;e.each(function(e){e.setVisible(false);if(e.endpoints[i].element._jsPlumbGroup===t){e.endpoints[i].setVisible(false);f(e,i,t)}else{e.endpoints[n].setVisible(false);h(e,n,t)}})};if(t.collapsed){c(e.select({source:n}),0);c(e.select({target:n}),1)}var u=e.getId(n);e.dragManager.setParent(n,u,o,e.getId(o),r);var d={left:r.left-l.left,top:r.top-l.top};e.setPosition(n,d);e.dragManager.revalidateParent(n,u,r);a.updateConnectionsForGroup(t);e.revalidate(u);if(!i){var m={group:t,el:n,pos:d};if(s){m.sourceGroup=s}e.fire(p,m)}}}};this.removeFromGroup=function(e,t,n){e=this.getGroup(e);if(e){e.remove(t,null,n)}};this.getGroup=function(e){var i=e;if(t.isString(e)){i=n[e];if(i==null){throw new TypeError("No such group ["+e+"]")}}return i};this.getGroups=function(){var e=[];for(var t in n){e.push(n[t])}return e};this.removeGroup=function(t,i,o,s){t=this.getGroup(t);this.expandGroup(t,true);var r=t[i?P:j](o,s);e.remove(t.getEl());delete n[t.id];delete e._groups[t.id];e.fire(m,{group:t});return r};this.removeAllGroups=function(e,t,i){for(var o in n){this.removeGroup(n[o],e,t,i)}};function c(t,n){var i=t.getMembers();for(var o=0;o<i.length;o++){e[n?C:E](i[o],true)}}var h=function(t,n,i){var o=t.endpoints[n===0?1:0].element;if(o[u]&&(!o[u].shouldProxy()&&o[u].collapsed)){return}var s=i.getEl(),r=e.getId(s);e.proxyConnection(t,n,s,r,function(e,t){return i.getEndpoint(e,t)},function(e,t){return i.getAnchor(e,t)})};this.collapseGroup=function(t){t=this.getGroup(t);if(t==null||t.collapsed){return}var n=t.getEl();c(t,false);if(t.shouldProxy()){var s=function(e,n){for(var i=0;i<e.length;i++){var o=e[i];h(o,n,t)}};s(t.connections.source,0);s(t.connections.target,1)}t.collapsed=true;e.removeClass(n,o);e.addClass(n,i);e.revalidate(n);e.fire(y,{group:t})};var f=function(t,n,i){e.unproxyConnection(t,n,e.getId(i.getEl()))};this.expandGroup=function(t,n){t=this.getGroup(t);if(t==null||!t.collapsed){return}var s=t.getEl();c(t,true);if(t.shouldProxy()){var r=function(e,n){for(var i=0;i<e.length;i++){var o=e[i];f(o,n,t)}};r(t.connections.source,0);r(t.connections.target,1)}t.collapsed=false;e.addClass(s,o);e.removeClass(s,i);e.revalidate(s);this.repaintGroup(t);if(!n){e.fire(v,{group:t})}};this.repaintGroup=function(t){t=this.getGroup(t);var n=t.getMembers();for(var i=0;i<n.length;i++){e.revalidate(n[i])}};function g(t){var n=t.getMembers();var i=e.getConnections({source:n,scope:"*"},true);var o=e.getConnections({target:n,scope:"*"},true);var a={};t.connections.source.length=0;t.connections.target.length=0;var l=function(e){for(var n=0;n<e.length;n++){if(a[e[n].id]){continue}a[e[n].id]=true;if(e[n].source._jsPlumbGroup===t){if(e[n].target._jsPlumbGroup!==t){t.connections.source.push(e[n])}s[e[n].id]=t}else if(e[n].target._jsPlumbGroup===t){t.connections.target.push(e[n]);r[e[n].id]=t}}};l(i);l(o)}this.updateConnectionsForGroup=g;this.refreshAllGroups=function(){for(var t in n){g(n[t]);e.dragManager.updateOffsets(e.getId(n[t].getEl()))}}};var w=function(n,i){var o=this;var c=i.el;this.getEl=function(){return c};this.id=i.id||t.uuid();c._isJsPlumbGroup=true;var p=this.getDragArea=function(){var e=n.getSelector(c,s);return e&&e.length>0?e[0]:c};var d=i.ghost===true;var m=d||i.constrain===true;var v=i.revert!==false;var y=i.orphan===true;var b=i.prune===true;var x=i.dropOverride===true;var P=i.proxied!==false;var j=[];this.connections={source:[],target:[],internal:[]};this.getAnchor=function(e,t){return i.anchor||"Continuous"};this.getEndpoint=function(e,t){return i.endpoint||["Dot",{radius:10}]};this.collapsed=false;if(i.draggable!==false){var C={stop:function(e){n.fire(g,jsPlumb.extend(e,{group:o}))},scope:h};if(i.dragOptions){e.jsPlumb.extend(C,i.dragOptions)}n.draggable(i.el,C)}if(i.droppable!==false){n.droppable(i.el,{drop:function(e){var t=e.drag.el;if(t._isJsPlumbGroup){return}var i=t._jsPlumbGroup;if(i!==o){if(i!=null){if(i.overrideDrop(t,o)){return}}n.getGroupManager().addToGroup(o,t,false)}}})}var E=function(e,t){var n=e.nodeType==null?e:[e];for(var i=0;i<n.length;i++){t(n[i])}};this.overrideDrop=function(e,t){return x&&(v||b||y)};this.add=function(e,t){var i=p();E(e,function(e){if(e._jsPlumbGroup!=null){if(e._jsPlumbGroup===o){return}else{e._jsPlumbGroup.remove(e,true,t,false)}}e._jsPlumbGroup=o;j.push(e);if(n.isAlreadyDraggable(e)){O(e)}if(e.parentNode!==i){i.appendChild(e)}});n.getGroupManager().updateConnectionsForGroup(o)};this.remove=function(e,i,s,r,a){E(e,function(e){delete e._jsPlumbGroup;t.removeWithFunction(j,function(t){return t===e});if(i){try{o.getDragArea().removeChild(e)}catch(e){jsPlumbUtil.log("Could not remove element from Group "+e)}}k(e);if(!s){var r={group:o,el:e};if(a){r.targetGroup=a}n.fire(f,r)}});if(!r){n.getGroupManager().updateConnectionsForGroup(o)}};this.removeAll=function(e,t){for(var i=0,s=j.length;i<s;i++){var r=j[0];o.remove(r,e,t,true);n.remove(r,true)}j.length=0;n.getGroupManager().updateConnectionsForGroup(o)};this.orphanAll=function(){var e={};for(var t=0;t<j.length;t++){var n=D(j[t]);e[n[0]]=n[1]}j.length=0;return e};this.getMembers=function(){return j};c[u]=this;n.bind(r,function(e){if(e.el._jsPlumbGroup===this){O(e.el)}}.bind(this));function _(e){return e.offsetParent}function w(e,t){var i=_(e),o=n.getSize(i),s=n.getSize(e),r=t[0],a=r+s[0],l=t[1],c=l+s[1];return a>0&&r<o[0]&&c>0&&l<o[1]}function D(e){var t=n.getId(e);var i=n.getOffset(e);e.parentNode.removeChild(e);n.getContainer().appendChild(e);n.setPosition(e,i);delete e._jsPlumbGroup;k(e);n.dragManager.clearParent(e,t);return[t,i]}function S(e){var t=null;if(!w(e.el,e.pos)){var i=e.el._jsPlumbGroup;if(b){n.remove(e.el)}else{t=D(e.el)}i.remove(e.el)}return t}function T(e){var t=n.getId(e);n.revalidate(e);n.dragManager.revalidateParent(e,t)}function k(e){if(!e._katavorioDrag){return}if(b||y){e._katavorioDrag.off(a,S)}if(!b&&!y&&v){e._katavorioDrag.off(l,T);e._katavorioDrag.setRevert(null)}}function O(e){if(!e._katavorioDrag){return}if(b||y){e._katavorioDrag.on(a,S)}if(m){e._katavorioDrag.setConstrain(true)}if(d){e._katavorioDrag.setUseGhostProxy(true)}if(!b&&!y&&v){e._katavorioDrag.on(l,T);e._katavorioDrag.setRevert(function(e,t){return!w(e,t)})}}this.shouldProxy=function(){return P};n.getGroupManager().addGroup(this)};n.prototype.addGroup=function(e){var t=this;t._groups=t._groups||{};if(t._groups[e.id]!=null){throw new TypeError("cannot create Group ["+e.id+"]; a Group with that ID exists")}if(e.el[u]!=null){throw new TypeError("cannot create Group ["+e.id+"]; the given element is already a Group")}var n=new w(t,e);t._groups[n.id]=n;if(e.collapsed){this.collapseGroup(n)}return n};n.prototype.addToGroup=function(e,t,n){var i=function(t){var i=this.getId(t);this.manage(i,t);this.getGroupManager().addToGroup(e,t,n)}.bind(this);if(Array.isArray(t)){for(var o=0;o<t.length;o++){i(t[o])}}else{i(t)}};n.prototype.removeFromGroup=function(e,t,n){this.getGroupManager().removeFromGroup(e,t,n)};n.prototype.removeGroup=function(e,t,n,i){return this.getGroupManager().removeGroup(e,t,n,i)};n.prototype.removeAllGroups=function(e,t,n){this.getGroupManager().removeAllGroups(e,t,n)};n.prototype.getGroup=function(e){return this.getGroupManager().getGroup(e)};n.prototype.getGroups=function(){return this.getGroupManager().getGroups()};n.prototype.expandGroup=function(e){this.getGroupManager().expandGroup(e)};n.prototype.collapseGroup=function(e){this.getGroupManager().collapseGroup(e)};n.prototype.repaintGroup=function(e){this.getGroupManager().repaintGroup(e)};n.prototype.toggleGroup=function(e){e=this.getGroupManager().getGroup(e);if(e!=null){this.getGroupManager()[e.collapsed?"expandGroup":"collapseGroup"](e)}};n.prototype.getGroupManager=function(){var e=this[c];if(e==null){e=this[c]=new _(this)}return e};n.prototype.removeGroupManager=function(){delete this[c]};n.prototype.getGroupFor=function(e){e=this.getElement(e);if(e){return e[u]}}}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i="Straight";var o="Arc";var s=function(e){this.type="Flowchart";e=e||{};e.stub=e.stub==null?30:e.stub;var n,s=t.Connectors.AbstractConnector.apply(this,arguments),r=e.midpoint==null?.5:e.midpoint,a=e.alwaysRespectStubs===true,l=null,c=null,u=e.cornerRadius!=null?e.cornerRadius:0,h=function(e){return e<0?-1:e===0?0:1},p=function(e){return[h(e[2]-e[0]),h(e[3]-e[1])]},f=function(e,t,n,i){if(l===t&&c===n){return}var o=l==null?i.sx:l,s=c==null?i.sy:c,r=o===t?"v":"h";l=t;c=n;e.push([o,s,t,n,r])},d=function(e){return Math.sqrt(Math.pow(e[0]-e[2],2)+Math.pow(e[1]-e[3],2))},m=function(e){var t=[];t.push.apply(t,e);return t},v=function(e,t,n){var r=null,a,l,c;for(var h=0;h<t.length-1;h++){r=r||m(t[h]);a=m(t[h+1]);l=p(r);c=p(a);if(u>0&&r[4]!==a[4]){var f=Math.min(d(r),d(a));var v=Math.min(u,f/2);r[2]-=l[0]*v;r[3]-=l[1]*v;a[0]+=c[0]*v;a[1]+=c[1]*v;var y=l[1]===c[0]&&c[0]===1||l[1]===c[0]&&c[0]===0&&l[0]!==c[1]||l[1]===c[0]&&c[0]===-1,g=a[1]>r[3]?1:-1,b=a[0]>r[2]?1:-1,x=g===b,P=x&&y||!x&&!y?a[0]:r[2],j=x&&y||!x&&!y?r[3]:a[1];s.addSegment(e,i,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});s.addSegment(e,o,{r:v,x1:r[2],y1:r[3],x2:a[0],y2:a[1],cx:P,cy:j,ac:y})}else{var C=r[2]===r[0]?0:r[2]>r[0]?n.lw/2:-(n.lw/2),E=r[3]===r[1]?0:r[3]>r[1]?n.lw/2:-(n.lw/2);s.addSegment(e,i,{x1:r[0]-C,y1:r[1]-E,x2:r[2]+C,y2:r[3]+E})}r=a}if(a!=null){s.addSegment(e,i,{x1:a[0],y1:a[1],x2:a[2],y2:a[3]})}};this._compute=function(e,t){n=[];l=null;c=null;var i=function(){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},o={perpendicular:i,orthogonal:i,opposite:function(t){var n=e,i=t==="x"?0:1,o={x:function(){return n.so[i]===1&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||n.so[i]===-1&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return n.so[i]===1&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||n.so[i]===-1&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};if(!a&&o[t]()){return{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[t]}else{return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}}};var u=o[e.anchorOrientation](e.sourceAxis),h=e.sourceAxis==="x"?0:1,p=e.sourceAxis==="x"?1:0,d=u[h],m=u[p],y=u[h+2],g=u[p+2];f(n,u[0],u[1],e);var b=e.startStubX+(e.endStubX-e.startStubX)*r,x=e.startStubY+(e.endStubY-e.startStubY)*r;var P={x:[0,1],y:[1,0]},j={perpendicular:function(t){var n=e,i={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},o={x:[[n.startStubX,n.endStubX],null,[n.endStubX,n.startStubX]],y:[[n.startStubY,n.endStubY],null,[n.endStubY,n.startStubY]]},s={x:[[b,n.startStubY],[b,n.endStubY]],y:[[n.startStubX,x],[n.endStubX,x]]},r={x:[[n.endStubX,n.startStubY]],y:[[n.startStubX,n.endStubY]]},a={x:[[n.startStubX,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.endStubX,n.startStubY],[n.endStubX,n.endStubY]]},l={x:[[n.startStubX,x],[n.endStubX,x],[n.endStubX,n.endStubY]],y:[[b,n.startStubY],[b,n.endStubY],[n.endStubX,n.endStubY]]},c={x:[n.startStubY,n.endStubY],y:[n.startStubX,n.endStubX]},u=P[t][0],h=P[t][1],p=n.so[u]+1,f=n.to[h]+1,d=n.to[h]===-1&&c[t][1]<c[t][0]||n.to[h]===1&&c[t][1]>c[t][0],m=o[t][p][0],v=o[t][p][1],y=i[t][p][f];if(n.segment===y[3]||n.segment===y[2]&&d){return s[t]}else if(n.segment===y[2]&&v<m){return r[t]}else if(n.segment===y[2]&&v>=m||n.segment===y[1]&&!d){return l[t]}else if(n.segment===y[0]||n.segment===y[1]&&d){return a[t]}},orthogonal:function(t,n,i,o,s){var r=e,a={x:r.so[0]===-1?Math.min(n,o):Math.max(n,o),y:r.so[1]===-1?Math.min(n,o):Math.max(n,o)}[t];return{x:[[a,i],[a,s],[o,s]],y:[[i,a],[s,a],[s,o]]}[t]},opposite:function(n,i,o,r){var a=e,l={x:"y",y:"x"}[n],c={x:"height",y:"width"}[n],u=a["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var p=o+(1-t.sourceEndpoint.anchor[l])*t.sourceInfo[c]+s.maxStub;return{x:[[i,p],[r,p]],y:[[p,i],[p,r]]}[n]}else if(!u||a.so[h]===1&&i>r||a.so[h]===-1&&i<r){return{x:[[i,x],[r,x]],y:[[b,i],[b,r]]}[n]}else if(a.so[h]===1&&i<r||a.so[h]===-1&&i>r){return{x:[[b,a.sy],[b,a.ty]],y:[[a.sx,x],[a.tx,x]]}[n]}}};var C=j[e.anchorOrientation](e.sourceAxis,d,m,y,g);if(C){for(var E=0;E<C.length;E++){f(n,C[E][0],C[E][1],e)}}f(n,u[2],u[3],e);f(n,e.tx,e.ty,e);v(this,n,e)}};t.Connectors.Flowchart=s;n.extend(t.Connectors.Flowchart,t.Connectors.AbstractConnector)}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;t.Connectors.AbstractBezierConnector=function(e){e=e||{};var n=e.showLoopback!==false,i=e.margin||5,o=e.orientation&&e.orientation==="clockwise",s=e.loopbackRadius||25,r;this._compute=function(e,t){var a=t.sourcePos,l=t.targetPos,c=Math.abs(a[0]-l[0]),u=Math.abs(a[1]-l[1]);if(!n||t.sourceEndpoint.elementId!==t.targetEndpoint.elementId){this._computeBezier(e,t,a,l,c,u)}else{var h=t.sourcePos[0],p=t.sourcePos[1]-i,f=h,d=p-s,m=f-s,v=d-s;c=2*s;u=2*s;e.points[0]=m;e.points[1]=v;e.points[2]=c;e.points[3]=u;r.addSegment(this,"Arc",{loopback:true,x1:h-m+4,y1:p-v,startAngle:0,endAngle:2*Math.PI,r:s,ac:!o,x2:h-m-4,y2:p-v,cx:f-m,cy:d-v})}};r=t.Connectors.AbstractConnector.apply(this,arguments);return r};n.extend(t.Connectors.AbstractBezierConnector,t.Connectors.AbstractConnector);var i=function(e){e=e||{};this.type="Bezier";var n=t.Connectors.AbstractBezierConnector.apply(this,arguments),i=e.curviness||150,o=10;this.getCurviness=function(){return i};this._findControlPoint=function(e,t,n,s,r,a,l){var c=a[0]!==l[0]||a[1]===l[1],u=[];if(!c){if(a[0]===0){u.push(t[0]<n[0]?e[0]+o:e[0]-o)}else{u.push(e[0]-i*a[0])}if(a[1]===0){u.push(t[1]<n[1]?e[1]+o:e[1]-o)}else{u.push(e[1]+i*l[1])}}else{if(l[0]===0){u.push(n[0]<t[0]?e[0]+o:e[0]-o)}else{u.push(e[0]+i*l[0])}if(l[1]===0){u.push(n[1]<t[1]?e[1]+o:e[1]-o)}else{u.push(e[1]+i*a[1])}}return u};this._computeBezier=function(e,t,i,o,s,r){var a,l,c=i[0]<o[0]?s:0,u=i[1]<o[1]?r:0,h=i[0]<o[0]?0:s,p=i[1]<o[1]?0:r;a=this._findControlPoint([c,u],i,o,t.sourceEndpoint,t.targetEndpoint,e.so,e.to);l=this._findControlPoint([h,p],o,i,t.targetEndpoint,t.sourceEndpoint,e.to,e.so);n.addSegment(this,"Bezier",{x1:c,y1:u,x2:h,y2:p,cp1x:a[0],cp1y:a[1],cp2x:l[0],cp2y:l[1]})}};t.Connectors.Bezier=i;n.extend(i,t.Connectors.AbstractBezierConnector)}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i=function(e,t,n,i){if(e<=n&&i<=t){return 1}else if(e<=n&&t<=i){return 2}else if(n<=e&&i>=t){return 3}return 4},o=function(e,t,n,i,o,s,r,a,l){if(a<=l){return[e,t]}if(n===1){if(i[3]<=0&&o[3]>=1){return[e+(i[2]<.5?-1*s:s),t]}else if(i[2]>=1&&o[2]<=0){return[e,t+(i[3]<.5?-1*r:r)]}else{return[e+-1*s,t+-1*r]}}else if(n===2){if(i[3]>=1&&o[3]<=0){return[e+(i[2]<.5?-1*s:s),t]}else if(i[2]>=1&&o[2]<=0){return[e,t+(i[3]<.5?-1*r:r)]}else{return[e+s,t+-1*r]}}else if(n===3){if(i[3]>=1&&o[3]<=0){return[e+(i[2]<.5?-1*s:s),t]}else if(i[2]<=0&&o[2]>=1){return[e,t+(i[3]<.5?-1*r:r)]}else{return[e+-1*s,t+-1*r]}}else if(n===4){if(i[3]<=0&&o[3]>=1){return[e+(i[2]<.5?-1*s:s),t]}else if(i[2]<=0&&o[2]>=1){return[e,t+(i[3]<.5?-1*r:r)]}else{return[e+s,t+-1*r]}}};var s=function(e){e=e||{};this.type="StateMachine";var n=t.Connectors.AbstractBezierConnector.apply(this,arguments),s=e.curviness||10,r=e.margin||5,a=e.proximityLimit||80,l;this._computeBezier=function(e,t,c,u,h,p){var f=t.sourcePos[0]<t.targetPos[0]?0:h,d=t.sourcePos[1]<t.targetPos[1]?0:p,m=t.sourcePos[0]<t.targetPos[0]?h:0,v=t.sourcePos[1]<t.targetPos[1]?p:0;if(t.sourcePos[2]===0){f-=r}if(t.sourcePos[2]===1){f+=r}if(t.sourcePos[3]===0){d-=r}if(t.sourcePos[3]===1){d+=r}if(t.targetPos[2]===0){m-=r}if(t.targetPos[2]===1){m+=r}if(t.targetPos[3]===0){v-=r}if(t.targetPos[3]===1){v+=r}var y=(f+m)/2,g=(d+v)/2,b=i(f,d,m,v),x=Math.sqrt(Math.pow(m-f,2)+Math.pow(v-d,2)),P,j,C,E;l=o(y,g,b,t.sourcePos,t.targetPos,s,s,x,a);P=l[0];j=l[0];C=l[1];E=l[1];n.addSegment(this,"Bezier",{x1:m,y1:v,x2:f,y2:d,cp1x:P,cp1y:C,cp2x:j,cp2y:E})}};t.Connectors.StateMachine=s;n.extend(s,t.Connectors.AbstractBezierConnector)}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i="Straight";var o=function(e){this.type=i;var n=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(e,t){n.addSegment(this,i,{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY});n.addSegment(this,i,{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY});n.addSegment(this,i,{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty})}};t.Connectors.Straight=o;n.extend(o,t.Connectors.AbstractConnector)}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil;var i={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",s="dashstyle",r="linearGradient",a="radialGradient",l="defs",c="fill",u="stop",h="stroke",p="stroke-width",f="style",d="none",m="jsplumb_gradient_",v="strokeWidth",y={svg:"http://www.w3.org/2000/svg"},g=function(e,t){for(var n in t){e.setAttribute(n,""+t[n])}},b=function(e,n){n=n||{};n.version="1.1";n.xmlns=y.svg;return t.createElementNS(y.svg,e,null,null,n)},x=function(e){return"position:absolute;left:"+e[0]+"px;top:"+e[1]+"px"},P=function(e){var t=e.querySelectorAll(" defs,linearGradient,radialGradient");for(var n=0;n<t.length;n++){t[n].parentNode.removeChild(t[n])}},j=function(e,t,n,i,o){var s=m+o._jsPlumb.instance.idstamp();P(e);var p;if(!n.gradient.offset){p=b(r,{id:s,gradientUnits:"userSpaceOnUse"})}else{p=b(a,{id:s})}var f=b(l);e.appendChild(f);f.appendChild(p);for(var d=0;d<n.gradient.stops.length;d++){var v=o.segment===1||o.segment===2?d:n.gradient.stops.length-1-d,y=n.gradient.stops[v][1],g=b(u,{offset:Math.floor(n.gradient.stops[d][0]*100)+"%","stop-color":y});p.appendChild(g)}var x=n.stroke?h:c;t.setAttribute(x,"url(#"+s+")")},C=function(e,t,n,r,a){t.setAttribute(c,n.fill?n.fill:d);t.setAttribute(h,n.stroke?n.stroke:d);if(n.gradient){j(e,t,n,r,a)}else{P(e);t.setAttribute(f,"")}if(n.strokeWidth){t.setAttribute(p,n.strokeWidth)}if(n[s]&&n[v]&&!n[o]){var l=n[s].indexOf(",")===-1?" ":",",u=n[s].split(l),m="";u.forEach(function(e){m+=Math.floor(e*n.strokeWidth)+l});t.setAttribute(o,m)}else if(n[o]){t.setAttribute(o,n[o])}for(var y in i){if(n[y]){t.setAttribute(i[y],n[y])}}},E=function(e,t,n){if(e.childNodes.length>n){e.insertBefore(t,e.childNodes[n])}else{e.appendChild(t)}};n.svg={node:b,attr:g,pos:x};var _=function(e){var i=e.pointerEventsSpec||"all",o={};t.jsPlumbUIComponent.apply(this,e.originalArgs);this.canvas=null;this.path=null;this.svg=null;this.bgCanvas=null;var s=e.cssClass+" "+(e.originalArgs[0].cssClass||""),r={style:"",width:0,height:0,"pointer-events":i,position:"absolute"};this.svg=b("svg",r);if(e.useDivWrapper){this.canvas=t.createElement("div",{position:"absolute"});n.sizeElement(this.canvas,0,0,1,1);this.canvas.className=s}else{g(this.svg,{class:s});this.canvas=this.svg}e._jsPlumb.appendElement(this.canvas,e.originalArgs[0].parent);if(e.useDivWrapper){this.canvas.appendChild(this.svg)}var a=[this.canvas];this.getDisplayElements=function(){return a};this.appendDisplayElement=function(e){a.push(e)};this.paint=function(t,i,s){if(t!=null){var r=[this.x,this.y],a=[this.w,this.h],l;if(s!=null){if(s.xmin<0){r[0]+=s.xmin}if(s.ymin<0){r[1]+=s.ymin}a[0]=s.xmax+(s.xmin<0?-s.xmin:0);a[1]=s.ymax+(s.ymin<0?-s.ymin:0)}if(e.useDivWrapper){n.sizeElement(this.canvas,r[0],r[1],a[0],a[1]);r[0]=0;r[1]=0;l=x([0,0])}else{l=x([r[0],r[1]])}o.paint.apply(this,arguments);g(this.svg,{style:l,width:a[0]||0,height:a[1]||0})}};return{renderer:o}};n.extend(_,t.jsPlumbUIComponent,{cleanup:function(e){if(e||this.typeId==null){if(this.canvas){this.canvas._jsPlumb=null}if(this.svg){this.svg._jsPlumb=null}if(this.bgCanvas){this.bgCanvas._jsPlumb=null}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}this.svg=null;this.canvas=null;this.path=null;this.group=null}else{if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.bgCanvas.parentNode.removeChild(this.bgCanvas)}}},reattach:function(e){var t=e.getContainer();if(this.canvas&&this.canvas.parentNode==null){t.appendChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode==null){t.appendChild(this.bgCanvas)}},setVisible:function(e){if(this.canvas){this.canvas.style.display=e?"block":"none"}}});t.ConnectorRenderers.svg=function(e){var n=this,i=_.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);i.renderer.paint=function(i,o,s){var r=n.getSegments(),a="",l=[0,0];if(s.xmin<0){l[0]=-s.xmin}if(s.ymin<0){l[1]=-s.ymin}if(r.length>0){a=n.getPathData();var c={d:a,transform:"translate("+l[0]+","+l[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},u=null,h=[n.x,n.y,n.w,n.h];if(i.outlineStroke){var p=i.outlineWidth||1,f=i.strokeWidth+2*p;u=t.extend({},i);delete u.gradient;u.stroke=i.outlineStroke;u.strokeWidth=f;if(n.bgPath==null){n.bgPath=b("path",c);t.addClass(n.bgPath,t.connectorOutlineClass);E(n.svg,n.bgPath,0)}else{g(n.bgPath,c)}C(n.svg,n.bgPath,u,h,n)}if(n.path==null){n.path=b("path",c);E(n.svg,n.path,i.outlineStroke?1:0)}else{g(n.path,c)}C(n.svg,n.path,i,h,n)}}};n.extend(t.ConnectorRenderers.svg,_);var w=t.SvgEndpoint=function(e){var n=_.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:e._jsPlumb}]);n.renderer.paint=function(e){var n=t.extend({},e);if(n.outlineStroke){n.stroke=n.outlineStroke}if(this.node==null){this.node=this.makeNode(n);this.svg.appendChild(this.node)}else if(this.updateNode!=null){this.updateNode(this.node)}C(this.svg,this.node,n,[this.x,this.y,this.w,this.h],this)}.bind(this)};n.extend(w,_);t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments);w.apply(this,arguments);this.makeNode=function(e){return b("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(e){g(e,{cx:this.w/2,cy:this.h/2,r:this.radius})}};n.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,w]);t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments);w.apply(this,arguments);this.makeNode=function(e){return b("rect",{width:this.w,height:this.h})};this.updateNode=function(e){g(e,{width:this.w,height:this.h})}};n.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,w]);t.Endpoints.svg.Image=t.Endpoints.Image;t.Endpoints.svg.Blank=t.Endpoints.Blank;t.Overlays.svg.Label=t.Overlays.Label;t.Overlays.svg.Custom=t.Overlays.Custom;var D=function(e,n){e.apply(this,n);t.jsPlumbUIComponent.apply(this,n);this.isAppendedAtTopLevel=false;this.path=null;this.paint=function(e,t){if(e.component.svg&&t){if(this.path==null){this.path=b("path",{"pointer-events":"all"});e.component.svg.appendChild(this.path);if(this.elementCreated){this.elementCreated(this.path,e.component)}this.canvas=e.component.svg}var o=n&&n.length===1?n[0].cssClass||"":"",s=[0,0];if(t.xmin<0){s[0]=-t.xmin}if(t.ymin<0){s[1]=-t.ymin}g(this.path,{d:i(e.d),class:o,stroke:e.stroke?e.stroke:null,fill:e.fill?e.fill:null,transform:"translate("+s[0]+","+s[1]+")"})}};var i=function(e){return isNaN(e.cxy.x)||isNaN(e.cxy.y)?"":"M"+e.hxy.x+","+e.hxy.y+" L"+e.tail[0].x+","+e.tail[0].y+" L"+e.cxy.x+","+e.cxy.y+" L"+e.tail[1].x+","+e.tail[1].y+" L"+e.hxy.x+","+e.hxy.y};this.transfer=function(e){if(e.canvas&&this.path&&this.path.parentNode){this.path.parentNode.removeChild(this.path);e.canvas.appendChild(this.path)}}};n.extend(D,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay],{cleanup:function(e){if(this.path!=null){if(e){this._jsPlumb.instance.removeElement(this.path)}else{if(this.path.parentNode){this.path.parentNode.removeChild(this.path)}}}},reattach:function(e,t){if(this.path&&t.canvas){t.canvas.appendChild(this.path)}},setVisible:function(e){if(this.path!=null){this.path.style.display=e?"block":"none"}}});t.Overlays.svg.Arrow=function(){D.apply(this,[t.Overlays.Arrow,arguments])};n.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,D]);t.Overlays.svg.PlainArrow=function(){D.apply(this,[t.Overlays.PlainArrow,arguments])};n.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,D]);t.Overlays.svg.Diamond=function(){D.apply(this,[t.Overlays.Diamond,arguments])};n.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,D]);t.Overlays.svg.GuideLines=function(){var e=null,n=this,i,o;t.Overlays.GuideLines.apply(this,arguments);this.paint=function(t,r){if(e==null){e=b("path");t.connector.svg.appendChild(e);n.attachListeners(e,t.connector);n.attachListeners(e,n);i=b("path");t.connector.svg.appendChild(i);n.attachListeners(i,t.connector);n.attachListeners(i,n);o=b("path");t.connector.svg.appendChild(o);n.attachListeners(o,t.connector);n.attachListeners(o,n)}var a=[0,0];if(r.xmin<0){a[0]=-r.xmin}if(r.ymin<0){a[1]=-r.ymin}g(e,{d:s(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"});g(i,{d:s(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"});g(o,{d:s(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var s=function(e,t){return"M "+e.x+","+e.y+" L"+t.x+","+t.y}};n.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}).call(typeof window!=="undefined"?window:commonjsGlobal);(function(){var e=this,t=e.jsPlumb,n=e.jsPlumbUtil,i=e.Katavorio,o=e.Biltong;var s=function(t){var n=t._mottle;if(!n){n=t._mottle=new e.Mottle}return n};var r=function(e,n){n=n||"main";var s="_katavorio_"+n;var r=e[s],a=e.getEventManager();if(!r){r=new i({bind:a.on,unbind:a.off,getSize:t.getSize,getConstrainingRectangle:function(e){return[e.parentNode.scrollWidth,e.parentNode.scrollHeight]},getPosition:function(t,n){var i=e.getOffset(t,n,t._katavorioDrag?t.offsetParent:null);return[i.left,i.top]},setPosition:function(e,t){e.style.left=t[0]+"px";e.style.top=t[1]+"px"},addClass:t.addClass,removeClass:t.removeClass,intersects:o.intersects,indexOf:function(e,t){return e.indexOf(t)},scope:e.getDefaultScope(),css:{noSelect:e.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}});r.setZoom(e.getZoom());e[s]=r;e.bind("zoom",r.setZoom)}return r};var a=function(e){var t=e.el._jsPlumbDragOptions;var n=true;if(t.canDrag){n=t.canDrag()}if(n){this.setHoverSuspended(true);this.select({source:e.el}).addClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,true);this.select({target:e.el}).addClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,true);this.setConnectionBeingDragged(true)}return n};var l=function(e){var t=this.getUIPosition(arguments,this.getZoom());if(t!=null){var n=e.el._jsPlumbDragOptions;this.draw(e.el,t,null,true);if(n._dragging){this.addClass(e.el,"jtk-dragged")}n._dragging=true}};var c=function(e){var t=e.selection,n;var i=function(e){if(e[1]!=null){n=this.getUIPosition([{el:e[2].el,pos:[e[1].left,e[1].top]}]);this.draw(e[2].el,n)}delete e[0]._jsPlumbDragOptions._dragging;this.removeClass(e[0],"jtk-dragged");this.select({source:e[2].el}).removeClass(this.elementDraggingClass+" "+this.sourceElementDraggingClass,true);this.select({target:e[2].el}).removeClass(this.elementDraggingClass+" "+this.targetElementDraggingClass,true);this.getDragManager().dragEnded(e[2].el)}.bind(this);for(var o=0;o<t.length;o++){i(t[o])}this.setHoverSuspended(false);this.setConnectionBeingDragged(false)};var u=function(e,t){var i=function(i){if(t[i]!=null){if(n.isString(t[i])){var o=t[i].match(/-=/)?-1:1,s=t[i].substring(2);return e[i]+o*s}else{return t[i]}}else{return e[i]}};return[i("left"),i("top")]};var h=function(e,t){if(t==null){return[0,0]}var n=v(t),i=m(n,0);return[i[e+"X"],i[e+"Y"]]},p=h.bind(this,"page"),f=h.bind(this,"screen"),d=h.bind(this,"client"),m=function(e,t){return e.item?e.item(t):e[t]},v=function(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]};var y=function(e){var t={},n=[],i={},o={},s={};this.register=function(r){var a=e.getId(r),l;if(!t[a]){t[a]=r;n.push(r);i[a]={}}var c=function(t){if(t){for(var n=0;n<t.childNodes.length;n++){if(t.childNodes[n].nodeType!==3&&t.childNodes[n].nodeType!==8){var u=jsPlumb.getElement(t.childNodes[n]),h=e.getId(t.childNodes[n],null,true);if(h&&o[h]&&o[h]>0){if(!l){l=e.getOffset(r)}var p=e.getOffset(u);i[a][h]={id:h,offset:{left:p.left-l.left,top:p.top-l.top}};s[h]=a}c(t.childNodes[n])}}}};c(r)};this.updateOffsets=function(t,n){if(t!=null){n=n||{};var o=jsPlumb.getElement(t),r=e.getId(o),a=i[r],l;if(a){for(var c in a){if(a.hasOwnProperty(c)){var u=jsPlumb.getElement(c),h=n[c]||e.getOffset(u);if(u.offsetParent==null&&i[r][c]!=null){continue}if(!l){l=e.getOffset(o)}i[r][c]={id:c,offset:{left:h.left-l.left,top:h.top-l.top}};s[c]=r}}}}};this.endpointAdded=function(n,r){r=r||e.getId(n);var a=document.body,l=n.parentNode;o[r]=o[r]?o[r]+1:1;while(l!=null&&l!==a){var c=e.getId(l,null,true);if(c&&t[c]){var u=e.getOffset(l);if(i[c][r]==null){var h=e.getOffset(n);i[c][r]={id:r,offset:{left:h.left-u.left,top:h.top-u.top}};s[r]=c}break}l=l.parentNode}};this.endpointDeleted=function(e){if(o[e.elementId]){o[e.elementId]--;if(o[e.elementId]<=0){for(var t in i){if(i.hasOwnProperty(t)&&i[t]){delete i[t][e.elementId];delete s[e.elementId]}}}}};this.changeId=function(e,t){i[t]=i[e];i[e]={};s[t]=s[e];s[e]=null};this.getElementsForDraggable=function(e){return i[e]};this.elementRemoved=function(e){var t=s[e];if(t){delete i[t][e];delete s[e]}};this.reset=function(){t={};n=[];i={};o={}};this.dragEnded=function(t){if(t.offsetParent!=null){var n=e.getId(t),i=s[n];if(i){this.updateOffsets(i)}}};this.setParent=function(t,n,o,r,a){var l=s[n];if(!i[r]){i[r]={}}var c=e.getOffset(o),u=a||e.getOffset(t);if(l&&i[l]){delete i[l][n]}i[r][n]={id:n,offset:{left:u.left-c.left,top:u.top-c.top}};s[n]=r};this.clearParent=function(e,t){var n=s[t];if(n){delete i[n][t];delete s[t]}};this.revalidateParent=function(t,n,i){var o=s[n];if(o){var r={};r[n]=i;this.updateOffsets(o,r);e.revalidate(o)}};this.getDragAncestor=function(t){var n=jsPlumb.getElement(t),i=e.getId(n),o=s[i];if(o){return jsPlumb.getElement(o)}else{return null}}};var g=function(e,t,i){t=n.fastTrim(t);if(typeof e.className.baseVal!=="undefined"){e.className.baseVal=t}else{e.className=t}try{var o=e.classList;if(o!=null){while(o.length>0){o.remove(o.item(0))}for(var s=0;s<i.length;s++){if(i[s]){o.add(i[s])}}}}catch(e){n.log("JSPLUMB: cannot set class list",e)}},b=function(e){return typeof e.className.baseVal==="undefined"?e.className:e.className.baseVal},x=function(e,t,i){t=t==null?[]:n.isArray(t)?t:t.split(/\s+/);i=i==null?[]:n.isArray(i)?i:i.split(/\s+/);var o=b(e),s=o.split(/\s+/);var r=function(e,t){for(var n=0;n<t.length;n++){if(e){if(s.indexOf(t[n])===-1){s.push(t[n])}}else{var i=s.indexOf(t[n]);if(i!==-1){s.splice(i,1)}}}};r(true,t);r(false,i);g(e,s.join(" "),s)};e.jsPlumb.extend(e.jsPlumbInstance.prototype,{headless:false,pageLocation:p,screenLocation:f,clientLocation:d,getDragManager:function(){if(this.dragManager==null){this.dragManager=new y(this)}return this.dragManager},recalculateOffsets:function(e){this.getDragManager().updateOffsets(e)},createElement:function(e,t,n,i){return this.createElementNS(null,e,t,n,i)},createElementNS:function(e,t,n,i,o){var s=e==null?document.createElement(t):document.createElementNS(e,t);var r;n=n||{};for(r in n){s.style[r]=n[r]}if(i){s.className=i}o=o||{};for(r in o){s.setAttribute(r,""+o[r])}return s},getAttribute:function(e,t){return e.getAttribute!=null?e.getAttribute(t):null},setAttribute:function(e,t,n){if(e.setAttribute!=null){e.setAttribute(t,n)}},setAttributes:function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e.setAttribute(n,t[n])}}},appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["svg"]},getClass:b,addClass:function(e,t){jsPlumb.each(e,function(e){x(e,t)})},hasClass:function(e,t){e=jsPlumb.getElement(e);if(e.classList){return e.classList.contains(t)}else{return b(e).indexOf(t)!==-1}},removeClass:function(e,t){jsPlumb.each(e,function(e){x(e,null,t)})},toggleClass:function(e,t){if(jsPlumb.hasClass(e,t)){jsPlumb.removeClass(e,t)}else{jsPlumb.addClass(e,t)}},updateClasses:function(e,t,n){jsPlumb.each(e,function(e){x(e,t,n)})},setClass:function(e,t){if(t!=null){jsPlumb.each(e,function(e){g(e,t,t.split(/\s+/))})}},setPosition:function(e,t){e.style.left=t.left+"px";e.style.top=t.top+"px"},getPosition:function(e){var t=function(t){var n=e.style[t];return n?n.substring(0,n.length-2):0};return{left:t("left"),top:t("top")}},getStyle:function(e,t){if(typeof window.getComputedStyle!=="undefined"){return getComputedStyle(e,null).getPropertyValue(t)}else{return e.currentStyle[t]}},getSelector:function(e,t){var n=null;if(arguments.length===1){n=e.nodeType!=null?e:document.querySelectorAll(e)}else{n=e.querySelectorAll(t)}return n},getOffset:function(e,t,n){e=jsPlumb.getElement(e);n=n||this.getContainer();var i={left:e.offsetLeft,top:e.offsetTop},o=t||n!=null&&(e!==n&&e.offsetParent!==n)?e.offsetParent:null,s=function(e){if(e!=null&&e!==document.body&&(e.scrollTop>0||e.scrollLeft>0)){i.left-=e.scrollLeft;i.top-=e.scrollTop}}.bind(this);while(o!=null){i.left+=o.offsetLeft;i.top+=o.offsetTop;s(o);o=t?o.offsetParent:o.offsetParent===n?null:o.offsetParent}if(n!=null&&!t&&(n.scrollTop>0||n.scrollLeft>0)){var r=e.offsetParent!=null?this.getStyle(e.offsetParent,"position"):"static",a=this.getStyle(e,"position");if(a!=="absolute"&&a!=="fixed"&&r!=="absolute"&&r!=="fixed"){i.left-=n.scrollLeft;i.top-=n.scrollTop}}return i},getPositionOnElement:function(e,t,n){var i=typeof t.getBoundingClientRect!=="undefined"?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},o=document.body,s=document.documentElement,r=window.pageYOffset||s.scrollTop||o.scrollTop,a=window.pageXOffset||s.scrollLeft||o.scrollLeft,l=s.clientTop||o.clientTop||0,c=s.clientLeft||o.clientLeft||0,u=0,h=0,p=i.top+r-l+u*n,f=i.left+a-c+h*n,d=jsPlumb.pageLocation(e),m=i.width||t.offsetWidth*n,v=i.height||t.offsetHeight*n,y=(d[0]-f)/m,g=(d[1]-p)/v;return[y,g]},getAbsolutePosition:function(e){var t=function(t){var n=e.style[t];if(n){return parseFloat(n.substring(0,n.length-2))}};return[t("left"),t("top")]},setAbsolutePosition:function(e,t,n,i){if(n){this.animate(e,{left:"+="+(t[0]-n[0]),top:"+="+(t[1]-n[1])},i)}else{e.style.left=t[0]+"px";e.style.top=t[1]+"px"}},getSize:function(e){return[e.offsetWidth,e.offsetHeight]},getWidth:function(e){return e.offsetWidth},getHeight:function(e){return e.offsetHeight},getRenderMode:function(){return"svg"},draggable:function(e,t){var i;e=n.isArray(e)||e.length!=null&&!n.isString(e)?e:[e];Array.prototype.slice.call(e).forEach(function(e){i=this.info(e);if(i.el){this._initDraggableIfNecessary(i.el,true,t,i.id,true)}}.bind(this));return this},initDraggable:function(e,t,n){r(this,n).draggable(e,t);e._jsPlumbDragOptions=t},destroyDraggable:function(e,t){r(this,t).destroyDraggable(e);delete e._jsPlumbDragOptions},unbindDraggable:function(e,t,n,i){r(this,i).destroyDraggable(e,t,n)},setDraggable:function(e,t){return jsPlumb.each(e,function(e){if(this.isDragSupported(e)){this._draggableStates[this.getAttribute(e,"id")]=t;this.setElementDraggable(e,t)}}.bind(this))},_draggableStates:{},toggleDraggable:function(e){var t;jsPlumb.each(e,function(e){var n=this.getAttribute(e,"id");t=this._draggableStates[n]==null?false:this._draggableStates[n];t=!t;this._draggableStates[n]=t;this.setDraggable(e,t);return t}.bind(this));return t},_initDraggableIfNecessary:function(e,t,i,o,s){if(!jsPlumb.headless){var r=t==null?false:t;if(r){if(jsPlumb.isDragSupported(e,this)){var u=i||this.Defaults.DragOptions;u=jsPlumb.extend({},u);if(!jsPlumb.isAlreadyDraggable(e,this)){var h=jsPlumb.dragEvents.drag,p=jsPlumb.dragEvents.stop,f=jsPlumb.dragEvents.start;this.manage(o,e);u[f]=n.wrap(u[f],a.bind(this));u[h]=n.wrap(u[h],l.bind(this));u[p]=n.wrap(u[p],c.bind(this));var d=this.getId(e);this._draggableStates[d]=true;var m=this._draggableStates[d];u.disabled=m==null?false:!m;this.initDraggable(e,u);this.getDragManager().register(e);if(s){this.fire("elementDraggable",{el:e,options:u})}}else{if(i.force){this.initDraggable(e,u)}}}}}},animationSupported:true,getElement:function(e){if(e==null){return null}e=typeof e==="string"?e:e.length!=null&&e.enctype==null?e[0]:e;return typeof e==="string"?document.getElementById(e):e},removeElement:function(e){r(this).elementRemoved(e);this.getEventManager().remove(e)},doAnimate:function(e,n,i){i=i||{};var o=this.getOffset(e),s=u(o,n),r=s[0]-o.left,a=s[1]-o.top,l=i.duration||250,c=15,h=l/c,p=c/l*r,f=c/l*a,d=0,m=setInterval(function(){t.setPosition(e,{left:o.left+p*(d+1),top:o.top+f*(d+1)});if(i.step!=null){i.step(d,Math.ceil(h))}d++;if(d>=h){window.clearInterval(m);if(i.complete!=null){i.complete()}}},c)},destroyDroppable:function(e,t){r(this,t).destroyDroppable(e)},unbindDroppable:function(e,t,n,i){r(this,i).destroyDroppable(e,t,n)},droppable:function(e,t){e=n.isArray(e)||e.length!=null&&!n.isString(e)?e:[e];var i;t=t||{};t.allowLoopback=false;Array.prototype.slice.call(e).forEach(function(e){i=this.info(e);if(i.el){this.initDroppable(i.el,t)}}.bind(this));return this},initDroppable:function(e,t,n){r(this,n).droppable(e,t)},isAlreadyDraggable:function(e){return e._katavorioDrag!=null},isDragSupported:function(e,t){return true},isDropSupported:function(e,t){return true},isElementDraggable:function(e){e=t.getElement(e);return e._katavorioDrag&&e._katavorioDrag.isEnabled()},getDragObject:function(e){return e[0].drag.getDragElement()},getDragScope:function(e){return e._katavorioDrag&&e._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(e){return e[0].e},getUIPosition:function(e,t){var n=e[0].el;if(n.offsetParent==null){return null}var i=e[0].finalPos||e[0].pos;var o={left:i[0],top:i[1]};if(n._katavorioDrag&&n.offsetParent!==this.getContainer()){var s=this.getOffset(n.offsetParent);o.left+=s.left;o.top+=s.top}return o},setDragFilter:function(e,t,n){if(e._katavorioDrag){e._katavorioDrag.setFilter(t,n)}},setElementDraggable:function(e,n){e=t.getElement(e);if(e._katavorioDrag){e._katavorioDrag.setEnabled(n)}},setDragScope:function(e,t){if(e._katavorioDrag){e._katavorioDrag.k.setDragScope(e,t)}},setDropScope:function(e,t){if(e._katavorioDrop&&e._katavorioDrop.length>0){e._katavorioDrop[0].k.setDropScope(e,t)}},addToPosse:function(e,n){var i=Array.prototype.slice.call(arguments,1);var o=r(this);t.each(e,function(e){e=[t.getElement(e)];e.push.apply(e,i);o.addToPosse.apply(o,e)})},setPosse:function(e,n){var i=Array.prototype.slice.call(arguments,1);var o=r(this);t.each(e,function(e){e=[t.getElement(e)];e.push.apply(e,i);o.setPosse.apply(o,e)})},removeFromPosse:function(e,n){var i=Array.prototype.slice.call(arguments,1);var o=r(this);t.each(e,function(e){e=[t.getElement(e)];e.push.apply(e,i);o.removeFromPosse.apply(o,e)})},removeFromAllPosses:function(e){var n=r(this);t.each(e,function(e){n.removeFromAllPosses(t.getElement(e))})},setPosseState:function(e,n,i){var o=r(this);t.each(e,function(e){o.setPosseState(t.getElement(e),n,i)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(e){if(e._katavorioDrag){e._katavorioDrag.abort()}},addToDragSelection:function(e){r(this).select(e)},removeFromDragSelection:function(e){r(this).deselect(e)},clearDragSelection:function(){r(this).deselectAll()},trigger:function(e,t,n,i){this.getEventManager().trigger(e,t,n,i)},doReset:function(){for(var e in this){if(e.indexOf("_katavorio_")===0){this[e].reset()}}},getEventManager:function(){return s(this)},on:function(e,t,n){this.getEventManager().on.apply(this,arguments);return this},off:function(e,t,n){this.getEventManager().off.apply(this,arguments);return this}});var P=function(e){var t=function(){if(/complete|loaded|interactive/.test(document.readyState)&&typeof document.body!=="undefined"&&document.body!=null){e()}else{setTimeout(t,9)}};t()};P(t.init)}).call(typeof window!=="undefined"?window:commonjsGlobal)});var jsplumb_6=jsplumb.jsPlumb;var JsPlumbUtils=function(){function e(){}return e}();JsPlumbUtils.createInstance=function(e,t){return jsplumb_6.getInstance({ConnectionsDetachable:!t,DragOptions:{cursor:"pointer",zIndex:2e3},ConnectionOverlays:[["Arrow",{location:1,visible:true,width:11,length:11}],["Label",{location:.5,id:"label",cssClass:"connection-label"}]],Container:e})};JsPlumbUtils.createEndpointUuid=function(e,t){return"activity-"+e+"-"+t};JsPlumbUtils.colorEndpoint=function(e){var t="#7da7f2";switch(e){case"Done":case"True":t="#7CFC00";break;case"False":case"Fail":t="#FF4500";break;case"Call":t="#1E90FF";break;case"Other":t="#FFEBCD";break;case"OnOverdue":t="#FFD700";break;case"OnError":t="#B22222";break}return t};JsPlumbUtils.getSourceEndpointOptions=function(e,t,n){var i=JsPlumbUtils.colorEndpoint(t);var o=i;var s=n?"#6faa44":"#999999";return{type:"Dot",anchor:"Continuous",paintStyle:{stroke:o,fill:i,strokeWidth:2},isSource:true,connector:["Flowchart",{stub:[40,60],gap:0,cornerRadius:5,alwaysRespectStubs:true}],connectorStyle:{strokeWidth:2,stroke:s},connectorHoverStyle:{strokeWidth:2,stroke:s},connectorOverlays:[["Label",{location:[3,-1.5],cssClass:"endpointSourceLabel"}]],hoverPaintStyle:{fill:o,stroke:i},dragOptions:{},uuid:JsPlumbUtils.createEndpointUuid(e,t),parameters:{outcome:t},scope:null,reattachConnections:true,maxConnections:1}};var rng;var crypto=typeof commonjsGlobal!=="undefined"&&(commonjsGlobal.crypto||commonjsGlobal.msCrypto);if(crypto&&crypto.getRandomValues){var rnds8=new Uint8Array(16);rng=function e(){crypto.getRandomValues(rnds8);return rnds8}}if(!rng){var rnds=new Array(16);rng=function(){for(var e=0,t;e<16;e++){if((e&3)===0)t=Math.random()*4294967296;rnds[e]=t>>>((e&3)<<3)&255}return rnds}}var rngBrowser=rng;var byteToHex=[];for(var i=0;i<256;++i){byteToHex[i]=(i+256).toString(16).substr(1)}function bytesToUuid(e,t){var n=t||0;var i=byteToHex;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}var bytesToUuid_1=bytesToUuid;function v4(e,t,n){var i=t&&n||0;if(typeof e=="string"){t=e=="binary"?new Array(16):null;e=null}e=e||{};var o=e.random||(e.rng||rngBrowser)();o[6]=o[6]&15|64;o[8]=o[8]&63|128;if(t){for(var s=0;s<16;++s){t[i+s]=o[s]}}return t||bytesToUuid_1(o)}var v4_1=v4;function deepClone(e){var t=JSON.stringify(e);return JSON.parse(t)}var Designer=function(){function e(t){var n=this;registerInstance(this,t);this.activityDefinitions=[];this.workflow={activities:[],connections:[]};this.lastClickedLocation=null;this.elem=function(){return n.el};this.renderContextMenu=function(){if(n.readonly)return null;return[h("wf-context-menu",{target:n.elem()},h("wf-context-menu-item",{text:"Add",onClick:n.onAddActivityClick})),h("wf-context-menu",{ref:function(e){return n.activityContextMenu=e}},h("wf-context-menu-item",{text:"Edit",onClick:n.onEditActivityClick}),h("wf-context-menu-item",{text:"Delete",onClick:n.onDeleteActivityClick}))]};this.deleteActivity=function(e){return __awaiter(n,void 0,void 0,function(){var t,n;return __generator(this,function(i){t=this.workflow.activities.filter(function(t){return t.id!==e.id});n=this.workflow.connections.filter(function(t){return t.sourceActivityId!=e.id&&t.destinationActivityId!=e.id});this.workflow=Object.assign({},this.workflow,{activities:t,connections:n});return[2]})})};this.setupJsPlumb=function(){n.jsPlumb.reset();n.setupJsPlumbEventHandlers();n.jsPlumb.batch(function(){n.getActivityElements().forEach(n.setupActivityElement);n.setupConnections()});n.jsPlumb.repaintEverything()};this.setupPopovers=function(){$('[data-toggle="popover"]').popover({})};this.setupActivityElement=function(e){if(!n.readonly){n.setupDragDrop(e)}n.setupTargets(e);n.setupOutcomes(e);n.jsPlumb.revalidate(e)};this.setupDragDrop=function(e){var t=null;var i=false;n.jsPlumb.draggable(e,{containment:"true",start:function(e){t={left:e.e.screenX,top:e.e.screenY}},stop:function(o){return __awaiter(n,void 0,void 0,function(){var n;return __generator(this,function(s){switch(s.label){case 0:i=t.left!==o.e.screenX||t.top!==o.e.screenY;if(!i)return[2];n=Object.assign({},this.findActivityByElement(e));n.left=o.pos[0];n.top=o.pos[1];return[4,this.updateActivityInternal(n)];case 1:s.sent();return[2]}})})}})};this.setupConnections=function(){for(var e=0,t=n.workflow.connections;e<t.length;e++){var i=t[e];var o=JsPlumbUtils.createEndpointUuid(i.sourceActivityId,i.outcome);var s=n.jsPlumb.getEndpoint(o);var r="wf-activity-"+i.destinationActivityId;n.jsPlumb.connect({source:s,target:r})}};this.findActivityByElement=function(t){var i=e.getActivityId(t);return n.findActivityById(i)};this.findActivityById=function(e){return n.workflow.activities.find(function(t){return t.id===e})};this.updateActivityInternal=function(e){return __awaiter(n,void 0,void 0,function(){var t,n;return __generator(this,function(i){t=this.workflow.activities.slice();n=t.findIndex(function(t){return t.id==e.id});t[n]=Object.assign({},e);this.workflow=Object.assign({},this.workflow,{activities:t});return[2]})})};this.setupJsPlumbEventHandlers=function(){n.jsPlumb.bind("connection",n.connectionCreated);n.jsPlumb.bind("connectionDetached",n.connectionDetached)};this.connectionCreated=function(e){return __awaiter(n,void 0,void 0,function(){var t,n,i,o,s,r,a,l;return __generator(this,function(c){t=e.connection;n=e.sourceEndpoint;i=n.getParameter("outcome");o=t.getOverlay("label");o.setLabel(i);s=this.findActivityByElement(e.source);r=this.findActivityByElement(e.target);a=this.workflow.connections.find(function(e){return e.sourceActivityId===s.id&&e.destinationActivityId==r.id});if(!a){l=this.workflow.connections.concat([{sourceActivityId:s.id,destinationActivityId:r.id,outcome:i}]);this.workflow=Object.assign({},this.workflow,{connections:l})}return[2]})})};this.connectionDetached=function(e){return __awaiter(n,void 0,void 0,function(){var t,n,i,o,s;return __generator(this,function(r){t=e.sourceEndpoint;n=t.getParameter("outcome");i=this.findActivityByElement(e.source);o=this.findActivityByElement(e.target);s=this.workflow.connections.filter(function(e){return!(e.sourceActivityId===i.id&&e.destinationActivityId===o.id&&e.outcome===n)});this.workflow=Object.assign({},this.workflow,{connections:s});return[2]})})};this.onAddActivityClick=function(e){var t=n.elem();n.lastClickedLocation={left:e.pageX-t.offsetLeft,top:e.pageY-t.offsetTop};n.addActivityEvent.emit()};this.onDeleteActivityClick=function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.deleteActivity(this.selectedActivity)];case 1:e.sent();return[2]}})})};this.onEditActivityClick=function(){n.onEditActivity(n.selectedActivity)};this.editActivityEvent=createEvent(this,"edit-activity",7);this.addActivityEvent=createEvent(this,"add-activity",7);this.workflowChanged=createEvent(this,"workflowChanged",7)}e.prototype.onWorkflowChanged=function(e){this.workflowChanged.emit(deepClone(e))};e.prototype.newWorkflow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){this.workflow={activities:[],connections:[]};return[2]})})};e.prototype.getWorkflow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,deepClone(this.workflow)]})})};e.prototype.addActivity=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,i,o;return __generator(this,function(s){t=!!this.lastClickedLocation?this.lastClickedLocation.left:150;n=!!this.lastClickedLocation?this.lastClickedLocation.top:150;i={id:v4_1(),top:n,left:t,type:e.type,state:{}};this.lastClickedLocation=null;o=this.workflow.activities.concat([i]);this.workflow=Object.assign({},this.workflow,{activities:o});return[2]})})};e.prototype.updateActivity=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.updateActivityInternal(e)];case 1:t.sent();return[2]}})})};e.prototype.componentWillLoad=function(){this.jsPlumb=JsPlumbUtils.createInstance(".workflow-canvas",this.readonly)};e.prototype.componentDidRender=function(){this.setupJsPlumb();this.setupPopovers()};e.prototype.render=function(){var e=this;var t=this.createActivityModels();return h("host",{class:"workflow-canvas",ref:function(t){return e.canvas=t},style:{height:this.canvasHeight}},t.map(function(t){var n=t.activity;var i={left:n.left+"px",top:n.top+"px"};var o={activity:true,"activity-blocking":!!n.blocking,"activity-executed":!!n.executed,"activity-faulted":n.faulted};if(!e.readonly){return h("div",{id:"wf-activity-"+n.id,"data-activity-id":n.id,class:o,style:i,onDblClick:function(){return e.onEditActivity(n)},onContextMenu:function(t){return e.onActivityContextMenu(t,n)}},h("wf-activity-renderer",{activity:n,activityDefinition:t.definition,displayMode:ActivityDisplayMode.Design}))}else{o["noselect"]=true;var s={};if(!!n.message){s["data-toggle"]="popover";s["data-trigger"]="hover";s["title"]=n.message.title;s["data-content"]=n.message.content}return h("div",Object.assign({id:"wf-activity-"+n.id,"data-activity-id":n.id,class:o,style:i},s),h("wf-activity-renderer",{activity:n,activityDefinition:t.definition,displayMode:ActivityDisplayMode.Design}))}}),this.renderContextMenu())};e.prototype.createActivityModels=function(){var e=this.workflow||{activities:[],connections:[]};var t=this.activityDefinitions||[];return e.activities.map(function(e){var n=t.find(function(t){return t.type==e.type});return{activity:e,definition:n}})};e.prototype.setupTargets=function(e){this.jsPlumb.makeTarget(e,{dropOptions:{hoverClass:"hover"},anchor:"Continuous",endpoint:["Blank",{radius:4}]})};e.prototype.setupOutcomes=function(e){var t=this.findActivityByElement(e);var n=this.activityDefinitions.find(function(e){return e.type==t.type});var i=ActivityManager$1.getOutcomes(t,n);var o=t.executed;for(var s=0,r=i;s<r.length;s++){var a=r[s];var l=JsPlumbUtils.getSourceEndpointOptions(t.id,a,o);var c={connectorOverlays:[["Label",{label:a,cssClass:"connection-label"}]]};this.jsPlumb.addEndpoint(e,c,l)}};e.prototype.getActivityElements=function(){return this.elem().querySelectorAll(".activity")};e.getActivityId=function(e){return e.attributes["data-activity-id"].value};e.prototype.onEditActivity=function(e){var t=deepClone(e);this.editActivityEvent.emit(t)};e.prototype.onActivityContextMenu=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:this.selectedActivity=t;return[4,this.activityContextMenu.handleContextMenuEvent(e)];case 1:n.sent();return[2]}})})};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{workflow:["onWorkflowChanged"]}},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".jtk-group,.jtk-node{position:absolute}.jtk-group{overflow:visible}[jtk-group-content]{position:relative}.katavorio-clone-drag{pointer-events:none}.jtk-surface{overflow:hidden!important;position:relative;cursor:move;cursor:-moz-grab;cursor:-webkit-grab;-ms-touch-action:none;touch-action:none}.jtk-surface-panning{cursor:-moz-grabbing;cursor:-webkit-grabbing;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jtk-surface-canvas{overflow:visible!important}.jtk-surface-droppable-node{-ms-touch-action:none;touch-action:none}.jtk-surface-nopan{overflow:scroll!important;cursor:default}.jtk-surface-tile{border:none;outline:none;margin:0;-webkit-transition:opacity .3s ease .15s;-moz-transition:opacity .3s ease .15s;-o-transition:opacity .3s ease .15s;-ms-transition:opacity .3s ease .15s;transition:opacity .3s ease .15s}.jtk-lasso{border:2px solid #3177b8;background-color:#f5f5f5;opacity:.5;display:none;z-index:20000;position:absolute}.jtk-lasso-select-defeat *{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jtk-lasso-mask{position:fixed;z-index:20000;display:none;opacity:.5;background-color:#07234e;top:0;bottom:0;left:0;right:0}.jtk-surface-selected-element{border:2px dashed #f76258!important}.jtk-surface-pan{background-color:azure;opacity:.4;text-align:center;cursor:pointer;z-index:2;-webkit-transition:background-color .15s ease-in;-moz-transition:background-color .15s ease-in;-o-transition:background-color .15s ease-in;transition:background-color .15s ease-in}.jtk-surface-pan-bottom,.jtk-surface-pan-top{width:100%;height:20px}.jtk-surface-pan-bottom:hover,.jtk-surface-pan-left:hover,.jtk-surface-pan-right:hover,.jtk-surface-pan-top:hover{opacity:.6;background-color:#3177b8;color:#fff;font-weight:700}.jtk-surface-pan-left,.jtk-surface-pan-right{width:20px;height:100%;line-height:40}.jtk-surface-pan-active,.jtk-surface-pan-active:hover{background-color:#f76258}.jtk-miniview{overflow:hidden!important;width:125px;height:125px;position:relative;background-color:#b2c9cd;border:1px solid #e2e6cd;border-radius:4px;opacity:.8}.jtk-miniview-panner{border:5px dotted #f5f5f5;opacity:.4;background-color:#4f6f7e;cursor:move;cursor:-moz-grab;cursor:-webkit-grab}.jtk-miniview-panning{cursor:-moz-grabbing;cursor:-webkit-grabbing}.jtk-miniview-element{background-color:#607a86;position:absolute}.jtk-miniview-group-element{background:transparent;border:2px solid #607a86}.jtk-miniview-collapse{color:#f5f5f5;position:absolute;font-size:18px;top:-1px;right:3px;cursor:pointer;font-weight:700}.jtk-miniview-collapse:before{content:\"\\2012\"}.jtk-miniview-collapsed{background-color:#449ea6;border-radius:4px;height:22px;margin-right:0;padding:4px;width:21px}.jtk-miniview-collapsed .jtk-miniview-element,.jtk-miniview-collapsed .jtk-miniview-panner{visibility:hidden}.jtk-miniview-collapsed .jtk-miniview-collapse:before{content:\"+\"}.jtk-miniview-collapse:hover{color:#e4f013}.jtk-dialog-underlay{left:0;right:0;top:0;bottom:0;position:fixed;z-index:100000;opacity:.8;background-color:#ccc;display:none}.jtk-dialog-overlay{position:fixed;z-index:100001;display:none;background-color:#fff;font-family:Open Sans,sans-serif;padding:7px;-webkit-box-shadow:0 0 5px grey;box-shadow:0 0 5px grey;overflow:hidden}.jtk-dialog-overlay-x{max-height:0;transition:max-height .5s ease-in;-moz-transition:max-height .5s ease-in;-ms-transition:max-height .5s ease-in;-o-transition:max-height .5s ease-in;-webkit-transition:max-height .5s ease-in}.jtk-dialog-overlay-y{max-width:0;transition:max-width .5s ease-in;-moz-transition:max-width .5s ease-in;-ms-transition:max-width .5s ease-in;-o-transition:max-width .5s ease-in;-webkit-transition:max-width .5s ease-in}.jtk-dialog-overlay-top{top:20px}.jtk-dialog-overlay-bottom{bottom:20px}.jtk-dialog-overlay-left{left:20px}.jtk-dialog-overlay-right{right:20px}.jtk-dialog-overlay-x.jtk-dialog-overlay-visible{max-height:1000px}.jtk-dialog-overlay-y.jtk-dialog-overlay-visible{max-width:1000px}.jtk-dialog-buttons{text-align:right;margin-top:5px}.jtk-dialog-button{border:none;cursor:pointer;margin-right:5px;min-width:56px;background-color:#fff;outline:1px solid #ccc}.jtk-dialog-button:hover{color:#fff;background-color:#234b5e}.jtk-dialog-title{text-align:left;font-size:14px;margin-bottom:9px}.jtk-dialog-content{font-size:12px;text-align:left;min-width:250px;margin:0 14px}.jtk-dialog-content ul{width:100%;padding-left:0}.jtk-dialog-content label{cursor:pointer;font-weight:inherit}.jtk-dialog-overlay input,.jtk-dialog-overlay textarea{background-color:#fff;border:1px solid #ccc;color:#333;font-size:14px;font-style:normal;outline:none;padding:6px 4px;margin-right:6px}.jtk-dialog-overlay input:focus,.jtk-dialog-overlay textarea:focus{background-color:#cbeae1;border:1px solid #83b8a8;color:#333;font-size:14px;font-style:normal;outline:none}.jtk-draw-skeleton{position:absolute;left:0;right:0;top:0;bottom:0;outline:2px solid #84acb3;opacity:.8}.jtk-draw-handle{position:absolute;width:7px;height:7px;background-color:#84acb3}.jtk-draw-handle-tl{left:0;top:0;cursor:nw-resize}.jtk-draw-handle-tr{right:0;top:0;cursor:ne-resize}.jtk-draw-handle-bl{left:0;bottom:0;cursor:sw-resize}.jtk-draw-handle-br{bottom:0;right:0;cursor:se-resize}.jtk-draw-drag{display:none;position:absolute;left:50%;top:50%;margin-left:-10px;margin-top:-10px;width:20px;height:20px;background-color:#84acb3;cursor:move}.jtk-drag-select-defeat *{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.workflow-canvas{position:relative;display:block;-ms-touch-action:none;touch-action:none;width:auto;height:100vh}.workflow-canvas .noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.workflow-canvas .activity{display:block;border:1px solid #ccc;-webkit-box-shadow:2px 2px 19px #aaa;box-shadow:2px 2px 19px #aaa;border-radius:.5em;opacity:.8;min-width:80px;min-height:80px;max-width:250px;text-align:left;z-index:20;position:absolute;background-color:#f1f1f1;color:#3d3d3d;font-family:helvetica,sans-serif;padding:1em;font-size:.7em;cursor:default;-webkit-transition:-webkit-box-shadow .15s ease-in;transition:-webkit-box-shadow .15s ease-in;transition:box-shadow .15s ease-in;transition:box-shadow .15s ease-in,-webkit-box-shadow .15s ease-in}.workflow-canvas .activity .activity-status{position:absolute;right:4px;bottom:4px;cursor:pointer}.workflow-canvas .activity .activity-status i{font-size:2em}.workflow-canvas .activity.activity-definition{border:1px solid #5a8fee}.workflow-canvas .activity.activity-executed{border:1px solid #6faa44;background-color:#6faa44;color:#fff}.workflow-canvas .activity.activity-executed h5,.workflow-canvas .activity.activity-executed h5 i{color:#fff}.workflow-canvas .activity.activity-blocking{border:1px solid #5a8fee;background-color:#5a8fee;color:#fff}.workflow-canvas .activity.activity-blocking h5,.workflow-canvas .activity.activity-blocking h5 i{color:#fff}.workflow-canvas .activity.activity-faulted{border:1px solid #d23c3c;background-color:#d23c3c;color:#fff}.workflow-canvas .activity.activity-faulted h5,.workflow-canvas .activity.activity-faulted h5 i{color:#fff}.jtk-connector{z-index:4}.endpointSourceLabel,.endpointTargetLabel,.jtk-endpoint{z-index:21;cursor:pointer}.endpointSourceLabel,.endpointTargetLabel{font-size:8px}.jtk-overlay{background-color:transparent}.connection-label{z-index:31;border:1px solid #ccc;padding:0 .5em;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;background-color:#fff}"},enumerable:true,configurable:true});return e}();exports("wf_designer",Designer);var dragscroll=createCommonjsModule(function(e,t){!function(e,n){n(t)}(commonjsGlobal,function(e){var t,n,i=window,o=document,s="mousemove",r="mouseup",a="mousedown",l="EventListener",c="add"+l,u="remove"+l,h=[],p=function(e,l){for(e=0;e<h.length;)l=h[e++],l=l.container||l,l[u](a,l.md,0),i[u](r,l.mu,0),i[u](s,l.mm,0);for(h=[].slice.call(o.getElementsByClassName("dragscroll")),e=0;e<h.length;)!function(e,l,u,h,p,f){(f=e.container||e)[c](a,f.md=function(t){e.hasAttribute("nochilddrag")&&o.elementFromPoint(t.pageX,t.pageY)!=f||(h=1,l=t.clientX,u=t.clientY,t.preventDefault())},0),i[c](r,f.mu=function(){h=0},0),i[c](s,f.mm=function(i){h&&((p=e.scroller||e).scrollLeft-=t=-l+(l=i.clientX),p.scrollTop-=n=-u+(u=i.clientY),e==o.body&&((p=o.documentElement).scrollLeft-=t,p.scrollTop-=n))},0)}(h[e++])};"complete"==o.readyState?p():i[c]("load",p,0),e.reset=p})});var BooleanFieldDriver=function(){function e(){this.displayEditor=function(e,t){var n=t.name;var i=t.label;var o=e.state[n]==="true";return'<wf-boolean-field name="'+n+'" label="'+i+'" hint="'+t.hint+'" checked="'+o+'"></wf-boolean-field>'};this.updateEditor=function(e,t,n){e.state[t.name]=n.get(t.name)}}return e}();var ExpressionFieldDriver=function(){function e(){this.displayEditor=function(e,t){var n=t.name;var i=t.label;var o=e.state[n]||{expression:"",syntax:"Eval"};var s=(t.options||{}).multiline||false;var r=o.expression.replace(/"/g,"&quot;");return'<wf-expression-field name="'+n+'" label="'+i+'" hint="'+t.hint+'" value="'+r+'" syntax="'+o.syntax+'" multiline="'+s+'"></wf-expression-field>'};this.updateEditor=function(e,t,n){var i=t.name+".expression";var o=t.name+".syntax";var s=n.get(i).toString().trim();var r=n.get(o).toString();e.state[t.name]={expression:s,syntax:r}}}return e}();var ListFieldDriver=function(){function e(){this.displayEditor=function(e,t){var n=t.name;var i=t.label;var o=e.state[n]||[];var s=o.join(", ");return'<wf-list-field name="'+n+'" label="'+i+'" hint="'+t.hint+'" items="'+s+'"></wf-list-field>'};this.updateEditor=function(e,t,n){var i=n.get(t.name).toString();e.state[t.name]=i.split(",").map(function(e){return e.trim()})}}return e}();var TextFieldDriver=function(){function e(){this.displayEditor=function(e,t){var n=t.name;var i=t.label;var o=e.state[n]||"";return'<wf-text-field name="'+n+'" label="'+i+'" hint="'+t.hint+'" value="'+o+'"></wf-text-field>'};this.updateEditor=function(e,t,n){e.state[t.name]=n.get(t.name).toString().trim()}}return e}();var SelectFieldDriver=function(){function e(){this.displayEditor=function(e,t){var n=t.name;var i=t.label;var o=e.state[n]||"";var s=t.options.items||[];var r=encodeURI(JSON.stringify(s));return'<wf-select-field name="'+n+'" label="'+i+'" hint="'+t.hint+'" data-items="'+r+'" value="'+o+'"></wf-select-field>'};this.updateEditor=function(e,t,n){var i=n.get(t.name).toString();e.state[t.name]=i.trim()}}return e}();var WorkflowPluginStore=function(){function e(){var e=this;this.plugins=[];this.add=function(t){e.plugins=e.plugins.concat([t])};this.list=function(){return e.plugins.slice()}}return e}();var pluginStore=new WorkflowPluginStore;var win=window;var elsa=win.elsa||{};elsa.pluginStore=pluginStore;win.elsa=elsa;var OutcomeNames;(function(e){e["Done"]="Done";e["True"]="True";e["False"]="False";e["Fail"]="Fail";e["Call"]="Call";e["Other"]="Other";e["OnOverdue"]="OnOverdue";e["OnError"]="OnError"})(OutcomeNames||(OutcomeNames={}));var ConsoleActivities=function(){function e(){var t=this;this.getName=function(){return"ConsoleActivities"};this.getActivityDefinitions=function(){return[t.readLine(),t.writeLine()]};this.readLine=function(){return{type:"ReadLine",displayName:"Read Line",description:"Read text from standard in.",runtimeDescription:"a => !!a.state.variableName ? `Read text from standard in and store into <strong>${ a.state.variableName }</strong>.` : 'Read text from standard in.'",outcomes:[OutcomeNames.Done],category:e.Category,icon:"fas fa-terminal",properties:[{name:"variableName",type:"text",label:"Variable Name",hint:"The name of the variable to store the value into."}]}};this.writeLine=function(){return{type:"WriteLine",displayName:"Write Line",description:"Write text to standard out.",category:e.Category,icon:"fas fa-terminal",runtimeDescription:"x => !!x.state.textExpression ? `Write <strong>${ x.state.textExpression.expression }</strong> to standard out.` : x.definition.description",outcomes:[OutcomeNames.Done],properties:[{name:"textExpression",type:"expression",label:"Text",hint:"The text to write."}]}}}return e}();ConsoleActivities.Category="Console";pluginStore.add(new ConsoleActivities);var ControlFlowActivities=function(){function e(){var t=this;this.getName=function(){return"ControlFlowActivities"};this.getActivityDefinitions=function(){return[t.fork(),t.ifElse(),t.join(),t.switch()]};this.fork=function(){return{type:"Fork",displayName:"Fork",description:"Fork workflow execution into multiple branches.",category:e.Category,icon:"fas fa-code-branch fa-rotate-180",outcomes:"x => x.state.branches",properties:[{name:"branches",type:"slist",label:"Branches",hint:"Enter one or more names representing branches, separated with a space. Example: main overflow other"}]}};this.ifElse=function(){return{type:"IfElse",displayName:"If/Else",description:"Evaluate a Boolean expression and continue execution depending on the result.",category:e.Category,runtimeDescription:"x => !!x.state.expression ? `Evaluate <strong>${ x.state.expression.expression }</strong> and continue execution depending on the result.` : x.definition.description",outcomes:[OutcomeNames.True,OutcomeNames.False],properties:[{name:"expression",type:"expression",label:"Expression",hint:"The expression to evaluate. The evaluated value will be used to switch on."}]}};this.join=function(){return{type:"Join",displayName:"Join",description:"Merge workflow execution back into a single branch.",category:e.Category,icon:"fas fa-code-branch",runtimeDescription:"x => !!x.state.joinMode ? `Merge workflow execution back into a single branch using mode <strong>${ x.state.joinMode }</strong>` : x.definition.description",outcomes:[OutcomeNames.Done],properties:[{name:"joinMode",type:"text",label:"Join Mode",hint:"Either 'WaitAll' or 'WaitAny'"}]}};this.switch=function(){return{type:"Switch",displayName:"Switch",description:"Switch execution based on a given expression.",category:e.Category,icon:"far fa-list-alt",runtimeDescription:"x => !!x.state.expression ? `Switch execution based on <strong>${ x.state.expression.expression }</strong>.` : x.definition.description",outcomes:"x => x.state.cases.map(c => c.toString())",properties:[{name:"expression",type:"expression",label:"Expression",hint:"The expression to evaluate. The evaluated value will be used to switch on."},{name:"cases",type:"list",label:"Cases",hint:"A comma-separated list of possible outcomes of the expression."}]}}}return e}();ControlFlowActivities.Category="Control Flow";pluginStore.add(new ControlFlowActivities);var EmailActivities=function(){function e(){var t=this;this.getName=function(){return"EmailActivities"};this.getActivityDefinitions=function(){return[t.sendEmail()]};this.sendEmail=function(){return{type:"SendEmail",displayName:"Send Email",description:"Send an email message.",category:e.Category,icon:"far fa-envelope",outcomes:[OutcomeNames.Done],properties:[{name:"from",type:"expression",label:"From",hint:"The sender's email address"},{name:"to",type:"expression",label:"To",hint:"The recipient's email address"},{name:"subject",type:"expression",label:"Subject",hint:"The subject of the email message."},{name:"body",type:"expression",label:"Body",hint:"The body of the email message.",options:{multiline:true}}]}}}return e}();EmailActivities.Category="Email";pluginStore.add(new EmailActivities);var HttpActivities=function(){function e(){var t=this;this.getName=function(){return"HttpActivities"};this.getActivityDefinitions=function(){return[t.sendHttpRequest(),t.sendHttpResponse(),t.handleHttpRequest()]};this.sendHttpRequest=function(){return{type:"HttpRequestAction",displayName:"Send HTTP Request",description:"Send an HTTP request.",category:e.Category,icon:"fas fa-cloud",properties:[{name:"url",type:"text",label:"URL",hint:"The URL to send the HTTP request to."},{name:"method",type:"select",label:"Method",hint:"The HTTP method to use when making the request.",options:{items:["GET","POST","PUT","DELETE","OPTIONS","HEAD"]}},{name:"content",type:"expression",label:"Content",hint:"The HTTP content to send along with the request."},{name:"statusCodes",type:"list",label:"Status Codes",hint:"A list of possible HTTP status codes to handle, comma-separated. Example: 200, 400, 404"}],outcomes:"x => !!x.state.statusCodes ? x.state.statusCodes : []"}};this.handleHttpRequest=function(){return{type:"HttpRequestEvent",displayName:"Handle HTTP Request",description:"Handle an incoming HTTP request.",category:e.Category,icon:"fas fa-cloud",properties:[{name:"path",type:"text",label:"Path",hint:"The relative path that triggers this activity."},{name:"method",type:"select",label:"Method",hint:"The HTTP method that triggers this activity.",options:{items:["GET","POST","PUT","DELETE","OPTIONS","HEAD"]}},{name:"readContent",type:"boolean",label:"Read Content",hint:"Check if the HTTP request content body should be read and stored as part of the HTTP request model. The stored format depends on the content-type header."}],runtimeDescription:"x => !!x.state.path ? `Handle <strong>${ x.state.method } ${ x.state.path }</strong>.` : x.definition.description",outcomes:[OutcomeNames.Done]}};this.sendHttpResponse=function(){return{type:"HttpResponseAction",displayName:"Send HTTP Response",description:"Send an HTTP response.",category:e.Category,icon:"fas fa-cloud",properties:[{name:"statusCode",type:"select",label:"Status Code",hint:"The HTTP status code to write.",options:{items:[{label:"2xx",options:[200,201,202,203,204]},{label:"3xx",options:[301,302,304,307,308]},{label:"4xx",options:[400,401,402,403,404,405,409,410,412,413,415,417,418,420,428,429]}]}},{name:"content",type:"expression",label:"Content",hint:"The HTTP content to write.",options:{multiline:true}},{name:"contentType",type:"select",label:"Content Type",hint:"The HTTP content type header to write.",options:{items:["text/plain","text/html","application/json","application/xml"]}},{name:"responseHeaders",type:"expression",label:"Response Headers",hint:"The headers to send along with the response. One 'header: value' pair per line.",options:{multiline:true}}],runtimeDescription:"x => !!x.state.statusCode ? `Send an HTTP <strong>${ x.state.statusCode }</strong><br/><br/> ${ x.state.contentType }</strong><br/>${ !!x.state.content ? x.state.content.expression ? x.state.content.expression.substr(0,100) + '...' : '' : '' }` : x.definition.description",outcomes:[OutcomeNames.Done]}}}return e}();HttpActivities.Category="HTTP";pluginStore.add(new HttpActivities);var MassTransitActivities=function(){function e(){var t=this;this.getName=function(){return"MassTransitActivities"};this.getActivityDefinitions=function(){return[t.receiveMassTransitMessage(),t.sendMassTransitMessage()]};this.receiveMassTransitMessage=function(){return{type:"ReceiveMassTransitMessage",displayName:"Receive MassTransit Message",description:"Receive a message via MassTransit.",category:e.Category,icon:"fas fa-envelope-open-text",properties:[{name:"messageType",type:"text",label:"Message Type",hint:"The assembly-qualified type name of the message to receive."}],outcomes:[OutcomeNames.Done]}};this.sendMassTransitMessage=function(){return{type:"SendMassTransitMessage",displayName:"Send MassTransit Message",description:"Send a message via MassTransit.",category:e.Category,icon:"fas fa-envelope",properties:[{name:"messageType",type:"text",label:"Message Type",hint:"The assembly-qualified type name of the message to send."},{name:"message",type:"expression",label:"Message",hint:"An expression that evaluates to the message to send."}],outcomes:[OutcomeNames.Done]}}}return e}();MassTransitActivities.Category="MassTransit";pluginStore.add(new MassTransitActivities);var PrimitiveActivities=function(){function e(){var t=this;this.getName=function(){return"PrimitiveActivities"};this.getActivityDefinitions=function(){return[t.log(),t.setVariable()]};this.log=function(){return{type:"Log",displayName:"Log",description:"Log a message.",category:e.Category,icon:"fas fa-feather-alt",properties:[{name:"message",type:"text",label:"Message",hint:"The text to log."},{name:"logLevel",type:"text",label:"Log Level",hint:"The log level to use."}],runtimeDescription:"x => !!x.state.message ? `Log <strong>${x.state.logLevel}: ${x.state.message}</strong>` : x.definition.description",outcomes:[OutcomeNames.Done]}};this.setVariable=function(){return{type:"SetVariable",displayName:"Set Variable",description:"Set a variable on the workflow.",category:e.Category,properties:[{name:"variableName",type:"text",label:"Variable Name",hint:"The name of the variable to store the value into."},{name:"expression",type:"expression",label:"Variable Expression",hint:"An expression that evaluates to the value to store in the variable."}],runtimeDescription:"x => !!x.state.variableName ? `${x.state.expression.syntax}: <strong>${x.state.variableName}</strong> = <strong>${x.state.expression.expression}</strong>` : x.definition.description",outcomes:[OutcomeNames.Done]}}}return e}();PrimitiveActivities.Category="Primitives";pluginStore.add(new PrimitiveActivities);var TimerActivities=function(){function e(){var t=this;this.getName=function(){return"TimerActivities"};this.getActivityDefinitions=function(){return[t.timerEvent()]};this.timerEvent=function(){return{type:"TimerEvent",displayName:"Timer Event",description:"Triggers after a specified amount of time.",category:e.Category,icon:"fas fa-hourglass-start",properties:[{name:"expression",type:"expression",label:"Timeout Expression",hint:"The amount of time to wait before this timer event is triggered. Format: 'd.HH:mm:ss'."},{name:"name",type:"text",label:"Name",hint:"Optionally provide a name for this activity. You can reference named activities from expressions."},{name:"title",type:"text",label:"Title",hint:"Optionally provide a custom title for this activity."},{name:"description",type:"text",label:"Description",hint:"Optionally provide a custom description for this activity."}],runtimeDescription:"x => !!x.state.expression ? `Triggers after <strong>${ x.state.expression.expression }</strong>` : x.definition.description",outcomes:[OutcomeNames.Done]}}}return e}();TimerActivities.Category="Timers";pluginStore.add(new TimerActivities);var TaskActivities=function(){function e(){var e=this;this.getName=function(){return"TaskActivities"};this.getActivityDefinitions=function(){return[e.noop(),e.addressgeocode(),e.addressvalidate(),e.arrayappend(),e.arrayeach(),e.arraypop(),e.arraypush(),e.arrayshift(),e.arrayunshift(),e.arrayuse(),e.sendemail(),e.sendqm(),e.sendsms(),e.doclistadd(),e.doclistclear(),e.doclistdelete(),e.doclisteach(),e.doclistobj(),e.doclistremove(),e.docadd(),e.docclear(),e.doccopy(),e.docdelete(),e.docremove(),e.docrename(),e.docsave(),e.mergedoc(),e.python(),e.sendtweet(),e.call(),e.end(),e.switch(),e.objlist(),e.objlistadd(),e.objlistclear(),e.objlistdelete(),e.objlisteach(),e.objlistpick(),e.objlistremove(),e.objadd(),e.objaddlink(),e.objaddparent(),e.objalias(),e.objapply(),e.objcopy(),e.objcreate(),e.objdelete(),e.objdoccopy(),e.objdoclist(),e.objeach(),e.objlu(),e.objorganizer(),e.objpick(),e.objremove(),e.objsave(),e.objset(),e.objtouch(),e.objuse(),e.objloadstore(),e.setlink(),e.setparent(),e.continueon(),e.onerror(),e.pdfone(),e.pdfsplit(),e.queryuse(),e.queryadd(),e.storeclear(),e.storeeach(),e.storeloadchanges(),e.storeloadobject(),e.storeloadstring(),e.storeremove(),e.storeuse(),e.decr(),e.incr(),e.set(),e.textaddtext(),e.textaddword(),e.textappendparagraph(),e.textadddoclist(),e.textinsertparagraph(),e.textload(),e.texttext(),e.textuse(),e.ttcontinue(),e.ttfreeze(),e.ttstart(),e.ttstop(),e.trace(),e.traceend(),e.tracesend(),e.uspsvalidate(),e.uspszip(),e.uspscitystate(),e.ftpchangedir(),e.ftpclose(),e.ftpdelete(),e.ftpdownload(),e.ftpdownloadlist(),e.ftpopen(),e.ftpupload(),e.ftpuse(),e.httpcookieget(),e.httpcookieset(),e.httpget(),e.httpuse(),e.workflowend(),e.workflowstart(),e.wordpop(),e.wordpush(),e.wordshift(),e.wordunshift(),e.docpdf()]};this.noop=function(){return{type:"noop",displayName:"noop,",description:"Does nothing,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done],properties:[]}};this.addressgeocode=function(){return{type:"address.geocode",displayName:"address.geocode,",description:"Gets the latitude and longitude of an address,",category:"Address",icon:"fas fa-map-marker-alt",outcomes:[OutcomeNames.Done],properties:[{name:"addr",type:"expression",label:"Addr",hint:"The address field"},{name:"city",type:"expression",label:"City",hint:"The city field"},{name:"state",type:"expression",label:"State",hint:"The state field"},{name:"zip",type:"expression",label:"Zip",hint:"The zip field"},{name:"lat",type:"expression",label:"Lat",hint:"The latitude field"},{name:"long",type:"expression",label:"Long",hint:"The longitude field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.addressvalidate=function(){return{type:"address.validate",displayName:"address.validate,",description:"Validates an address,",category:"Address",icon:"fas fa-map-marker-alt",outcomes:[OutcomeNames.Done],properties:[{name:"addr",type:"expression",label:"Addr",hint:"The address field"},{name:"city",type:"expression",label:"City",hint:"The city field"},{name:"state",type:"expression",label:"State",hint:"The state field"},{name:"zip",type:"expression",label:"Zip",hint:"The zip field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arrayappend=function(){return{type:"array.append",displayName:"array.append,",description:"Appends word or words from a value,",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"split",type:"expression",label:"Split",hint:"If true, the value is broken by spaces"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arrayeach=function(){return{type:"array.each",displayName:"array.each,",description:"Calls a task for each object in the list.  The working object is found at [*l:listobj] and the count is at [*l:listcount],",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done,OutcomeNames.Call],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"field",type:"expression",label:"Field",hint:"The field to use for the current value"},{name:"store",type:"expression",label:"Store",hint:"The store to use for the current value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arraypop=function(){return{type:"array.pop",displayName:"array.pop,",description:"Pops a store from an array (remove last),",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"store",type:"expression",label:"Store",hint:"The store name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arraypush=function(){return{type:"array.push",displayName:"array.push,",description:"Pushes a store into an array (add last),",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"store",type:"expression",label:"Store",hint:"The store name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arrayshift=function(){return{type:"array.shift",displayName:"array.shift,",description:"Shift a store from an array (remove first),",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"store",type:"expression",label:"Store",hint:"The store name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arrayunshift=function(){return{type:"array.unshift",displayName:"array.unshift,",description:"Unshift a store from an array (add first),",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"store",type:"expression",label:"Store",hint:"The store name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.arrayuse=function(){return{type:"array.use",displayName:"array.use,",description:"Sets the default array,",category:"Array",icon:"fas fa-layer-group",outcomes:[OutcomeNames.Done],properties:[{name:"array",type:"expression",label:"Array",hint:"The name of the array"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.sendemail=function(){return{type:"send.email",displayName:"send.email,",description:"Sends an EMail,",category:"Comm",icon:"fas fa-tty",outcomes:[OutcomeNames.Done],properties:[{name:"to",type:"expression",label:"To",hint:"E-Mail address to send the email"},{name:"subj",type:"expression",label:"Subj",hint:"The subject of the message to be sent"},{name:"msg",type:"expression",label:"Msg",hint:"The message to be sent"},{name:"list",type:"",label:"List",hint:"List of documents to attach"},{name:"meeting",type:"",label:"Meeting",hint:"Calendar object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.sendqm=function(){return{type:"send.qm",displayName:"send.qm,",description:"Sends a Quick Message,",category:"Comm",icon:"fas fa-tty",outcomes:[OutcomeNames.Done],properties:[{name:"to",type:"expression",label:"To",hint:"User to send the quick message to"},{name:"subj",type:"expression",label:"Subj",hint:"The subject of the message to be sent"},{name:"msg",type:"expression",label:"Msg",hint:"The message to be sent"},{name:"list",type:"expression",label:"List",hint:"List of documents to attach"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.sendsms=function(){return{type:"send.sms",displayName:"send.sms,",description:"Sends a SMS message,",category:"Comm",icon:"fas fa-tty",outcomes:[OutcomeNames.Done],properties:[{name:"to",type:"expression",label:"To",hint:"Phone number to send SMS message to (self if empty)"},{name:"msg",type:"expression",label:"Msg",hint:"The message to be sent"},{name:"list",type:"expression",label:"List",hint:"List of documents to attach"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclistadd=function(){return{type:"doc.list.add",displayName:"doc.list.add,",description:"Adds a document to the list,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document name to add"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclistclear=function(){return{type:"doc.list.clear",displayName:"doc.list.clear,",description:"Empties a list,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list to be emptied"},{name:"remove",type:"expression",label:"Remove",hint:"Remove documents"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclistdelete=function(){return{type:"doc.list.delete",displayName:"doc.list.delete,",description:"Deletes all the documents in list,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclisteach=function(){return{type:"doc.list.each",displayName:"doc.list.each,",description:"Calls code for each document in the list,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done,OutcomeNames.OnError,OutcomeNames.Call],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"doc",type:"expression",label:"Doc",hint:"The field to put the document name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclistobj=function(){return{type:"doc.list.obj",displayName:"doc.list.obj,",description:"Creates a document list from an objects folder,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"obj",type:"expression",label:"Obj",hint:"The source object"},{name:"folder",type:"expression",label:"Folder",hint:"The folder"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doclistremove=function(){return{type:"doc.list.remove",displayName:"doc.list.remove,",description:"Removes a document from the list,",category:"Document List",icon:"fas fa-folder",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document name to remove"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docadd=function(){return{type:"doc.add",displayName:"doc.add,",description:"Adds a document to the working set,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"name",type:"expression",label:"Name",hint:"The name to be used"},{name:"obj",type:"expression",label:"Obj",hint:"The name of the object which is the parent"},{name:"path",type:"expression",label:"Path",hint:"The path of the document"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docclear=function(){return{type:"doc.clear",displayName:"doc.clear,",description:"Clears all documents,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.doccopy=function(){return{type:"doc.copy",displayName:"doc.copy,",description:"Copies a document,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"from",type:"expression",label:"From",hint:"The source document name"},{name:"to",type:"expression",label:"To",hint:"The target document name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docdelete=function(){return{type:"doc.delete",displayName:"doc.delete,",description:"Removes a document from the list and deletes it from storage,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The name of the document to be deleted"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docremove=function(){return{type:"doc.remove",displayName:"doc.remove,",description:"Removes a document from the list,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document to be removed"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docrename=function(){return{type:"doc.rename",displayName:"doc.rename,",description:"Renames a document,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"from",type:"expression",label:"From",hint:"The source document name"},{name:"as",type:"expression",label:"As",hint:"The target document physical name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docsave=function(){return{type:"doc.save",displayName:"doc.save,",description:"Saves a document,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The name of the document to be saved"},{name:"text",type:"expression",label:"Text",hint:"The text"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.mergedoc=function(){return{type:"merge.doc",displayName:"merge.doc,",description:"Merges a .DOCX or .PDF file with values from the context,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document to be merged"},{name:"to",type:"expression",label:"To",hint:"The merged PDF document"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.python=function(){return{type:"python",displayName:"python,",description:"Runs a python script,",category:"External",icon:"fas fa-concierge-bell",outcomes:[OutcomeNames.Done],properties:[{name:"code",type:"expression",label:"Code",hint:"Document that holds the python script.  Entry point should have two args, env - the workign environment and args - the parameters passed"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.sendtweet=function(){return{type:"send.tweet",displayName:"send.tweet,",description:"Sends a tweet,",category:"External",icon:"fas fa-concierge-bell",outcomes:[OutcomeNames.Done],properties:[{name:"consumerKey",type:"expression",label:"ConsumerKey",hint:"Your consumer key from Twitter"},{name:"consumerSecret",type:"expression",label:"ConsumerSecret",hint:"Your secret key from Twitter"},{name:"accessToken",type:"expression",label:"AccessToken",hint:"Your access token from Twitter"},{name:"accessTokenSecret",type:"expression",label:"AccessTokenSecret",hint:"Your access token secret from Twitter"},{name:"msg",type:"expression",label:"Msg",hint:"The message to be tweeted"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.call=function(){return{type:"call",displayName:"call,",description:"Calls a task, returning to calling task on exit,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done],properties:[{name:"task",type:"expression",label:"Task",hint:"The task to be called"},{name:"store",type:"expression",label:"Store",hint:"Store to pass as passed"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.end=function(){return{type:"end",displayName:"end,",description:"Ends a task,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"Store to return"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.switch=function(){return{type:"switch",displayName:"switch,",description:"Switch execution based on a given expression,",runtimeDescription:"x => !!x.state.expression ? `Switch execution based on <strong>${ x.state.expression.expression }</strong>.` : x.definition.description",category:"Flow",icon:"fas fa-code-branch",outcomes:"x => x.state.cases",properties:[{name:"expression",type:"expression",label:"Expression",hint:"The expression to evaluate. The evaluated value will be used to switch on"},{name:"cases",type:"list",label:"Cases",hint:"A comma-separated list of possible outcomes of the expression"}]}};this.objlist=function(){return{type:"obj.list",displayName:"obj.list,",description:"Creates a list of objects using a query,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"query",type:"expression",label:"Query",hint:"The store that is the query"},{name:"sortby",type:"expression",label:"Sortby",hint:"Sort by"},{name:"limit",type:"expression",label:"Limit",hint:"Max number of objects to return"},{name:"skip",type:"expression",label:"Skip",hint:"Number of objects to skip"},{name:"dir",type:"expression",label:"Dir",hint:"Direction of sort (asc/desc)"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlistadd=function(){return{type:"obj.list.add",displayName:"obj.list.add,",description:"Adds an object to the list,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object name to add"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlistclear=function(){return{type:"obj.list.clear",displayName:"obj.list.clear,",description:"Empties a list,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list to be emptied"},{name:"remove",type:"expression",label:"Remove",hint:"Remove objects"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlistdelete=function(){return{type:"obj.list.delete",displayName:"obj.list.delete,",description:"Deletes all objects in the list,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlisteach=function(){return{type:"obj.list.each",displayName:"obj.list.each,",description:"Calls a chore for each object in the list.  The working object is found at [*l:listobj] and the count is at [*l:listcount],",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done,OutcomeNames.OnError,OutcomeNames.Call],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"obj",type:"expression",label:"Obj",hint:"The object name to use inside the chore"},{name:"store",type:"expression",label:"Store",hint:"Store to pass as passed"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlistpick=function(){return{type:"obj.list.pick",displayName:"obj.list.pick,",description:"Creates an object list using a query,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"list",type:"expression",label:"List",hint:"The name of the list"},{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"query",type:"expression",label:"Query",hint:"The store that is the query"},{name:"sortby",type:"expression",label:"Sortby",hint:"Sort by"},{name:"limit",type:"expression",label:"Limit",hint:"Max number of objects to return"},{name:"skip",type:"expression",label:"Skip",hint:"Number of objects to skip"},{name:"dir",type:"expression",label:"Dir",hint:"Direction of sort (asc/desc)"},{name:"merge",type:"expression",label:"Merge",hint:"True if lists are merged"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlistremove=function(){return{type:"obj.list.remove",displayName:"obj.list.remove,",description:"Removes an object from the list,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object name to remove"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objadd=function(){return{type:"obj.add",displayName:"obj.add,",description:"Adds an object to the working stack,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"id",type:"expression",label:"Id",hint:"The id of the object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objaddlink=function(){return{type:"obj.add.link",displayName:"obj.add.link,",description:"Adds a link of an object to the working stack,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"field",type:"expression",label:"Field",hint:"The link field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objaddparent=function(){return{type:"obj.add.parent",displayName:"obj.add.parent,",description:"Adds the parent of an object to the working stack,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"from",type:"expression",label:"From",hint:"The name of the source object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objalias=function(){return{type:"obj.alias",displayName:"obj.alias,",description:"Aliases an object to the working stack,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"from",type:"expression",label:"From",hint:"The curent object name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objapply=function(){return{type:"obj.apply",displayName:"obj.apply,",description:"Applies a store to an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"store",type:"expression",label:"Store",hint:"The source object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objcopy=function(){return{type:"obj.copy",displayName:"obj.copy,",description:"Copies one object to another,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the source object"},{name:"to",type:"expression",label:"To",hint:"The name of the target object"},{name:"flds",type:"expression",label:"Flds",hint:"Fields to include"},{name:"excl",type:"expression",label:"Excl",hint:"Fields to exclude"},{name:"ext",type:"expression",label:"Ext",hint:"Copy extensions"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objcreate=function(){return{type:"obj.create",displayName:"obj.create,",description:"Creates a new working object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"store",type:"expression",label:"Store",hint:"The store holding the values"},{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"parent",type:"expression",label:"Parent",hint:"The name of the parent object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objdelete=function(){return{type:"obj.delete",displayName:"obj.delete,",description:"Deletes the object from the database and from the working set,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objdoccopy=function(){return{type:"obj.doc.copy",displayName:"obj.doc.copy,",description:"Copies all documents from an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object to use"},{name:"to",type:"expression",label:"To",hint:"The target object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objdoclist=function(){return{type:"obj.doc.list",displayName:"obj.doc.list,",description:"Creates a document list from an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object to use"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objeach=function(){return{type:"obj.each",displayName:"obj.each,",description:"Call code for each object in a query,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done,OutcomeNames.OnError,OutcomeNames.Call],properties:[{name:"list",type:"expression",label:"List",hint:"The list"},{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"query",type:"expression",label:"Query",hint:"The store that is the query"},{name:"sortby",type:"expression",label:"Sortby",hint:"Sort by"},{name:"limit",type:"expression",label:"Limit",hint:"Max number of objects to return"},{name:"skip",type:"expression",label:"Skip",hint:"Number of objects to skip"},{name:"dir",type:"expression",label:"Dir",hint:"Direction of sort (asc/desc)"},{name:"as",type:"expression",label:"As",hint:"The name of the passed object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objlu=function(){return{type:"obj.lu",displayName:"obj.lu,",description:"Carries out lookup on a field,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objorganizer=function(){return{type:"obj.organizer",displayName:"obj.organizer,",description:"Creates an organizer for the object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object to use"},{name:"options",type:"expression",label:"Options",hint:"The dataset options"},{name:"doc",type:"expression",label:"Doc",hint:"The document"},{name:"folder",type:"expression",label:"Folder",hint:"The folder"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objpick=function(){return{type:"obj.pick",displayName:"obj.pick,",description:"Gets or creates an object using a query,",category:"Object List",icon:"fas fa-object-group",outcomes:[OutcomeNames.Done],properties:[{name:"name",type:"expression",label:"Name",hint:"The name of the object"},{name:"ds",type:"expression",label:"Ds",hint:"The dataset of the object"},{name:"query",type:"expression",label:"Query",hint:"The store that is the query"},{name:"sortby",type:"expression",label:"Sortby",hint:"Sort by"},{name:"limit",type:"expression",label:"Limit",hint:"Max number of objects to return"},{name:"skip",type:"expression",label:"Skip",hint:"Number of objects to skip"},{name:"dir",type:"expression",label:"Dir",hint:"Direction of sort (asc/desc)"},{name:"store",type:"expression",label:"Store",hint:"The store holding the values"},{name:"parent",type:"expression",label:"Parent",hint:"The name of the parent object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objremove=function(){return{type:"obj.remove",displayName:"obj.remove,",description:"Removes the object from working set,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objsave=function(){return{type:"obj.save",displayName:"obj.save,",description:"Saves the working object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"tasks",type:"expression",label:"Tasks",hint:"If true (non zero) allow tasks, otherwise disallow"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objset=function(){return{type:"obj.set",displayName:"obj.set,",description:"Sets a value in a field of an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"field",type:"expression",label:"Field",hint:"The field to set"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objtouch=function(){return{type:"obj.touch",displayName:"obj.touch,",description:"Flags the field as changed,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object to use"},{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objuse=function(){return{type:"obj.use",displayName:"obj.use,",description:"Sets the default object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The object to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.objloadstore=function(){return{type:"obj.load.store",displayName:"obj.load.store,",description:"Copies a store into an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"store",type:"expression",label:"Store",hint:"The store to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.setlink=function(){return{type:"set.link",displayName:"set.link,",description:"Sets a link to an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"link",type:"expression",label:"Link",hint:"The linked object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.setparent=function(){return{type:"set.parent",displayName:"set.parent,",description:"Sets the parent of an object,",category:"Object",icon:"fas fa-vector-square",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"link",type:"expression",label:"Link",hint:"The linked object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.continueon=function(){return{type:"continue.on",displayName:"continue.on,",description:"Continues an an on.xxx call,",category:"Flow",icon:"fas fa-code-branch",outcomes:[],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.onerror=function(){return{type:"on.error",displayName:"on.error,",description:"Sets the default process to handle errors,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done,OutcomeNames.OnError],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.pdfone=function(){return{type:"pdf.one",displayName:"pdf.one,",description:"Merges multiple .PDF files into one,",category:"PDF",icon:"fas fa-file-pdf",outcomes:[OutcomeNames.Done],properties:[{name:"doclist",type:"expression",label:"Doclist",hint:"The document list to be merged"},{name:"to",type:"expression",label:"To",hint:"The merged document"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.pdfsplit=function(){return{type:"pdf.split",displayName:"pdf.split,",description:"Splits one .PDF file into multiple by page count,",category:"PDF",icon:"fas fa-file-pdf",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document to be split"},{name:"pages",type:"expression",label:"Pages",hint:"The page count (<0 if skip, * if pages left over)"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.queryuse=function(){return{type:"query.use",displayName:"query.use,",description:"Sets the default query,",category:"Query",icon:"fas fa-question",outcomes:[OutcomeNames.Done],properties:[{name:"query",type:"expression",label:"Query",hint:"The query to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.queryadd=function(){return{type:"query.add",displayName:"query.add,",description:"Sets a query expression,",category:"Query",icon:"fas fa-question",outcomes:[OutcomeNames.Done],properties:[{name:"query",type:"expression",label:"Query",hint:"The query"},{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"op",type:"expression",label:"Op",hint:"The operation"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeclear=function(){return{type:"store.clear",displayName:"store.clear,",description:"Clears all values in the store,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to clear"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeeach=function(){return{type:"store.each",displayName:"store.each,",description:"Calls code, passing an element of the array,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done,OutcomeNames.OnError,OutcomeNames.Call],properties:[{name:"store",type:"expression",label:"Store",hint:"Store to use"},{name:"field",type:"expression",label:"Field",hint:"Field in to use to pass name"},{name:"value",type:"expression",label:"Value",hint:"Field in to use to pass value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeloadchanges=function(){return{type:"store.load.changes",displayName:"store.load.changes,",description:"Loads a store from changes in object,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to load"},{name:"obj",type:"expression",label:"Obj",hint:"The object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeloadobject=function(){return{type:"store.load.object",displayName:"store.load.object,",description:"Loads a store from object,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to load"},{name:"obj",type:"expression",label:"Obj",hint:"The object"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeloadstring=function(){return{type:"store.load.string",displayName:"store.load.string,",description:"Loads a store from a string,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to load"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeremove=function(){return{type:"store.remove",displayName:"store.remove,",description:"Removes the store from the stack,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to remove"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeuse=function(){return{type:"store.use",displayName:"store.use,",description:"Sets the default store,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.decr=function(){return{type:"decr",displayName:"decr,",description:"Decrements a field,",category:"Ops",icon:"fas fa-plus-square",outcomes:[OutcomeNames.Done],properties:[{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"value",type:"expression",label:"Value",hint:"The value to decrement by"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.incr=function(){return{type:"incr",displayName:"incr,",description:"Increments a field,",category:"Ops",icon:"fas fa-plus-square",outcomes:[OutcomeNames.Done],properties:[{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"value",type:"expression",label:"Value",hint:"The value to increment by"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.set=function(){return{type:"set",displayName:"set,",description:"Sets a value,",category:"Ops",icon:"fas fa-plus-square",outcomes:[OutcomeNames.Done],properties:[{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textaddtext=function(){return{type:"text.add.text",displayName:"text.add.text,",description:"Adds text to a text line,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"line",type:"expression",label:"Line",hint:"The row"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textaddword=function(){return{type:"text.add.word",displayName:"text.add.word,",description:"Adds text to a text line,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"line",type:"expression",label:"Line",hint:"The row"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textappendparagraph=function(){return{type:"text.append.paragraph",displayName:"text.append.paragraph,",description:"Appends a new word to a text,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textadddoclist=function(){return{type:"text.add.doclist",displayName:"text.add.doclist,",description:"Appends a block of doc names to a memo,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"list",type:"expression",label:"List",hint:"The list"},{name:"line",type:"expression",label:"Line",hint:"The row"},{name:"delim",type:"expression",label:"Delim",hint:"The delimiter"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textinsertparagraph=function(){return{type:"text.insert.paragraph",displayName:"text.insert.paragraph,",description:"Inserts a new paragraph to a text,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"line",type:"expression",label:"Line",hint:"The row to insert before"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textload=function(){return{type:"text.load",displayName:"text.load,",description:"Copies a value into a text area,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.texttext=function(){return{type:"text.text",displayName:"text.text,",description:"Copies text into a field,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.textuse=function(){return{type:"text.use",displayName:"text.use,",description:"Sets the default text,",category:"Text",icon:"fas fa-paragraph",outcomes:[OutcomeNames.Done],properties:[{name:"text",type:"expression",label:"Text",hint:"The text name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ttcontinue=function(){return{type:"tt.continue",displayName:"tt.continue,",description:"Continues time tracking,",category:"Time Track",icon:"fas fa-clock",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"type",type:"expression",label:"Type",hint:"The type of tag"},{name:"user",type:"expression",label:"User",hint:"The user"},{name:"reason",type:"expression",label:"Reason",hint:"The reason of the freeze"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ttfreeze=function(){return{type:"tt.freeze",displayName:"tt.freeze,",description:"Freezes time tracking,",category:"Time Track",icon:"fas fa-clock",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"type",type:"expression",label:"Type",hint:"The type of tag"},{name:"user",type:"expression",label:"User",hint:"The user"},{name:"reason",type:"expression",label:"Reason",hint:"The reason of the freeze"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ttstart=function(){return{type:"tt.start",displayName:"tt.start,",description:"Starts time tracking,",category:"Time Track",icon:"fas fa-clock",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"type",type:"expression",label:"Type",hint:"The type of tag"},{name:"user",type:"expression",label:"User",hint:"The user"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ttstop=function(){return{type:"tt.stop",displayName:"tt.stop,",description:"Stops time tracking,",category:"Time Track",icon:"fas fa-clock",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"type",type:"expression",label:"Type",hint:"The type of tag"},{name:"user",type:"expression",label:"User",hint:"The user"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.trace=function(){return{type:"trace",displayName:"trace,",description:"Starts the trace mode,",category:"Trace",icon:"fas fa-search",outcomes:[OutcomeNames.Done],properties:[{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.traceend=function(){return{type:"trace.end",displayName:"trace.end,",description:"Ends the trace mode,",category:"Trace",icon:"fas fa-search",outcomes:[OutcomeNames.Done],properties:[{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.tracesend=function(){return{type:"trace.send",displayName:"trace.send,",description:"Sends the trace,",category:"Trace",icon:"fas fa-search",outcomes:[OutcomeNames.Done],properties:[{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.uspsvalidate=function(){return{type:"usps.validate",displayName:"usps.validate,",description:"Validates an address,",category:"USPS",icon:"fas fa-envelope",outcomes:[OutcomeNames.Done],properties:[{name:"address",type:"expression",label:"Address",hint:"The address"},{name:"city",type:"expression",label:"City",hint:"The city"},{name:"state",type:"expression",label:"State",hint:"The state"},{name:"zip",type:"expression",label:"Zip",hint:"The zip"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.uspszip=function(){return{type:"usps.zip",displayName:"usps.zip,",description:"Returns the ZIP for an address,",category:"USPS",icon:"fas fa-envelope",outcomes:[OutcomeNames.Done],properties:[{name:"city",type:"expression",label:"City",hint:"The city"},{name:"state",type:"expression",label:"State",hint:"The state"},{name:"zip",type:"expression",label:"Zip",hint:"The zip"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.uspscitystate=function(){return{type:"usps.citystate",displayName:"usps.citystate,",description:"Returns the city and state for an address,",category:"USPS",icon:"fas fa-envelope",outcomes:[OutcomeNames.Done],properties:[{name:"address",type:"expression",label:"Address",hint:"The address"},{name:"city",type:"expression",label:"City",hint:"The city"},{name:"state",type:"expression",label:"State",hint:"The state"},{name:"zip",type:"expression",label:"Zip",hint:"The zip"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpchangedir=function(){return{type:"ftp.changedir",displayName:"ftp.changedir,",description:"Changes the current directory,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"dir",type:"expression",label:"Dir",hint:"The directory name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpclose=function(){return{type:"ftp.close",displayName:"ftp.close,",description:"Closes the sftp connection,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpdelete=function(){return{type:"ftp.delete",displayName:"ftp.delete,",description:"Deletes a file from the server,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"file",type:"expression",label:"File",hint:"The file name at the server"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpdownload=function(){return{type:"ftp.download",displayName:"ftp.download,",description:"Downloads a file from the server,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"file",type:"expression",label:"File",hint:"The file name at the server"},{name:"doc",type:"expression",label:"Doc",hint:"The document name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpdownloadlist=function(){return{type:"ftp.download.list",displayName:"ftp.download.list,",description:"Downloads a set of files from the server,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"list",type:"expression",label:"List",hint:"The list to store the files"},{name:"obj",type:"expression",label:"Obj",hint:"The object to store the files under"},{name:"folder",type:"expression",label:"Folder",hint:"The folder"},{name:"del",type:"expression",label:"Del",hint:"If true, delete when downloaded"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpopen=function(){return{type:"ftp.open",displayName:"ftp.open,",description:"Opens an sftp connection,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"url",type:"expression",label:"Url",hint:"The URl to connect to"},{name:"port",type:"expression",label:"Port",hint:"The port"},{name:"user",type:"expression",label:"User",hint:"The user name"},{name:"pwd",type:"expression",label:"Pwd",hint:"The user password"},{name:"sftp",type:"expression",label:"Sftp",hint:"True if SFTP"},{name:"cert",type:"expression",label:"Cert",hint:"The SSH certificate if SFTP (from system wallet)"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpupload=function(){return{type:"ftp.upload",displayName:"ftp.upload,",description:"Uploads a file to the server,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"file",type:"expression",label:"File",hint:"The file name at the server"},{name:"doc",type:"expression",label:"Doc",hint:"The document name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ftpuse=function(){return{type:"ftp.use",displayName:"ftp.use,",description:"Sets the default sftp connection,",category:"FTP",icon:"fas fa-server",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.httpcookieget=function(){return{type:"http.cookie.get",displayName:"http.cookie.get,",description:"Closes the sftp connection,",category:"HTTP",icon:"fas fa-desktop",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"domain",type:"expression",label:"Domain",hint:"The domain"},{name:"key",type:"expression",label:"Key",hint:"The key"},{name:"to",type:"expression",label:"To",hint:"The location of the value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.httpcookieset=function(){return{type:"http.cookie.set",displayName:"http.cookie.set,",description:"Sets a cookie value in the connection,",category:"HTTP",icon:"fas fa-desktop",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"domain",type:"expression",label:"Domain",hint:"The domain"},{name:"key",type:"expression",label:"Key",hint:"The key"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.httpget=function(){return{type:"http.get",displayName:"http.get,",description:"Does an HTTP Get,",category:"HTTP",icon:"fas fa-desktop",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"url",type:"expression",label:"Url",hint:"The URL"},{name:"storeout",type:"expression",label:"Storeout",hint:"The store to use as parameters"},{name:"storein",type:"expression",label:"Storein",hint:"The store to use as return"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.httpuse=function(){return{type:"http.use",displayName:"http.use,",description:"Sets the default http connection,",category:"HTTP",icon:"fas fa-desktop",outcomes:[OutcomeNames.Done],properties:[{name:"conn",type:"expression",label:"Conn",hint:"The connection to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.workflowend=function(){return{type:"workflow.end",displayName:"workflow.end,",description:"Ends a workflow on a given object,",category:"Workflow",icon:"fas fa-network-wired",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"wf",type:"expression",label:"Wf",hint:"The workflow to start"},{name:"name",type:"expression",label:"Name",hint:"The user defined name"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.workflowstart=function(){return{type:"workflow.start",displayName:"workflow.start,",description:"Starts a workflow on a given object,",category:"Workflow",icon:"fas fa-network-wired",outcomes:[OutcomeNames.Done],properties:[{name:"obj",type:"expression",label:"Obj",hint:"The name of the object"},{name:"wf",type:"expression",label:"Wf",hint:"The workflow to start"},{name:"name",type:"text",label:"Name",hint:"The user defined name"},{name:"store",type:"expression",label:"Store",hint:"The store to pass"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.wordpop=function(){return{type:"word.pop",displayName:"word.pop,",description:"Remove word from end of string,",category:"Word",icon:"fas fa-keyboard",outcomes:[OutcomeNames.Done],properties:[{name:"string",type:"expression",label:"String",hint:"The string"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"delim",type:"expression",label:"Delim",hint:"The delimiter"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.wordpush=function(){return{type:"word.push",displayName:"word.push,",description:"Adds text to end of string,",category:"Word",icon:"fas fa-keyboard",outcomes:[OutcomeNames.Done],properties:[{name:"string",type:"expression",label:"String",hint:"The string"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"delim",type:"expression",label:"Delim",hint:"The delimiter"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.wordshift=function(){return{type:"word.shift",displayName:"word.shift,",description:"Remove text from front of string,",category:"Word",icon:"fas fa-keyboard",outcomes:[OutcomeNames.Done],properties:[{name:"string",type:"expression",label:"String",hint:"The string"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"delim",type:"expression",label:"Delim",hint:"The delimiter"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.wordunshift=function(){return{type:"word.unshift",displayName:"word.unshift,",description:"Adds text to front of string,",category:"Word",icon:"fas fa-keyboard",outcomes:[OutcomeNames.Done],properties:[{name:"string",type:"expression",label:"String",hint:"The string"},{name:"value",type:"expression",label:"Value",hint:"The text"},{name:"delim",type:"expression",label:"Delim",hint:"The delimiter"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.docpdf=function(){return{type:"doc.pdf",displayName:"doc.pdf,",description:"Converts to PDF,",category:"Document",icon:"fas fa-file",outcomes:[OutcomeNames.Done],properties:[{name:"doc",type:"expression",label:"Doc",hint:"The document to be merged"},{name:"to",type:"expression",label:"To",hint:"The PDF document"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}}}return e}();TaskActivities.Category="Activity";pluginStore.add(new TaskActivities);var WorkflowActivities=function(){function e(){var e=this;this.getName=function(){return"WorkflowActivities"};this.getActivityDefinitions=function(){return[e.call(),e.delay(),e.end(),e.fork(),e.ifelse(),e.join(),e.switch(),e.task(),e.continueon(),e.onerror(),e.onoverdue(),e.do(),e.storeuse(),e.set()]};this.call=function(){return{type:"call",displayName:"call,",description:"Starts a workflow,",runtimeDescription:"x => !!x.state.workflow ? `Starts <strong>${ x.state.workflow.expression }</strong>` : x.definition.description",category:"Action",icon:"fas fa-dot-circle",outcomes:[OutcomeNames.Done,OutcomeNames.OnError],properties:[{name:"workflow",type:"expression",label:"Workflow",hint:"The workflow to start"},{name:"name",type:"text",label:"Name",hint:"The user defined name"},{name:"store",type:"expression",label:"Store",hint:"The store to pass"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.delay=function(){return{type:"delay",displayName:"delay,",description:"Delays for a specified duration,",runtimeDescription:"x => !!x.state.duration ? `Delay for <strong>${ x.state.duration.expression }</strong>` : x.definition.description",category:"Action",icon:"fas fa-dot-circle",outcomes:[OutcomeNames.Done],properties:[{name:"duration",type:"expression",label:"Duration",hint:"The duration length"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.end=function(){return{type:"end",displayName:"end,",description:"Ends the workflow,",category:"Flow",icon:"fas fa-code-branch",outcomes:[],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.fork=function(){return{type:"fork",displayName:"fork,",description:"Fork workflow execution into multiple branches,",category:"Flow",icon:"fas fa-code-branch",outcomes:"x => x.state.branches",properties:[{name:"branches",type:"list",label:"Branches",hint:"A comma-separated list of names representing branches"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.ifelse=function(){return{type:"ifelse",displayName:"ifelse,",description:"Evaluate a Boolean expression and continue execution depending on the result,",runtimeDescription:"x => !!x.state.expression ? `Evaluate <strong>${ x.state.expression.expression }</strong> and continue execution depending on the result.` : x.definition.description",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.True,OutcomeNames.False],properties:[{name:"expression",type:"expression",label:"Expression",hint:"The expression to evaluate. The evaluated value will be used to switch on"}]}};this.join=function(){return{type:"join",displayName:"join,",description:"Merge workflow execution back into a single branch,",runtimeDescription:"x => !!x.state.joinMode ? `Merge workflow execution back into a single branch using mode <strong>${ x.state.joinMode }</strong>` : x.definition.description",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done],properties:[{name:"joinMode",type:"select",label:"JoinMode",options:{items:["WaitAll","WaitAny"]},hint:"Either wait for all or any"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.switch=function(){return{type:"switch",displayName:"switch,",description:"Switch execution based on a given expression,",runtimeDescription:"x => !!x.state.expression ? `Switch execution based on <strong>${ x.state.expression.expression }</strong>.` : x.definition.description",category:"Flow",icon:"fas fa-code-branch",outcomes:"x => x.state.cases",properties:[{name:"expression",type:"expression",label:"Expression",hint:"The expression to evaluate. The evaluated value will be used to switch on"},{name:"cases",type:"list",label:"Cases",hint:"A comma-separated list of possible outcomes of the expression"}]}};this.task=function(){return{type:"task",displayName:"task,",description:"Calls a task,",runtimeDescription:"x => !!x.state.task ? `Calls <strong>${ x.state.task.expression }</strong>` : x.definition.description",category:"Action",icon:"fas fa-dot-circle",outcomes:[OutcomeNames.Done],properties:[{name:"task",type:"expression",label:"Task",hint:"The task to call"},{name:"store",type:"expression",label:"Store",hint:"The store to pass"},{name:"return",type:"expression",label:"Return",hint:"The store to use for the return"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.continueon=function(){return{type:"continue.on",displayName:"continue.on,",description:"Continues an an on.xxx call,",category:"Flow",icon:"fas fa-code-branch",outcomes:[],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.onerror=function(){return{type:"on.error",displayName:"on.error,",description:"Sets the default process to handle errors,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done,OutcomeNames.OnError],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.onoverdue=function(){return{type:"on.overdue",displayName:"on.overdue,",description:"Sets the default process to handle overdues,",category:"Flow",icon:"fas fa-code-branch",outcomes:[OutcomeNames.Done,OutcomeNames.OnOverdue],properties:[{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.do=function(){return{type:"do",displayName:"do,",description:"Creates activity,",runtimeDescription:"x => !!x.state.subject ? `<strong>${ x.state.subject }</strong>` : x.definition.description",category:"Action",icon:"fas fa-dot-circle",outcomes:[OutcomeNames.Done,OutcomeNames.Fail,OutcomeNames.OnOverdue,OutcomeNames.OnError],properties:[{name:"subject",type:"expression",label:"Subject",hint:"The subject line"},{name:"message",type:"expression",label:"Message",hint:"The message line"},{name:"assignedTo",type:"expression",label:"AssignedTo",hint:"The group to whom the activity is assigned to"},{name:"duration",type:"expression",label:"Duration",hint:"The duration length"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.storeuse=function(){return{type:"store.use",displayName:"store.use,",description:"Sets the default store,",category:"Store",icon:"fas fa-database",outcomes:[OutcomeNames.Done],properties:[{name:"store",type:"expression",label:"Store",hint:"The store to use"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}};this.set=function(){return{type:"set",displayName:"set,",description:"Sets a value,",category:"Ops",icon:"fas fa-plus-square",outcomes:[OutcomeNames.Done],properties:[{name:"field",type:"expression",label:"Field",hint:"The field"},{name:"value",type:"expression",label:"Value",hint:"The value"},{name:"if",type:"expression",label:"If",hint:"Execute if"},{name:"comment",type:"text",label:"Comment",hint:"What does this step accomplish"}]}}}return e}();WorkflowActivities.Category="Activity";pluginStore.add(new WorkflowActivities);var DesignerHost=function(){function e(e){var t=this;registerInstance(this,e);this.activityDefinitions=[];this.loadActivityDefinitions=function(){var e=t.pluginsData||"";var n=e.split(/[ ,]+/).map(function(e){return e.trim()});return pluginStore.list().filter(function(e){return n.indexOf(e.getName())>-1}).filter(function(e){return!!e.getActivityDefinitions}).map(function(e){return e.getActivityDefinitions()}).reduce(function(e,t){return e.concat(t)},[])};this.onWorkflowChanged=function(e){t.workflowChanged.emit(e.detail)};this.initActivityDefinitions=function(){t.activityDefinitions=t.loadActivityDefinitions();if(!!t.activityDefinitionsData){var e=JSON.parse(t.activityDefinitionsData);t.activityDefinitions=t.activityDefinitions.concat(e)}};this.initFieldDrivers=function(){DisplayManager$1.addDriver("text",new TextFieldDriver);DisplayManager$1.addDriver("expression",new ExpressionFieldDriver);DisplayManager$1.addDriver("list",new ListFieldDriver);DisplayManager$1.addDriver("boolean",new BooleanFieldDriver);DisplayManager$1.addDriver("select",new SelectFieldDriver)};this.initWorkflow=function(){if(!!t.workflowData){var e=JSON.parse(t.workflowData);if(!e.activities)e.activities=[];if(!e.connections)e.connections=[];t.designer.workflow=e}};this.workflowChanged=createEvent(this,"workflowChanged",7)}e.prototype.newWorkflow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.designer.newWorkflow()];case 1:e.sent();return[2]}})})};e.prototype.getWorkflow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.designer.getWorkflow()];case 1:return[2,e.sent()]}})})};e.prototype.showActivityPicker=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.activityPicker.show()];case 1:e.sent();return[2]}})})};e.prototype.export=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.importExport.export(this.designer,e)];case 1:t.sent();return[2]}})})};e.prototype.import=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.importExport.import()];case 1:e.sent();return[2]}})})};e.prototype.onActivityPicked=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.designer.addActivity(e.detail)];case 1:t.sent();return[2]}})})};e.prototype.onEditActivity=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){this.activityEditor.activity=e.detail;this.activityEditor.show=true;return[2]})})};e.prototype.onAddActivity=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.showActivityPicker()];case 1:e.sent();return[2]}})})};e.prototype.onUpdateActivity=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.designer.updateActivity(e.detail)];case 1:t.sent();return[2]}})})};e.prototype.onExportWorkflow=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:if(!this.importExport)return[2];return[4,this.importExport.export(this.designer,e.detail)];case 1:t.sent();return[2]}})})};e.prototype.onImportWorkflow=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){this.designer.workflow=deepClone(e.detail);return[2]})})};e.prototype.componentWillLoad=function(){this.initActivityDefinitions();this.initFieldDrivers()};e.prototype.componentDidLoad=function(){this.initWorkflow()};e.prototype.render=function(){var e=this;var t=this.activityDefinitions;return h("host",null,h("wf-activity-picker",{activityDefinitions:t,ref:function(t){return e.activityPicker=t}}),h("wf-activity-editor",{activityDefinitions:t,ref:function(t){return e.activityEditor=t}}),h("wf-import-export",{ref:function(t){return e.importExport=t}}),h("div",{class:"workflow-designer-wrapper dragscroll"},h("wf-designer",{activityDefinitions:t,ref:function(t){return e.designer=t},canvasHeight:this.canvasHeight,workflow:this.workflow,readonly:this.readonly,onWorkflowChanged:this.onWorkflowChanged})))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".workflow-designer-wrapper{height:80vh;overflow-y:auto}"},enumerable:true,configurable:true});return e}();exports("wf_designer_host",DesignerHost);var ExportButton=function(){function e(e){var t=this;registerInstance(this,e);this.workflowFormats={json:{format:"json",fileExtension:".json",mimeType:"application/json",displayName:"JSON"},yaml:{format:"yaml",fileExtension:".yaml",mimeType:"application/x-yaml",displayName:"YAML"},xml:{format:"xml",fileExtension:".xml",mimeType:"application/xml",displayName:"XML"},object:{format:"object",fileExtension:".bin",mimeType:"application/binary",displayName:"Binary"}};this.getWorkflowHost=function(){return!!t.designerHostId?document.querySelector("#"+t.designerHostId):null};this.handleExportClick=function(e,n){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:e.preventDefault();this.exportClickedEvent.emit(n);t=this.getWorkflowHost();if(!!!t)return[3,2];return[4,t.export(n)];case 1:i.sent();i.label=2;case 2:return[2]}})})};this.exportClickedEvent=createEvent(this,"export",7)}e.prototype.render=function(){var e=this;var t=this.workflowFormats;return h("div",{class:"dropdown"},h("button",{class:"btn btn-secondary dropdown-toggle",type:"button",id:"exportButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Export"),h("div",{class:"dropdown-menu","aria-labelledby":"exportButton"},Object.keys(t).map(function(n){var i=t[n];return h("a",{class:"dropdown-item",href:"#",onClick:function(t){return e.handleExportClick(t,i)}},i.displayName)})))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});return e}();exports("wf_export_button",ExportButton);var remedial=createCommonjsModule(function(e){(function(){var t=Function("return this")(),n="Boolean Number String Function Array Date RegExp Object".split(" "),i,o,s={};for(i in n){if(n.hasOwnProperty(i)){o=n[i];s["[object "+o+"]"]=o.toLowerCase()}}function r(e){return null===e||undefined===e?String(e):s[Object.prototype.toString.call(e)]||"object"}function a(e){var t,n;if(r(e)==="object"){for(t in e){n=e[t];if(n!==undefined&&r(n)!=="function"){return false}}}return true}if(!String.prototype.entityify){String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}if(!String.prototype.quote){String.prototype.quote=function(){var e,t,n=this.length,i='"';for(t=0;t<n;t+=1){e=this.charAt(t);if(e>=" "){if(e==="\\"||e==='"'){i+="\\"}i+=e}else{switch(e){case"\b":i+="\\b";break;case"\f":i+="\\f";break;case"\n":i+="\\n";break;case"\r":i+="\\r";break;case"\t":i+="\\t";break;default:e=e.charCodeAt();i+="\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)}}}return i+'"'}}if(!String.prototype.supplant){String.prototype.supplant=function(e){return this.replace(/{([^{}]*)}/g,function(t,n){var i=e[n];return typeof i==="string"||typeof i==="number"?i:t})}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}}e.exports={typeOf:r,isEmpty:a};t.typeOf=t.typeOf||r;t.isEmpty=t.isEmpty||a})()});var json2yaml=createCommonjsModule(function(e){(function(){var t=remedial.typeOf;function n(e){var n,i="";n={undefined:function(){return"null"},null:function(){return"null"},number:function(e){return e},boolean:function(e){return e?"true":"false"},string:function(e){return JSON.stringify(e)},array:function(e){var o="";if(0===e.length){o+="[]";return o}i=i.replace(/$/,"  ");e.forEach(function(e){var s=n[t(e)];if(!s){throw new Error("what the crap: "+t(e))}o+="\n"+i+"- "+s(e)});i=i.replace(/  /,"");return o},object:function(e){var o="";if(0===Object.keys(e).length){o+="{}";return o}i=i.replace(/$/,"  ");Object.keys(e).forEach(function(s){var r=e[s],a=n[t(r)];if("undefined"===typeof r){return}if(!a){throw new Error("what the crap: "+t(r))}o+="\n"+i+s+": "+a(r)});i=i.replace(/  /,"");return o},function:function(){return"[object Function]"}};return"---"+n[t(e)](e)+"\n"}e.exports.stringify=n})()});var ImportExport=function(){function e(e){var t=this;registerInstance(this,e);this.importWorkflow=function(){var e=t.fileInput.files[0];var n=new FileReader;n.onload=function(){return __awaiter(t,void 0,void 0,function(){var e,t,i;return __generator(this,function(o){switch(o.label){case 0:e=n.result;t="json";i={data:e,format:t};return[4,this.import(i)];case 1:o.sent();return[2]}})})};n.readAsText(e)};this.serialize=function(e,t){switch(t){case"json":return JSON.stringify(e);case"yaml":return json2yaml.stringify(e);case"xml":return JSON.stringify(e);default:return e}};this.importEvent=createEvent(this,"import-workflow",7)}e.prototype.export=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i,o;return __generator(this,function(s){n=this.blobUrl;if(!!n){window.URL.revokeObjectURL(n)}i=e.workflow;o=this.serialize(i,t.format);return[2,o]})})};e.prototype.download=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i,o,s,r;return __generator(this,function(a){n=this.blobUrl;if(!!n){window.URL.revokeObjectURL(n)}i=e.workflow;o=this.serialize(i,t.format);s=new Blob([o],{type:t.mimeType});this.blobUrl=n=window.URL.createObjectURL(s);r=document.createElement("a");r.setAttribute("href",n);r.setAttribute("download","workflow."+t.fileExtension);document.body.appendChild(r);r.click();document.body.removeChild(r);return[2]})})};e.prototype.import=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){if(!e){this.fileInput.click()}else{t=JSON.parse(e.data);this.importEvent.emit(t)}return[2]})})};e.prototype.render=function(){var e=this;return h("host",null,h("input",{type:"file",class:"import-button",onChange:this.importWorkflow,ref:function(t){return e.fileInput=t}}))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".import-button{display:none}"},enumerable:true,configurable:true});return e}();exports("wf_import_export",ImportExport)}}});