(function(){var t,e=function(t,e){function l(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return l.prototype=e.prototype,t.prototype=new l,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var l,r;return l=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var l;return e(n,t),l=function(t,e,n,l,r){var a,o,s,c,i,d,u,h,p,f,g,v,C;for(d=[],o=!1,i=0,h=l.length;i<h;i++){if(s=l[i],"string"==typeof t[s])d.push(null!=(v=t[s])?v:"null");else{for(g=1,a=l.indexOf(s),C=t[s],u=0,p=C.length;u<p;u++)f=C[u],l.splice(a+g++,0,f),d.push(t[f]);g>1&&l.splice(a,1)}c=d.join(String.fromCharCode(0)),e[c]||(e[c]=r(d.slice()),o=!0),e[c].push(t)}return o&&n.push(d),[d,l]},n.prototype.processRecord=function(t){var e,n,r,a,o,s,c,i,d,u,h,p,f,g,v;if(v=[],e=[],this.allTotal.push(t),h=l(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),v=h[0],this.rowAttrs=h[1],p=l(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),e=p[0],this.colAttrs=p[1],d=v.length-1,u=e.length-1,!(d<0||u<0)){for(g=[],s=i=0,f=d;0<=f?i<=f:i>=f;s=0<=f?++i:--i)r=v.slice(0,s+1),o=r.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),g.push(function(){var l,s,i;for(i=[],c=l=0,s=u;0<=s?l<=s:l>=s;c=0<=s?++l:--l)n=e.slice(0,c+1),a=n.join(String.fromCharCode(0)),this.tree[o][a]||(this.tree[o][a]=this.aggregator(this,r,n)),i.push(this.tree[o][a].push(t));return i}.call(this));return g}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=l,r=function(e,l){var r,a,o,s,c,i,d,u,h,p,f,g,v,C,b,y,w,x,A,S,m,k,T,H,K,R,E,L,_,j,I,O,W,V,q,P,U,D,N,B,G;return H={localeStrings:{totals:"Totals"}},l=t.extend(H,l),a="▶",o="◢",y=e.colAttrs,W=e.rowAttrs,V=e.getRowKeys(),w=e.getColKeys(),G=e.tree,q=e.rowTotals,x=e.colTotals,r=e.allTotal,T=function(t,e,l,r){var a,o,s;if(o=document.createElement(t),e&&(o.className=e),null!==l&&void 0!==l&&(o.textContent=l),r)for(a in r)n.call(r,a)&&(s=r[a],o.setAttribute(a,s));return o},O=function(t,e){var n,l,r,a,o,s,c,i,d,u,h,p,f;for(s=t.length-1,o=t[0].length-1,u=[],a=[],p=T("th",e,t[0][0]),l=t[0][0],i=0,c={node:i,row:0,col:0,th:p,parent:null,children:[],descendants:o,leaves:1,flatKey:l},a[0]=c,u[0]=c,n=1;n<=o;)p=T("th",e,t[0][n]),l=l+String.fromCharCode(0)+t[0][n],++i,c={node:i,row:0,col:n,th:p,parent:u[n-1],children:[],descendants:o-n,leaves:1,flatKey:l},u[n]=c,u[n-1].children.push(c),++n;for(u[o].leaves=0,d=1;d<=s;){for(h=!0,l="",n=0;n<=o;)if(l=0===n?t[d][n]:l+String.fromCharCode(0)+t[d][n],t[d][n]===t[u[n].row][n]&&n!==o&&h)h=!0,++n;else{if(p=T("th",e,t[d][n]),++i,r={node:i,row:d,col:n,th:p,parent:null,children:[],descendants:0,leaves:1,flatKey:l},0===n)a.push(r);else for(r.parent=u[n-1],u[n-1].children.push(r),f=0;f<=n-1;)u[f].descendants=u[f].descendants+1,++f;u[n]=r,h=!1,++n}for(n=0;n<=o;)u[n].leaves=u[n].leaves+1,++n;u[o].leaves=0,++d}return a},s=function(t,e,n,l,r,a){var s,c,i;return s=l[a],i=T("th","pvtAxisLabel",s),c=s,a<l.length-1&&(c=" "+o+" "+s),i=T("th","pvtAxisLabel",c),i.setAttribute("data-colAttr",s),r.appendChild(i),e.push({tr:r,th:i,clickStatus:"expanded",expandedCount:0,nHeaders:0}),t.appendChild(r)},c=function(t,e,n,l){var r,a,o,c,i;for(i=document.createElement("tr"),0!==n.length&&i.appendChild(T("th",null,null,{colspan:n.length,rowspan:l.length})),s(t,e,n,l,i,0),c=[],r=a=1,o=l.length;1<=o?a<=o:a>=o;r=1<=o?++a:--a)r<l.length&&(i=document.createElement("tr"),c.push(s(t,e,n,l,i,r)));return c},i=function(t,e,n){var l,r,a,o,s,c;for(s=[],r=a=0,o=n.length-1;0<=o?a<=o:a>=o;r=0<=o?++a:--a)r<n.length-1&&(c=t[r].th,l=n[r],s.push(c.onclick=function(l){return l=l||window.event,D(t,e,n,l.target.getAttribute("data-colAttr"))}));return s},d=function(t,e,n,l,r){var a,s,c,i,u,h,p,f,g;for(u=n.children,c=0,i=u.length;c<i;c++)a=u[c],d(t,e,a,l,r);return s=t[n.col],++s.expandedCount,++s.nHeaders,g=s.tr,f=n.th,f.setAttribute("data-colHeader",f.textContent),n.col===r.length-1&&0!==l.length&&f.setAttribute("rowspan",2),0!==n.children.length&&f.setAttribute("colspan",n.descendants+1),f.setAttribute("data-node",e.length),g.appendChild(f),0!==n.children.length&&(f.textContent=" "+o+" "+f.textContent,f.onclick=function(n){return n=n||window.event,U(t,e,parseInt(n.target.getAttribute("data-node")))},h=r.length-(n.col+1)+(0!==l.length?1:0),p="pvtColLabel col"+n.row,f=T("th",p,"",{rowspan:h}),n.children[0].tr.appendChild(f),n.sTh=f),n.clickStatus="expanded",n.tr=g,e.push(n)},f=function(t,e,l,r){var a,s,c,i,d;d=document.createElement("tr"),e.hh=[];for(a in l)n.call(l,a)&&(s=l[a],c=s,a<l.length-1&&(c=" "+o+" "+s),i=T("th","pvtAxisLabel",c),i.setAttribute("data-rowAttr",s),d.appendChild(i),e.hh.push({th:i,clickStatus:"expanded",expandedCount:0,nHeaders:0}));return 0!==r.length&&(i=T("th"),d.appendChild(i)),t.appendChild(d),e.tr=d},g=function(t,e,n){var l,r,a,o,s,c;for(o=[],l=r=0,a=n.length-1;0<=a?r<=a:r>=a;l=0<=a?++r:--r)l<n.length-1&&(c=t.hh[l],s=n[l],o.push(c.th.onclick=function(l){return l=l||window.event,B(t,e,n,l.target.getAttribute("data-rowAttr"))}));return o},C=function(t,e,n){var r,a;return r=1,0!==n.length&&(r=n.length+(0===e.length?0:1)),a=T("th","pvtTotalLabel",l.localeStrings.totals,{rowspan:r}),t.appendChild(a)},v=function(t,e,n,l,r,a){var s,c,i,d,u,h,p,f,g;for(i=e.hh[l.col],++i.expandedCount,++i.nHeaders,g=document.createElement("tr"),f=l.th,f.setAttribute("rowspan",l.descendants+1),f.setAttribute("data-rowHeader",f.textContent),l.col===r.length-1&&0!==a.length&&f.setAttribute("colspan",2),f.setAttribute("data-node",n.length),g.appendChild(f),0!==l.children.length&&(f.textContent=" "+o+" "+f.textContent,f.onclick=function(t){return t=t||window.event,N(e,n,parseInt(t.target.getAttribute("data-node")))},s=r.length-(l.col+1)+(0!==a.length?1:0),f=T("th","pvtRowLabel","",{colspan:s}),g.appendChild(f)),l.clickStatus="expanded",l.tr=g,n.push(l),t.appendChild(g),h=l.children,p=[],d=0,u=h.length;d<u;d++)c=h[d],p.push(v(t,e,n,c,r,a));return p},b=function(t,e){var n,l,r,a,o,s,c,i,d,u,h,p,f,g,v,C;for(u=[],o=0,c=t.length;o<c;o++){for(h=t[o],v=h.tr,a=h.flatKey,s=0,i=e.length;s<i;s++)l=e[s],r=l.flatKey,n=null!=(d=G[a][r])?d:{value:function(){return null},format:function(){return""}},C=n.value(),p="pvtVal",p=0!==l.children.length?p+" pvtColSubtotal":p,p=0!==h.children.length?p+" pvtRowSubtotal":p,p=p+" row"+h.row+" col"+l.row+" rowcol"+h.col+" colcol"+l.col,f=T("td",p,n.format(C),{"data-value":C}),v.appendChild(f);g=q[a],C=g.value(),p="pvtTotal rowTotal",p=0!==h.children.length?p+" pvtRowSubtotal":p,p=p+" row"+h.row+" rowcol"+h.col,f=T("td",p,g.format(C),{"data-value":C,"data-row":"row"+h.row,"data-col":"col"+h.col}),u.push(v.appendChild(f))}return u},h=function(t,e){var n,r,a;return a=document.createElement("tr"),n=t.length+(0===e.length?0:1),r=T("th","pvtTotalLabel",l.localeStrings.totals,{colspan:n}),a.appendChild(r),a},u=function(t,e){var n,l,r,a,o,s,c,i;for(a=[],l=0,r=e.length;l<r;l++)n=e[l],c=x[n.flatKey],i=c.value(),o="pvtVal pvtTotal colTotal",o=n.children.length?o+" pvtColSubtotal":o,o=o+" col"+n.row+" colcol"+n.col,s=T("td",o,c.format(i),{"data-value":i,"data-for":"col"+n.col}),a.push(t.appendChild(s));return a},p=function(t,e){var n,l,a;return l=r,a=l.value(),n=T("td","pvtGrandTotal",l.format(a),{"data-value":a}),e.appendChild(n),t.appendChild(e)},P=function(e,n){if(n.th.style.display=e,n.children.length?t(n.th).closest("table.pvtTable").find("tbody tr td.pvtColSubtotal.col"+n.row+".colcol"+n.col).css("display",e):t(n.th).closest("table.pvtTable").find("tbody tr td.pvtVal.col"+n.row).not(".pvtColSubtotal").css("display",e),n.sTh)return n.sTh.style.display=e},A=function(t,e,n){var l,r,o,s,c,i,d,u,h,p,f,g;if(e[n]&&(s=e[n],"collapsed"!==s.clickStatus)){for(r=0,c=i=1,h=s.descendants;1<=h?i<=h:i>=h;c=1<=h?++i:--i)0!==s.descendants&&(o=e[n-c],"none"!==o.th.style.display&&(++r,P("none",o)));for(u=s.parent;null!==u;)u.th.setAttribute("colspan",parseInt(u.th.getAttribute("colspan"))-r),u=u.parent;if(0!==s.descendants&&(s.th.textContent=" "+a+" "+s.th.getAttribute("data-colHeader")),s.clickStatus="collapsed",s.th.setAttribute("colspan",1),s.th.style.display="",l=t[s.col],l.expandedCount--,0===l.expandedCount){for(g=[],c=d=p=s.col,f=t.length-2;p<=f?d<=f:d>=f;c=p<=f?++d:--d)l=t[c],l.th.textContent=" "+a+" "+l.th.getAttribute("data-colAttr"),g.push(l.clickStatus="collapsed");return g}}},K=function(t){var e,n,l,r,a;if("none"===t.th.style.display&&P("",t),"collapsed"!==t.clickStatus){for(r=t.children,a=[],n=0,l=r.length;n<l;n++)e=r[n],a.push(K(e));return a}},E=function(t,e,n){var l,r,a,s,c,i,d,u;if(e[n]&&(a=e[n],"expanded"!==a.clickStatus)){for(r=0,u=a.children,c=0,i=u.length;c<i;c++)l=u[c],r+=l.th.colSpan,"none"===l.th.style.display&&P("",l),K(l);for(0!==a.descendants&&(a.th.textContent=" "+o+" "+a.th.getAttribute("data-colHeader")),a.th.setAttribute("colspan",r+1),a.clickStatus="expanded",a.th.style.display="",a.sTh&&(a.sTh.style.display=""),d=a.parent;null!==d;)d.th.setAttribute("colspan",r+parseInt(d.th.getAttribute("colspan"))),d=d.parent;return s=t[a.col],++s.expandedCount,s.expandedCount===s.nHeaders?(s.th.textContent=" "+o+" "+s.th.getAttribute("data-colAttr"),s.clickStatus="expanded"):void 0}},m=function(t,e,n){var l,r,o,s,c,i,d,u,h,p,f,g,v;if(e[n]&&(r=e[n],"collapsed"!==r.clickStatus)){for(v=0,o=c=1,u=r.descendants;1<=u?c<=u:c>=u;o=1<=u?++c:--c)0!==r.descendants&&(l=e[n+o],"none"!==l.tr.style.display&&(++v,l.tr.style.display="none"));for(d=r.parent;null!==d;)d.th.setAttribute("rowspan",parseInt(d.th.getAttribute("rowspan"))-v),d=d.parent;if(0!==r.descendants&&(r.th.textContent=" "+a+" "+r.th.getAttribute("data-rowHeader")),r.clickStatus="collapsed",r.th.setAttribute("rowspan",1),r.tr.style.display="",g=t.hh[r.col],g.expandedCount--,0===g.expandedCount){for(f=[],s=i=h=r.col,p=t.hh.length-2;h<=p?i<=p:i>=p;s=h<=p?++i:--i)g=t.hh[s],g.th.textContent=" "+a+" "+g.th.getAttribute("data-rowAttr"),f.push(g.clickStatus="collapsed");return f}}},R=function(t){var e,n,l,r,a;if("none"===t.tr.style.display&&(t.tr.style.display=""),"collapsed"!==t.clickStatus){for(r=t.children,a=[],n=0,l=r.length;n<l;n++)e=r[n],a.push(R(e));return a}},_=function(t,e,n){var l,r,a,s,c,i,d,u;if(e[n]&&(r=e[n],"expanded"!==r.clickStatus)){for(u=0,d=r.children,s=0,c=d.length;s<c;s++)l=d[s],u+=l.th.rowSpan,"none"===l.tr.style.display&&(l.tr.style.display=""),R(l);for(0!==r.descendants&&(r.th.textContent=" "+o+" "+r.th.getAttribute("data-rowHeader")),r.th.setAttribute("rowspan",u+1),r.clickStatus="expanded",r.tr.style.display="",i=r.parent;null!==i;)i.th.setAttribute("rowspan",u+parseInt(i.th.getAttribute("rowspan"))),i=i.parent;return a=t.hh[r.col],++a.expandedCount,a.expandedCount===a.nHeaders?(a.th.textContent=" "+o+" "+a.th.getAttribute("data-rowAttr"),a.clickStatus="expanded"):void 0}},U=function(t,e,n){var l;if(e[n])return l=e[n],"collapsed"===l.clickStatus?E(t,e,n):A(t,e,n),l.th.scrollIntoView},N=function(t,e,n){if(e[n])return"collapsed"===e[n].clickStatus?_(t,e,n):m(t,e,n)},S=function(t,e,n,l){var r,o,s,c,i,d,u;if(c="string"==typeof l?n.indexOf(l):l,console.log("idx = "+c),!(c<0||c===n.length-1)){for(s=c,i=n.length-1;s<i;)o=t[s],o.th.textContent=" "+a+" "+n[s],o.clickStatus="collapsed",++s;for(s=0,d=e.length,u=[];s<d;)r=e[s],r.col===c&&"collapsed"!==r.clickStatus&&"none"!==r.th.style.display&&A(t,e,parseInt(r.th.getAttribute("data-node"))),u.push(++s);return u}},L=function(t,e,n,l){var r,s,c,i,d,u,h,p,f,g;if(d="string"==typeof l?n.indexOf(l):l,!(d<0||d===n.length-1)){for(i=h=0,f=d;0<=f?h<=f:h>=f;i=0<=f?++h:--h)for(c=t[i],c.th.textContent=" "+o+" "+n[i],c.clickStatus="expanded",u=0,p=e.length;u<p;)s=e[u],s.col===i&&E(t,e,u),++u;for(++d,g=[];d<n.length-1;)r=t[d],0===r.expandedCount?(r.th.textContent=" "+a+" "+n[d],r.clickStatus="collapsed"):r.expandedCount===r.nHeaders&&(r.th.textContent=" "+o+" "+n[d],r.clickStatus="expanded"),g.push(++d);return g}},k=function(t,e,n,l){var r,o,s,c,i,d,u;if(s="string"==typeof l?n.indexOf(l):l,!(s<0||s===n.length-1)){for(o=s,i=n.length-1;o<i;)r=t.hh[o],r.th.textContent=" "+a+" "+n[o],r.clickStatus="collapsed",++o;for(c=0,d=e.length,u=[];c<d;)r=e[c],r.col===s&&"collapsed"!==r.clickStatus&&"none"!==r.tr.style.display?(m(t,e,c),u.push(c=c+r.descendants+1)):u.push(++c);return u}},j=function(t,e,n,l){var r,s,c,i,d,u,h,p,f,g;if(i="string"==typeof l?n.indexOf(l):l,!(i<0||i===n.length-1)){for(c=u=0,p=i;0<=p?u<=p:u>=p;c=0<=p?++u:--u)for(s=t.hh[c],s.th.textContent=" "+o+" "+n[c],s.clickStatus="expanded",d=0,h=e.length;d<h;)r=e[d],r.col===c?(_(t,e,d),d=d+r.descendants+1):++d;for(++i,f=[];i<n.length-1;)g=t.hh[i],0===g.expandedCount?(g.th.textContent=" "+a+" "+n[i],g.clickStatus="collapsed"):g.expandedCount===g.nHeaders&&(g.th.textContent=" "+o+" "+n[i],g.clickStatus="expanded"),f.push(++i);return f}},D=function(t,e,n,l){var r,a;return a=n.indexOf(l),r=t[a],"collapsed"===r.clickStatus?L(t,e,n,l):S(t,e,n,l)},B=function(t,e,n,l){var r,a;return r=n.indexOf(l),a=t.hh[r],"collapsed"===a.clickStatus?j(t,e,n,l):k(t,e,n,l)},(I=function(t,e,n,r){var a,o,s,y,w,x,A,m,T,H,K,R,E,L,_;if(R=[],s=[],H={},K=[],o=[],a=[],0!==t.length&&(R=O(e,"pvtRowLabel")),0!==n.length&&(s=O(r,"pvtColLabel")),T=document.createElement("table"),T.className="pvtTable",T.style.display="none",L=document.createElement("thead"),T.appendChild(L),0!==n.length){for(c(L,o,t,n),w=0,A=s.length;w<A;w++)y=s[w],d(o,a,y,t,n);i(o,a,n)}if(0!==t.length&&(f(L,H,t,n),0===n.length&&C(H.tr,t,n)),0!==n.length&&C(o[0].tr,t,n),E=document.createElement("tbody"),T.appendChild(E),0!==t.length){for(x=0,m=R.length;x<m;x++)y=R[x],v(E,H,K,y,t,n);g(H,K,t)}return b(K,a),_=h(t,n),0!==n.length&&u(_,a),p(E,_),T.setAttribute("data-numrows",e.length),T.setAttribute("data-numcols",r.length),null==l.collapseRowsAt&&null==l.collapseColsAt&&(T.style.display=""),null!=l.collapseRowsAt&&setTimeout(function(){if(k(H,K,t,l.collapseRowsAt),!l.collapseColsAt)return T.style.display=""},0),null!=l.collapseColsAt&&setTimeout(function(){return S(o,a,n,l.collapseColsAt),T.style.display=""},0),T})(W,V,y,w)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return r(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(r(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(r(e,n)).heatmap("heatmap",n)},"Table With Subtotal Row Heatmap":function(e,n){return t(r(e,n)).heatmap("rowheatmap",n)},"Table With Subtotal Col Heatmap":function(e,n){return t(r(e,n)).heatmap("colheatmap",n)}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
